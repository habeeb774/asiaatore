import{C as e,D as t,E as n,M as r,N as i,P as a,S as o,T as s,_ as c,b as l,w as u,x as d,y as f}from"./index-HsKwDOAa.js";var p=a(i()),m=a(n());function h({productId:n}){let{user:r}=e()||{},[i,a]=(0,p.useState)([]),[o,s]=(0,p.useState)(!1),[c,l]=(0,p.useState)(null),[u,d]=(0,p.useState)({rating:5,title:``,body:``}),[f,h]=(0,p.useState)(!1),[g,_]=(0,p.useState)(!1),v=async()=>{if(n){s(!0),l(null);try{let e=await t.reviewsListForProduct(n);a(Array.isArray(e)?e:e.reviews||[])}catch(e){l(e.message)}finally{s(!1)}}};return(0,p.useEffect)(()=>{v()},[n]),(0,m.jsxs)(`div`,{className:`product-reviews`,dir:`rtl`,style:{marginTop:`2rem`},children:[(0,m.jsx)(`h3`,{style:{fontSize:`1rem`,marginBottom:`.75rem`},children:`آراء العملاء`}),o&&(0,m.jsx)(`div`,{style:{fontSize:`.7rem`,color:`#64748b`},children:`جاري التحميل...`}),c&&(0,m.jsx)(`div`,{style:{fontSize:`.65rem`,color:`#dc2626`},children:c}),!o&&!i.length&&(0,m.jsx)(`div`,{style:{fontSize:`.65rem`,color:`#475569`},children:`لا توجد مراجعات بعد.`}),(0,m.jsx)(`ul`,{style:{listStyle:`none`,margin:0,padding:0,display:`flex`,flexDirection:`column`,gap:10},children:i.map(e=>(0,m.jsxs)(`li`,{style:{background:`#f8fafc`,padding:`10px 14px`,borderRadius:12},children:[(0,m.jsxs)(`div`,{style:{display:`flex`,justifyContent:`space-between`,marginBottom:4},children:[(0,m.jsx)(`strong`,{style:{fontSize:`.7rem`},children:e.title||`مراجعة`}),(0,m.jsxs)(`span`,{style:{fontSize:`.6rem`,color:`#334155`},children:[`★`.repeat(e.rating),`☆`.repeat(Math.max(0,5-e.rating))]})]}),e.body&&(0,m.jsx)(`p`,{style:{margin:0,fontSize:`.6rem`,lineHeight:1.5},children:e.body}),(0,m.jsx)(`div`,{style:{fontSize:`.5rem`,marginTop:6,color:`#64748b`},children:new Date(e.createdAt).toLocaleDateString()})]},e.id))}),r?(0,m.jsxs)(`form`,{onSubmit:async e=>{if(e.preventDefault(),r){h(!0),l(null);try{await t.reviewCreate(n,u),d({rating:5,title:``,body:``}),_(!0),setTimeout(()=>_(!1),4e3)}catch(e){l(e.message)}finally{h(!1)}}},style:{marginTop:`1.25rem`,display:`grid`,gap:8,background:`#fff`,padding:`14px 16px`,border:`1px solid #e2e8f0`,borderRadius:14},children:[(0,m.jsx)(`h4`,{style:{margin:0,fontSize:`.75rem`},children:`أضف مراجعة`}),(0,m.jsxs)(`div`,{style:{display:`flex`,gap:8,alignItems:`center`},children:[(0,m.jsx)(`label`,{style:{fontSize:`.55rem`},children:`التقييم:`}),(0,m.jsx)(`select`,{value:u.rating,onChange:e=>d(t=>({...t,rating:+e.target.value})),style:{fontSize:`.6rem`},children:[5,4,3,2,1].map(e=>(0,m.jsx)(`option`,{value:e,children:e},e))})]}),(0,m.jsx)(`input`,{required:!0,placeholder:`عنوان (اختياري)`,value:u.title,onChange:e=>d(t=>({...t,title:e.target.value})),style:{fontSize:`.6rem`,padding:`8px 10px`,borderRadius:10,border:`1px solid #e2e8f0`}}),(0,m.jsx)(`textarea`,{required:!0,placeholder:`نص المراجعة`,value:u.body,onChange:e=>d(t=>({...t,body:e.target.value})),rows:4,style:{fontSize:`.6rem`,padding:`8px 10px`,borderRadius:10,border:`1px solid #e2e8f0`,resize:`vertical`}}),(0,m.jsx)(`button`,{type:`submit`,disabled:f,style:{fontSize:`.6rem`,fontWeight:600,background:`linear-gradient(90deg,#69be3c,#f6ad55)`,color:`#fff`,border:0,padding:`8px 14px`,borderRadius:10,cursor:`pointer`},children:f?`جاري الإرسال...`:`إرسال`}),g&&(0,m.jsx)(`div`,{style:{fontSize:`.55rem`,color:`#16a34a`},children:`تم الإرسال وتنتظر الموافقة 💬`})]}):(0,m.jsx)(`div`,{style:{fontSize:`.6rem`,marginTop:`1rem`,color:`#475569`},children:`سجّل دخولك لإضافة مراجعة.`})]})}var g=()=>{let{id:e}=r(),{locale:t}=u(),{getProductById:n}=f()||{},{addToCart:i}=l()||{addToCart:()=>{}},a=n?n(e):null,g=(0,p.useMemo)(()=>({id:e,name:{ar:`منتج رقم ${e}`,en:`Product #${e}`},short:{ar:`وصف مختصر للمنتج (تجريبي).`,en:`Short experimental product description.`},image:`/vite.svg`,price:99,stock:5}),[e,t]),_=a||g,v=o(_,t),y=d(_,`short`,t),{setting:b}=s()||{},x=t===`ar`?b?.siteNameAr||`متجري`:b?.siteNameEn||`My Store`,S=`${v} | ${x}`,C=y,w={"@context":`https://schema.org`,"@type":`Product`,name:v,image:[_.image],description:y,sku:_.id,offers:{"@type":`Offer`,priceCurrency:`SAR`,price:String(_.price||0),availability:_.stock>0?`https://schema.org/InStock`:`https://schema.org/OutOfStock`}};return(0,m.jsxs)(`div`,{className:`product-detail`,children:[(0,m.jsx)(c,{title:S,description:C,image:_.image}),(0,m.jsx)(`script`,{type:`application/ld+json`,dangerouslySetInnerHTML:{__html:JSON.stringify(w)}}),(0,m.jsx)(`h1`,{children:v}),(0,m.jsx)(`p`,{children:y}),(0,m.jsx)(`img`,{src:_.image,alt:v,style:{maxWidth:`100%`,borderRadius:8}}),(0,m.jsxs)(`div`,{style:{marginTop:16,display:`flex`,gap:12,flexWrap:`wrap`,alignItems:`center`},children:[(0,m.jsx)(`button`,{className:`btn-primary`,disabled:_.stock<=0,onClick:()=>i(_),children:_.stock<=0?t===`ar`?`غير متوفر`:`Out of stock`:t===`ar`?`أضف للسلة`:`Add to cart`}),(0,m.jsxs)(`span`,{style:{fontSize:`.85rem`,color:`#444`},children:[t===`ar`?`المخزون`:`Stock`,`: `,_.stock]})]}),(0,m.jsx)(h,{productId:_.id})]})};export{g as default};