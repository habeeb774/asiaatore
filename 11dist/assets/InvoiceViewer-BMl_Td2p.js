import{A as e,E as t,M as n,N as r,P as i,j as a,k as o,w as s}from"./index-HsKwDOAa.js";var c=i(r()),l=i(t()),u=()=>{let{id:t}=n(),[r]=e(),{locale:i}=s()||{locale:`ar`},u=(0,c.useRef)(null),[d,f]=(0,c.useState)(!1),p=a(),m=(()=>{try{return localStorage.getItem(`my_store_token`)||``}catch{return``}})(),h=`/api/orders/${t}/invoice${m?`?token=${encodeURIComponent(m)}`:``}`,[g,_]=(0,c.useState)(`A4`),[v,y]=(0,c.useState)(`portrait`),[b,x]=(0,c.useState)(`16`),[S,C]=(0,c.useState)(`12`),[w,T]=(0,c.useState)(`16`),[E,D]=(0,c.useState)(`12`),O=`invoice_paper_opts`;(0,c.useEffect)(()=>{try{let e=localStorage.getItem(O);if(e){let t=JSON.parse(e);t.size&&_(t.size),t.orientation&&y(t.orientation),t.mt!=null&&x(String(t.mt)),t.mr!=null&&C(String(t.mr)),t.mb!=null&&T(String(t.mb)),t.ml!=null&&D(String(t.ml))}}catch{}},[]),(0,c.useEffect)(()=>{try{let e={size:g,orientation:v,mt:b,mr:S,mb:w,ml:E};localStorage.setItem(O,JSON.stringify(e))}catch{}},[g,v,b,S,w,E]);let k=(0,c.useMemo)(()=>{let e=new URLSearchParams;m&&e.set(`token`,m),g&&e.set(`size`,g),v&&e.set(`orientation`,v),b&&e.set(`mt`,b),S&&e.set(`mr`,S),w&&e.set(`mb`,w),E&&e.set(`ml`,E);let n=e.toString();return`/api/orders/${t}/invoice.pdf${n?`?${n}`:``}`},[t,m,g,v,b,S,w,E]),A=r.get(`print`)===`1`||r.get(`print`)===`true`;return(0,c.useEffect)(()=>{let e=u.current;if(!e)return;let t=()=>{if(f(!0),A)try{setTimeout(()=>{e.contentWindow&&e.contentWindow.focus(),e.contentWindow&&e.contentWindow.print()},150)}catch{}};return e.addEventListener(`load`,t),()=>e.removeEventListener(`load`,t)},[A,t,p.key]),(0,l.jsxs)(`div`,{className:`min-h-screen flex flex-col`,style:{direction:i===`ar`?`rtl`:`ltr`},children:[(0,l.jsxs)(`div`,{className:`px-4 py-3 border-b bg-white flex items-center gap-2 flex-wrap`,children:[(0,l.jsx)(o,{to:i===`en`?`/en/orders`:`/orders`,className:`btn-secondary px-3 py-1 text-sm`,children:i===`ar`?`رجوع للطلبات`:`Back to orders`}),(0,l.jsx)(`a`,{href:h,target:`_blank`,rel:`noopener`,className:`btn-secondary px-3 py-1 text-sm`,children:i===`ar`?`فتح في تبويب جديد`:`Open in new tab`}),(0,l.jsxs)(`div`,{className:`flex items-center gap-2 text-sm`,children:[(0,l.jsxs)(`label`,{className:`flex items-center gap-1`,children:[(0,l.jsx)(`span`,{className:`text-gray-600`,children:i===`ar`?`الحجم`:`Size`}),(0,l.jsx)(`select`,{value:g,onChange:e=>_(e.target.value),className:`border rounded px-2 py-1`,children:[`A3`,`A4`,`A5`,`LETTER`,`LEGAL`,`TABLOID`].map(e=>(0,l.jsx)(`option`,{value:e,children:e},e))})]}),(0,l.jsxs)(`label`,{className:`flex items-center gap-1`,children:[(0,l.jsx)(`span`,{className:`text-gray-600`,children:i===`ar`?`الاتجاه`:`Orientation`}),(0,l.jsxs)(`select`,{value:v,onChange:e=>y(e.target.value),className:`border rounded px-2 py-1`,children:[(0,l.jsx)(`option`,{value:`portrait`,children:i===`ar`?`عمودي`:`Portrait`}),(0,l.jsx)(`option`,{value:`landscape`,children:i===`ar`?`أفقي`:`Landscape`})]})]}),(0,l.jsxs)(`div`,{className:`hidden md:flex items-center gap-1`,children:[(0,l.jsxs)(`span`,{className:`text-gray-600`,children:[i===`ar`?`هوامش(mm)`:`Margins(mm)`,`:`]}),(0,l.jsx)(`input`,{value:b,onChange:e=>x(e.target.value),className:`w-14 border rounded px-2 py-1`,title:i===`ar`?`علوي`:`Top`}),(0,l.jsx)(`input`,{value:S,onChange:e=>C(e.target.value),className:`w-14 border rounded px-2 py-1`,title:i===`ar`?`أيمن`:`Right`}),(0,l.jsx)(`input`,{value:w,onChange:e=>T(e.target.value),className:`w-14 border rounded px-2 py-1`,title:i===`ar`?`سفلي`:`Bottom`}),(0,l.jsx)(`input`,{value:E,onChange:e=>D(e.target.value),className:`w-14 border rounded px-2 py-1`,title:i===`ar`?`أيسر`:`Left`})]})]}),(0,l.jsx)(`a`,{href:k,target:`_blank`,rel:`noopener`,className:`btn-secondary px-3 py-1 text-sm`,children:i===`ar`?`تحميل PDF`:`Download PDF`}),(0,l.jsx)(`button`,{type:`button`,onClick:()=>{try{let e=u.current?.contentWindow;e?.focus(),e?.print()}catch{}},className:`btn-primary px-3 py-1 text-sm`,disabled:!d,children:i===`ar`?`طباعة`:`Print`}),(0,l.jsx)(`div`,{className:`ml-auto text-sm text-gray-600`,children:i===`ar`?`فاتورة #${t}`:`Invoice #${t}`})]}),(0,l.jsx)(`div`,{className:`flex-1 bg-gray-50`,children:(0,l.jsx)(`iframe`,{ref:u,title:`invoice-${t}`,src:h,style:{width:`100%`,height:`100%`,border:`0`,display:`block`}})})]})};export{u as default};