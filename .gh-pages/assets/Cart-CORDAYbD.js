const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CheckoutPage-CbmVguQj.js","assets/vendor.react-BIXKTxlu.js","assets/vendor-CKneRQof.js","assets/vendor.router-BdFOcp8q.js","assets/vendor.i18next-COqwnjR1.js","assets/vendor.zustand-BuMo4m-J.js","assets/vendor.tanstack-K6OTystZ.js","assets/vendor.leaflet-Dl6I9sMh.js","assets/reactLeafletCompat-CJfjRSDT.js","assets/paymentService-CJCDmSv0.js","assets/index-B9WgXUd4.js","assets/index-DyYrs08G.css","assets/vendor-B1-rhOTE.css"])))=>i.map(i=>d[i]);
import{_ as E}from"./vendor.tanstack-K6OTystZ.js";import{r as m,j as e,K as Z,L as v,a0 as L,aj as ee,a3 as te,ak as se}from"./vendor.react-BIXKTxlu.js";import{d as ae,u as re,A as ne,m as ie,r as le}from"./index-B9WgXUd4.js";import{L as oe}from"./LazyImage-Dc5lMgrN.js";import"./vendor-CKneRQof.js";import"./vendor.router-BdFOcp8q.js";import"./vendor.i18next-COqwnjR1.js";import"./vendor.zustand-BuMo4m-J.js";import"./vendor.leaflet-Dl6I9sMh.js";/* empty css                     */const ve=()=>{const{cartItems:_,updateQuantity:l,removeFromCart:T,cartTotal:q,clearCart:N,maxPerItem:h,addToCart:M}=ae()||{},s=re()?.locale??"ar",w=t=>String(le(t,s)||""),r=_||[],[R,z]=m.useState(""),[c,b]=m.useState(null),y=m.useRef(null),f=m.useRef(null),A=m.useMemo(()=>new Intl.NumberFormat(s==="ar"?"ar-SA":"en-US",{style:"currency",currency:"SAR",minimumFractionDigits:2,maximumFractionDigits:2}),[s]),i=t=>A.format(Math.max(0,Number(t)||0)),d=typeof q=="number"?q:r.reduce((t,a)=>t+Number(a.price??a.salePrice??0)*(a.quantity||1),0),F=r.reduce((t,a)=>t+(a.quantity||1),0),D=200,g=Math.max(0,D-d),U=Math.min(100,Math.round(d/D*100)),$=()=>{if(!N)return;const t=s==="ar"?"هل تريد إفراغ السلة؟":"Do you want to empty the cart?";(typeof window>"u"||window.confirm(t))&&N()};m.useEffect(()=>()=>{clearInterval(f.current),clearTimeout(y.current)},[]),m.useEffect(()=>{if(!(!r||r.length===0))try{typeof requestIdleCallback=="function"?requestIdleCallback(()=>{E(()=>import("./CheckoutPage-CbmVguQj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))},{timeout:1500}):setTimeout(()=>{E(()=>import("./CheckoutPage-CbmVguQj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))},1500)}catch{}},[r.length]);const K=t=>{try{navigator.vibrate?.(10)}catch{}clearInterval(f.current),f.current=setInterval(()=>{try{t()}catch{}},110)},S=t=>{clearTimeout(y.current),y.current=setTimeout(()=>K(t),260)},x=()=>{clearTimeout(y.current),clearInterval(f.current)},Q=()=>{try{window.dispatchEvent(new CustomEvent("toast:show",{detail:{type:"info",title:s==="ar"?"قريباً":"Coming soon",description:s==="ar"?"تطبيق الكوبونات سيكون متاحاً قريباً":"Coupon application will be available soon"}}))}catch{}},V=t=>{T?.(t.id);try{window.dispatchEvent(new CustomEvent("toast:show",{detail:{type:"warn",title:s==="ar"?"تمت إزالة المنتج":"Item removed",description:w(t.name||t.title)+(s==="ar"?" — تراجع؟":" — Undo?")}}))}catch{}c?.timeoutId&&clearTimeout(c.timeoutId);const a=setTimeout(()=>b(null),5e3);b({item:t,timeoutId:a})},B=()=>{if(!c?.item)return;const t=c.item;b(a=>(a?.timeoutId&&clearTimeout(a.timeoutId),null)),M?.(t,t.quantity||1)},H=(t,a)=>{t.key==="ArrowUp"?(t.preventDefault(),l?.(a.id,(a.quantity||1)+1)):t.key==="ArrowDown"?(t.preventDefault(),l?.(a.id,Math.max(1,(a.quantity||1)-1))):t.key==="Enter"&&t.target.blur()};return r.length===0?e.jsx("div",{className:"pt-20 min-h-screen bg-gray-50",children:e.jsx("div",{className:"container-custom px-4 py-16",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Z,{size:64,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"سلة التسوق فارغة"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"لم تقم بإضافة أي منتجات إلى سلة التسوق بعد"}),e.jsx(v,{to:"/products",className:"btn-primary text-lg px-8 py-3",children:"تصفح المنتجات"})]})})}):e.jsxs("div",{className:"pt-20 min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"container-custom px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"سلة التسوق"}),e.jsxs("button",{onClick:$,className:"text-red-600 hover:text-red-700 flex items-center space-x-2 space-x-reverse disabled:opacity-40 disabled:cursor-not-allowed",disabled:!N,children:[e.jsx(L,{size:20}),e.jsx("span",{children:"إفراغ السلة"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg",children:[c?.item&&e.jsxs("div",{className:"p-4 bg-yellow-50 border-b border-yellow-100 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-yellow-800",children:s==="ar"?"تمت إزالة عنصر من السلة":"Item removed from cart"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"text-sm btn-secondary px-3 py-1",onClick:B,children:s==="ar"?"تراجع":"Undo"}),e.jsx("button",{className:"text-sm text-gray-500",onClick:()=>{c?.timeoutId&&(clearTimeout(c.timeoutId),b(null))},children:s==="ar"?"إغلاق":"Dismiss"})]})]}),e.jsx(ne,{initial:!1,children:r.map((t,a)=>{const n=t?.quantity&&t.quantity>0?t.quantity:1,p=Number(t?.price??t?.salePrice??0),u=Number(t?.oldPrice??t?.originalPrice??NaN),O=p*n,C=typeof h=="number"?h:10,k=n>1,I=n<C,G=s==="ar"?"إنقاص الكمية":"Decrease quantity",J=s==="ar"?"زيادة الكمية":"Increase quantity",W=s==="ar"?"إزالة من السلة":"Remove from cart",P=Number.isFinite(u)&&u>p?(u-p)*n:0,X=typeof t?.stock=="number"&&n>=t.stock;return e.jsxs(ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:a*.05},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-6 p-6 border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[e.jsx(oe,{src:t.images?.[0]||"/images/hero-image.svg",alt:w(t.name||t.title),className:"w-20 h-20 object-cover rounded-lg flex-shrink-0",sizes:"80px",width:80,height:80,decoding:"async"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-bold text-lg mb-2 truncate",children:w(t.name||t.title)}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["السعر:"," ",e.jsx("span",{className:"font-semibold text-gray-900",children:i(p)}),Number.isFinite(u)&&u>p&&e.jsx("span",{className:"ms-2 line-through opacity-60",children:i(u)})]}),e.jsxs("span",{children:["الإجمالي:"," ",e.jsx("span",{className:"font-semibold text-gray-900",children:i(O)})]}),P>0&&e.jsx("span",{className:"inline-flex items-center text-emerald-700 bg-emerald-50 px-2 py-0.5 rounded-md font-semibold",children:s==="ar"?`وفرت ${i(P)}`:`Saved ${i(P)}`}),X&&e.jsx("span",{className:"inline-flex items-center text-red-700 bg-red-50 px-2 py-0.5 rounded-md font-semibold",children:s==="ar"?`المتاح الآن: ${t.stock}`:`Available: ${t.stock}`})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 flex-wrap sm:flex-nowrap",children:[e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg overflow-hidden",children:[e.jsx("button",{type:"button",onClick:()=>k&&l?.(t.id,Math.max(1,n-1)),onPointerDown:()=>S(()=>k&&l?.(t.id,Math.max(1,(typeof r?.find=="function"?r.find(o=>o.id===t.id)?.quantity||1:n)-1))),onPointerUp:x,onPointerCancel:x,onPointerLeave:x,className:"px-3 py-1 text-gray-600 hover:text-primary-red disabled:opacity-40 disabled:cursor-not-allowed","aria-label":G,disabled:!k||!l,children:e.jsx(ee,{size:16})}),e.jsx("input",{"aria-label":s==="ar"?"كمية المنتج":"Quantity",type:"number",min:1,max:C,value:n,onChange:o=>{const j=Math.max(1,Math.min(C,Number(o.target.value||1)));l?.(t.id,j)},onKeyDown:o=>H(o,t),className:"px-4 py-1 border-l border-r border-gray-300 min-w-12 text-center text-sm font-semibold appearance-none"}),e.jsx("button",{type:"button",onClick:()=>I&&l?.(t.id,n+1),onPointerDown:()=>S(()=>{if(!I)return;const o=typeof r?.find=="function"?r.find(Y=>Y.id===t.id)?.quantity||1:n,j=Math.min(typeof h=="number"?h:10,o+1);j!==o&&l?.(t.id,j)}),onPointerUp:x,onPointerCancel:x,onPointerLeave:x,className:"px-3 py-1 text-gray-600 hover:text-primary-red disabled:opacity-40 disabled:cursor-not-allowed","aria-label":J,disabled:!I||!l,children:e.jsx(te,{size:16})})]}),e.jsx("button",{type:"button",onClick:()=>V(t),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-40 disabled:cursor-not-allowed","aria-label":W,disabled:!T,children:e.jsx(L,{size:20})})]})]},t.id||`${a}-${n}`)})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 sticky top-24",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:"ملخص الطلب"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"عدد المنتجات:"}),e.jsx("span",{children:F})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"المجموع:"}),e.jsx("span",{children:i(d)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"الشحن:"}),e.jsx("span",{className:"text-green-600",children:"مجاني"})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"الإجمالي:"}),e.jsx("span",{className:"text-primary-red",children:i(d)})]})})]}),e.jsx("div",{className:"mb-4",children:g>0?e.jsxs("div",{className:"text-xs text-gray-600",children:["أضف"," ",e.jsx("strong",{className:"text-primary-red",children:i(g)})," ","للحصول على شحن مجاني",e.jsx("div",{className:"h-2 bg-gray-200 rounded mt-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${U}%`}})})]}):e.jsx("div",{className:"text-xs text-green-700",children:"✓ شحن مجاني مفعّل"})}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{value:R,onChange:t=>z(t.target.value),className:"border rounded px-3 py-2 text-sm flex-1",placeholder:"كود خصم (اختياري)"}),e.jsx("button",{onClick:Q,className:"btn-secondary text-sm",type:"button",children:"تطبيق"})]}),e.jsx(v,{to:"/checkout",className:"btn-primary w-full py-3 text-lg mb-4 text-center block",children:"إتمام الشراء"}),e.jsxs(v,{to:"/products",className:"flex items-center justify-center space-x-2 space-x-reverse text-gray-600 hover:text-primary-red transition-colors",children:[e.jsx(se,{size:20}),e.jsx("span",{children:"مواصلة التسوق"})]})]})})]})]}),e.jsx("div",{className:"fixed inset-x-0 bottom-0 z-40 md:hidden",style:{paddingBottom:"env(safe-area-inset-bottom)"},role:"region","aria-label":s==="ar"?"شريط الدفع":"Checkout bar",children:e.jsxs("div",{className:"mx-3 mb-3 rounded-2xl shadow-2xl bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/80 border border-gray-200 p-3 flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"الإجمالي"}),e.jsx("div",{className:"text-lg font-extrabold text-gray-900",children:i(d)}),g>0?e.jsxs("div",{className:"text-[11px] text-gray-600",children:["أضف ",i(g)," للشحن المجاني"]}):e.jsx("div",{className:"text-[11px] text-emerald-700",children:"✓ شحن مجاني"})]}),e.jsx(v,{to:"/checkout",className:"btn-primary px-5 py-3 text-base font-bold","aria-disabled":d<=0,tabIndex:d<=0?-1:0,children:"إتمام الشراء"})]})})]})};export{ve as default};
