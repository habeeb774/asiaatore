const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AdsAdmin-BzYbWOcx.js","assets/vendor.react-BIXKTxlu.js","assets/vendor-CKneRQof.js","assets/vendor.router-BdFOcp8q.js","assets/vendor.i18next-COqwnjR1.js","assets/vendor.zustand-BuMo4m-J.js","assets/vendor.tanstack-K6OTystZ.js","assets/vendor.leaflet-Dl6I9sMh.js","assets/index-B9WgXUd4.js","assets/index-DyYrs08G.css","assets/vendor-B1-rhOTE.css"])))=>i.map(i=>d[i]);
import{_ as ls}from"./vendor.tanstack-K6OTystZ.js";import{r as s,u as is,b as as,R as Ve,j as e,ao as bt,X as St,ap as Ue,a0 as wt}from"./vendor.react-BIXKTxlu.js";import{u as er,e as tr,f as os,o as cs,r as z,a as ds,g as h,p as xe,S as us,q as ps}from"./index-B9WgXUd4.js";/* empty css                  */import"./vendor-CKneRQof.js";import"./vendor.router-BdFOcp8q.js";import"./vendor.i18next-COqwnjR1.js";import"./vendor.zustand-BuMo4m-J.js";import"./vendor.leaflet-Dl6I9sMh.js";/* empty css                     */const hs=Ve.lazy(()=>ls(()=>import("./AdsAdmin-BzYbWOcx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),ll=()=>{const{locale:g}=er(),{user:G}=tr()||{},S=G?.role==="admin",{refresh:J}=os()||{},{products:X,users:te,orders:D,addProduct:o,updateProduct:L,deleteProduct:j,addUser:Te,updateUser:ne,deleteUser:Pt,addOrder:zt,updateOrder:Lt,deleteOrder:nn}=cs(),[F,c]=s.useState([]),[a,P]=s.useState(!1),[O,I]=s.useState(!1),[rn,De]=s.useState(null),B=a?F:X,nr=is();as();const p=new URLSearchParams(nr.search).get("view")||"overview",[Ft,rr]=s.useState([]),[sn,sr]=s.useState([]),[ae,ln]=s.useState(1),[Re,lr]=s.useState(1),[ir,ar]=s.useState(0),[Je,an]=s.useState(!1),[Xe,on]=s.useState(null),[d,N]=s.useState({id:null,nameAr:"",nameEn:"",price:"",stock:"",status:"active",category:"general",oldPrice:"",image:""}),[K,Ke]=s.useState(null),[re,cn]=s.useState("file"),dn=s.useRef(null),[Ye,or]=s.useState({todayOrders:0,todayRevenue:0,avgOrderValueToday:0,pendingBankCount:0}),[Tt,cr]=s.useState(14),[T,dr]=s.useState(null),[un,pn]=s.useState(!1),[hn,gn]=s.useState(null),[mn,ur]=s.useState([]),[bs,Ss]=s.useState(!1),[Dt,pr]=s.useState("created_desc"),[Ze,hr]=s.useState(""),[xn,fe]=s.useState([]),[ws,gr]=s.useState({id:null,name:"",role:"user",active:!0}),[Cs,mr]=s.useState({id:null,total:"",status:"pending",customer:"",items:1}),[xr,ks]=s.useState(""),_=xr.toLowerCase(),je=s.useMemo(()=>{let t=B.map(n=>({...n,_flatName:String(z(n.name,g)||n.name?.ar||n.name?.en||n.name||"").toLowerCase()}));return _&&(t=t.filter(n=>n._flatName.includes(_)||(z(n.name,g)||n.name?.ar||n.name?.en||n.slug||"").toLowerCase().includes(_))),Ze&&(t=t.filter(n=>n.category===Ze)),t=[...t].sort((n,r)=>{switch(Dt){case"price_asc":return n.price-r.price;case"price_desc":return r.price-n.price;case"stock_asc":return n.stock-r.stock;case"stock_desc":return r.stock-n.stock;case"created_asc":return n.id.localeCompare(r.id);case"created_desc":default:return r.id.localeCompare(n.id)}}),t},[B,_,Ze,Dt]),[oe,Rt]=s.useState(1),[_e,yr]=s.useState(20),et=Math.max(1,Math.ceil((je.length||0)/_e)),fr=s.useMemo(()=>{const t=(oe-1)*_e;return je.slice(t,t+_e)},[je,oe,_e]),[U,yn]=s.useState(null),[fn,tt]=s.useState({}),[jn,ve]=s.useState(!1),[vn,ce]=s.useState(null),nt={id:null,minQty:"",price:"",packagingType:"unit",noteAr:"",noteEn:""},[w,Y]=s.useState(nt),jr=["unit","carton","bundle"],vr=async t=>{ve(!0),ce(null);try{const n=await h.tierList(t);tt(r=>({...r,[t]:n}))}catch(n){ce(n.message)}finally{ve(!1)}},br=t=>{if(ce(null),Y(nt),U===t){yn(null);return}yn(t),fn[t]||vr(t)},Sr=async t=>{if(t.preventDefault(),!!U){ve(!0),ce(null);try{if(w.id){const n=await h.tierUpdate(w.id,{minQty:+w.minQty,price:+w.price,packagingType:w.packagingType,noteAr:w.noteAr||null,noteEn:w.noteEn||null});tt(r=>({...r,[U]:(r[U]||[]).map(i=>i.id===n.id?n:i)}))}else{const n=await h.tierCreate(U,{minQty:+w.minQty,price:+w.price,packagingType:w.packagingType,noteAr:w.noteAr||null,noteEn:w.noteEn||null});tt(r=>({...r,[U]:[...r[U]||[],n].sort((i,l)=>i.minQty-l.minQty)}))}Y(nt)}catch(n){ce(n.message.includes("DUPLICATE_TIER")?"Ø´Ø±ÙŠØ­Ø© Ù…ÙƒØ±Ø±Ø© Ù„Ù†ÙØ³ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ ÙˆÙ†ÙˆØ¹ Ø§Ù„ØªØºÙ„ÙŠÙ":n.message)}finally{ve(!1)}}},wr=t=>{Y({id:t.id,minQty:t.minQty,price:t.price,packagingType:t.packagingType,noteAr:t.note?.ar||"",noteEn:t.note?.en||""})},Cr=async t=>{if(window.confirm("Ø­Ø°Ù Ø§Ù„Ø´Ø±ÙŠØ­Ø©ØŸ")){ve(!0),ce(null);try{await h.tierDelete(t.id),tt(n=>({...n,[U]:(n[U]||[]).filter(r=>r.id!==t.id)}))}catch(n){ce(n.message)}finally{ve(!1)}}},_t=Ft.length?Ft:te;s.useMemo(()=>_t.filter(t=>(t.name||"").toLowerCase().includes(_)||(t.role||"").includes(_)),[_t,_]);const[be,bn]=s.useState(""),[Se,Sn]=s.useState(""),[we,wn]=s.useState(""),[Ce,Cn]=s.useState(""),[Mt,kr]=s.useState(null),[Ot,ke]=s.useState(null),[rt,de]=s.useState(!1),[kn,ue]=s.useState(null),[st,An]=s.useState(null),En=Ve.useRef(null),[C,k]=s.useState({siteNameAr:"",siteNameEn:"",colorPrimary:"",colorSecondary:"",colorAccent:"",supportPhone:"",supportMobile:"",supportWhatsapp:"",supportEmail:"",supportHours:"",footerAboutAr:"",footerAboutEn:"",linkBlog:"",linkSocial:"",linkReturns:"",linkPrivacy:"",appStoreUrl:"",playStoreUrl:""}),M=ds();s.useEffect(()=>{if(M?.setting){ke(M.setting);const t=M.setting;k(n=>({...n,siteNameAr:t.siteNameAr||"",siteNameEn:t.siteNameEn||"",colorPrimary:t.colorPrimary||"",colorSecondary:t.colorSecondary||"",colorAccent:t.colorAccent||"",supportPhone:t.supportPhone||"",supportMobile:t.supportMobile||"",supportWhatsapp:t.supportWhatsapp||"",supportEmail:t.supportEmail||"",supportHours:t.supportHours||"",footerAboutAr:t.footerAboutAr||"",footerAboutEn:t.footerAboutEn||"",linkBlog:t.linkBlog||"",linkSocial:t.linkSocial||"",linkReturns:t.linkReturns||"",linkPrivacy:t.linkPrivacy||"",appStoreUrl:t.appStoreUrl||"",playStoreUrl:t.playStoreUrl||""}))}},[M?.setting]);const[lt,It]=s.useState([]),[Pn,it]=s.useState(!1),[at,ot]=s.useState(null),[Me,ct]=s.useState([]),[R,Ar]=s.useState(null),[y,Z]=s.useState({id:null,slug:"",nameAr:"",nameEn:"",descriptionAr:"",descriptionEn:"",logo:""}),[Oe,zn]=s.useState(null),[Ln,$]=s.useState(!1),[Fn,q]=s.useState(null),[dt,Er]=s.useState(""),[Nt,Pr]=s.useState("created_desc"),[Wt,pe]=s.useState(""),[Tn,Dn]=s.useState(!1),[Ae,Rn]=s.useState(""),[Bt,ut]=s.useState([]),[_n,zr]=s.useState(""),[pt,ht]=s.useState([]),[Ut,Lr]=s.useState([]),[$t,gt]=s.useState([]),[f,V]=s.useState({id:null,titleAr:"",titleEn:"",bodyAr:"",bodyEn:"",icon:"",sort:0,active:!0}),[qt,Fr]=s.useState([]),[As,Mn]=s.useState(!1),[Es,On]=s.useState(null),[In,Ps]=s.useState(""),[Nn,zs]=s.useState("recent"),[Wn,Ls]=s.useState(""),[Fs,Ts]=s.useState({id:null,nameAr:"",nameEn:"",price:"",oldPrice:"",image:"",category:"general"}),[mt,Ds]=s.useState(""),[xt,Rs]=s.useState({productId:"",percent:"",newPrice:""}),[_s,Ms]=s.useState(!1),[Bn,Os]=s.useState(!1),[Is,Ns]=s.useState([]),[Ws,Bs]=s.useState(""),[Us,$s]=s.useState({id:null,location:"homepage",titleAr:"",titleEn:"",bodyAr:"",bodyEn:"",image:"",linkUrl:"",sort:0,active:!0}),[qs,Vs]=s.useState(null),[A,se]=s.useState({id:null,platform:"web",url:"",labelAr:"",labelEn:"",active:!0}),[Un,Ee]=s.useState(!1),[Hs,Pe]=s.useState(null),[yt,Tr]=s.useState(""),[Vt,Qs]=s.useState(""),[ft,Dr]=s.useState(""),[Ht,Rr]=s.useState("sort_asc"),[$n,Gs]=s.useState("sort_asc"),[Qt,_r]=s.useState("platform_asc"),[Ie,Mr]=s.useState(null),[qn,Or]=s.useState(30),Gt=async(t=qn)=>{try{const n=await h.marketingMetrics(t);Mr(n)}catch(n){console.error("metrics",n)}};s.useEffect(()=>{p==="marketing"&&Ie==null&&Gt()},[p]);const Ne=s.useMemo(()=>D.filter(t=>{if(_&&!((t.id+"").toLowerCase().includes(_)||(t.status||"").includes(_)||(""+t.total).includes(_))||be&&t.status!==be||Se&&t.paymentMethod!==Se)return!1;if(we){const n=new Date(we);if(!isNaN(n)&&new Date(t.createdAt)<n)return!1}if(Ce){const n=new Date(Ce);if(!isNaN(n)&&(n.setHours(23,59,59,999),new Date(t.createdAt)>n))return!1}return!0}),[D,_,be,Se,we,Ce]),[he,Jt]=s.useState(1),[We,Ir]=s.useState(50),jt=Math.max(1,Math.ceil((Ne.length||0)/We)),Nr=s.useMemo(()=>{const t=(he-1)*We;return Ne.slice(t,t+We)},[Ne,he,We]),Xt=async()=>{$(!0),q(null);try{const t=await h.brandsList();ct(t)}catch(t){q(t.message)}finally{$(!1)}},Vn=g==="ar"?M?.setting?.siteNameAr||"Ø´Ø±ÙƒØ© Ù…Ù†ÙØ° Ø§Ø³ÙŠØ§ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©":M?.setting?.siteNameEn||"My Store",Kt=g==="ar"?`Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | ${Vn}`:`${Vn} | Admin Dashboard`;s.useEffect(()=>{try{document.title=Kt}catch{}},[Kt]);const Yt=async()=>{$(!0),q(null);try{const t=await fetch("/api/brands/maintenance/scan",{headers:ge()});if(!t.ok)throw new Error("ÙØ´Ù„ Ø§Ù„ÙØ­Øµ");const n=await t.json();Ar(n.issues||{})}catch(t){q(t.message)}finally{$(!1)}},Hn=async t=>{$(!0),q(null);try{if(!(await fetch("/api/brands/maintenance/regen-logos",{method:"POST",headers:{...ge(),"Content-Type":"application/json"},body:JSON.stringify(t?{brandId:t}:{})})).ok)throw new Error("ÙØ´Ù„ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±");await Yt(),alert("ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ ØµÙˆØ± Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª")}catch(n){q(n.message)}finally{$(!1)}},Wr=async(t,n)=>{$(!0),q(null);try{if(!(await fetch("/api/brands/maintenance/merge",{method:"POST",headers:{...ge(),"Content-Type":"application/json"},body:JSON.stringify({targetId:t,sourceIds:n})})).ok)throw new Error("ÙØ´Ù„ Ø§Ù„Ø¯Ù…Ø¬");await Xt(),await Yt(),alert("ØªÙ… Ø§Ù„Ø¯Ù…Ø¬ Ø¨Ù†Ø¬Ø§Ø­")}catch(r){q(r.message)}finally{$(!1)}},Br=async t=>{t.preventDefault(),$(!0),q(null);try{const n=!!Oe;let r;if(n?(r=new FormData,y.slug&&r.append("slug",y.slug),r.append("nameAr",y.nameAr),r.append("nameEn",y.nameEn),y.descriptionAr&&r.append("descriptionAr",y.descriptionAr),y.descriptionEn&&r.append("descriptionEn",y.descriptionEn),Oe&&r.append("logo",Oe)):r={slug:y.slug||void 0,nameAr:y.nameAr,nameEn:y.nameEn,descriptionAr:y.descriptionAr||null,descriptionEn:y.descriptionEn||null,logo:y.logo||null},y.id){const i=n?await fetch(`/api/brands/${y.id}`,{method:"PUT",body:r,headers:ge()}).then(l=>l.json()):await h.brandUpdate(y.id,r);i?.id&&ct(l=>l.map(u=>u.id===i.id?i:u))}else{const i=n?await fetch("/api/brands",{method:"POST",body:r,headers:ge()}).then(l=>l.json()):await h.brandCreate(r);i?.id&&ct(l=>[i,...l])}Z({id:null,slug:"",nameAr:"",nameEn:"",descriptionAr:"",descriptionEn:"",logo:""}),zn(null)}catch(n){q(n.message)}finally{$(!1)}},Ur=async t=>{const n=window.prompt("Ø­Ø°Ù Ø§Ù„Ø¹Ù„Ø§Ù…Ø©ØŸ Ø§ÙƒØªØ¨: none Ù„Ø¥Ù„ØºØ§Ø¡ Ø±Ø¨Ø· Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (force)ØŒ Ø£Ùˆ brand:<TARGET_ID> Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ø¹Ù„Ø§Ù…Ø© Ø£Ø®Ø±Ù‰ØŒ Ø£Ùˆ Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±Øº Ù„Ù„Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¥Ø°Ø§ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª.");let r=`/api/brands/${t}`;if(n&&n.startsWith("brand:")){const i=n.split(":")[1];r+=`?reassignTo=${encodeURIComponent(i)}`}else n==="none"&&(r+="?force=1");try{if(!(await fetch(r,{method:"DELETE",headers:ge()})).ok)throw new Error("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù");ct(l=>l.filter(u=>u.id!==t))}catch(i){alert("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù: "+i.message)}},$r=async()=>{Ee(!0),Pe(null);try{const[t,n,r]=await Promise.all([h.marketingFeatures(),h.marketingBanners(),h.marketingAppLinks()]);ht(t),Lr(n),gt(r)}catch(t){Pe(t.message)}finally{Ee(!1)}},qr=async t=>{t.preventDefault(),Ee(!0),Pe(null);try{if(f.id){const n=await h.marketingFeatureUpdate(f.id,{titleAr:f.titleAr,titleEn:f.titleEn,bodyAr:f.bodyAr||null,bodyEn:f.bodyEn||null,icon:f.icon||null,sort:f.sort,active:f.active});ht(r=>r.map(i=>i.id===n.id?n:i))}else{const n=await h.marketingFeatureCreate({titleAr:f.titleAr,titleEn:f.titleEn,bodyAr:f.bodyAr||null,bodyEn:f.bodyEn||null,icon:f.icon||null,sort:f.sort,active:f.active});ht(r=>[n,...r])}V({id:null,titleAr:"",titleEn:"",bodyAr:"",bodyEn:"",icon:"",sort:0,active:!0})}catch(n){Pe(n.message)}finally{Ee(!1)}},Vr=async t=>{if(window.confirm("Ø­Ø°Ù Ø§Ù„Ù…ÙŠØ²Ø©ØŸ"))try{await h.marketingFeatureDelete(t),ht(n=>n.filter(r=>r.id!==t))}catch(n){alert("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù: "+n.message)}},Hr=async t=>{t.preventDefault(),Ee(!0),Pe(null);try{if(A.id){const n=await h.marketingAppLinkUpdate(A.id,{platform:A.platform,url:A.url,labelAr:A.labelAr||null,labelEn:A.labelEn||null,active:A.active});gt(r=>r.map(i=>i.id===n.id?n:i))}else{const n=await h.marketingAppLinkCreate({platform:A.platform,url:A.url,labelAr:A.labelAr||null,labelEn:A.labelEn||null,active:A.active});gt(r=>[n,...r])}se({id:null,platform:"web",url:"",labelAr:"",labelEn:"",active:!0})}catch(n){Pe(n.message)}finally{Ee(!1)}},Qr=async t=>{if(window.confirm("Ø­Ø°Ù Ø§Ù„Ø±Ø§Ø¨Ø·ØŸ"))try{await h.marketingAppLinkDelete(t),gt(n=>n.filter(r=>r.id!==t))}catch(n){alert("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù: "+n.message)}};s.useEffect(()=>{p==="brands"&&!Me.length&&Xt()},[p]),s.useEffect(()=>{p==="marketing"&&!pt.length&&!Ut.length&&$r()},[p]),s.useEffect(()=>{p==="settings"&&!Ot&&en()},[p]);function ge(){try{const t=localStorage.getItem("my_store_token");if(t)return{Authorization:"Bearer "+t}}catch{}return{}}const ze=s.useMemo(()=>{let t=[...Me];const n=(()=>{const r={duplicates:new Set,noLogo:new Set,zeroProducts:new Set,missingVariants:new Set};if(!R)return r;const i={...r};for(const l of R.duplicateNames||[])for(const u of l.ids||[])i.duplicates.add(u);for(const l of R.noLogo||[])i.noLogo.add(l.id);for(const l of R.zeroProducts||[])i.zeroProducts.add(l.id);for(const l of R.missingLogoVariants||[])i.missingVariants.add(l.id);return i})();if(Wt){const r=n[Wt]||new Set;t=t.filter(i=>r.has(i.id))}if(dt){const r=dt.toLowerCase();t=t.filter(i=>((z(i.name,g)||i.name?.ar||i.name?.en||i.slug||"")+"").toLowerCase().includes(r))}return t.sort((r,i)=>{switch(Nt){case"name_ar":return(r.name?.ar||"").localeCompare(i.name?.ar||"");case"name_en":return(r.name?.en||"").localeCompare(i.name?.en||"");case"products_desc":return(i.productCount||0)-(r.productCount||0);case"products_asc":return(r.productCount||0)-(i.productCount||0);case"created_asc":return new Date(r.createdAt)-new Date(i.createdAt);case"created_desc":default:return new Date(i.createdAt)-new Date(r.createdAt)}}),t},[Me,dt,Nt]),[me,Zt]=s.useState(1),[Be,Gr]=s.useState(30),vt=Math.max(1,Math.ceil((ze.length||0)/Be)),Jr=s.useMemo(()=>{const t=(me-1)*Be;return ze.slice(t,t+Be)},[ze,me,Be]),Qn=s.useMemo(()=>{let t=[...pt];if(yt){const n=yt.toLowerCase();t=t.filter(r=>(r.title?.ar||"").toLowerCase().includes(n)||(r.title?.en||"").toLowerCase().includes(n))}return t.sort((n,r)=>{switch(Ht){case"title_ar":return(n.title?.ar||"").localeCompare(r.title?.ar||"");case"title_en":return(n.title?.en||"").localeCompare(r.title?.en||"");case"sort_desc":return(r.sort||0)-(n.sort||0);case"sort_asc":default:return(n.sort||0)-(r.sort||0)}}),t},[pt,yt,Ht]);s.useMemo(()=>{let t=[...Ut];if(Vt){const n=Vt.toLowerCase();t=t.filter(r=>(r.title?.ar||"").toLowerCase().includes(n)||(r.title?.en||"").toLowerCase().includes(n)||(r.location||"").toLowerCase().includes(n))}return t.sort((n,r)=>{switch($n){case"location":return(n.location||"").localeCompare(r.location||"");case"sort_desc":return(r.sort||0)-(n.sort||0);case"sort_asc":default:return(n.sort||0)-(r.sort||0)}}),t},[Ut,Vt,$n]);const Gn=s.useMemo(()=>{let t=[...$t];if(ft){const n=ft.toLowerCase();t=t.filter(r=>(r.platform||"").toLowerCase().includes(n)||(r.url||"").toLowerCase().includes(n))}return t.sort((n,r)=>{switch(Qt){case"platform_desc":return(r.platform||"").localeCompare(n.platform||"");case"platform_asc":default:return(n.platform||"").localeCompare(r.platform||"")}}),t},[$t,ft,Qt]),Jn=()=>{N({id:null,nameAr:"",nameEn:"",price:"",stock:"",status:"active",category:"general",oldPrice:"",image:""}),Ke(null),gr({id:null,name:"",role:"user",active:!0}),mr({id:null,total:"",status:"pending",customer:"",items:1})},en=async()=>{if(M?.setting){ke(M.setting);return}de(!0),ue(null);try{const n=await(await fetch("/api/settings")).json().catch(()=>null);n?.setting&&ke(n.setting)}catch(t){ue(t.message)}finally{de(!1)}},Xr=async t=>{t?.preventDefault?.(),de(!0),ue(null);try{const n=Object.fromEntries(Object.entries(C).filter(([r,i])=>i!=null&&i!==""));if(Object.keys(n).length===0){ue("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø­Ù‚Ù„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸."),de(!1);return}if(M?.update){const r=await M.update(n);r?.setting&&ke(r.setting)}else{const r=await fetch("/api/settings",{method:"PATCH",headers:{...ge(),"Content-Type":"application/json"},body:JSON.stringify(n)}),i=await r.json().catch(()=>null);if(!r.ok)throw new Error(i?.message||"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª");i?.setting&&ke(i.setting)}alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª")}catch(n){ue(n.message)}finally{de(!1)}},Kr=async t=>{t.preventDefault();const n=re==="file"&&!!K;let r;n?(r=new FormData,r.append("nameAr",d.nameAr||d.nameEn||"Ù…Ù†ØªØ¬"),r.append("nameEn",d.nameEn||d.nameAr||"Product"),r.append("price",d.price||"0"),r.append("stock",d.stock||"0"),r.append("status",d.status||"active"),d.slug&&r.append("slug",d.slug),r.append("category",d.category||"general"),d.oldPrice&&r.append("oldPrice",d.oldPrice),K&&r.append("image",K)):r={name:{ar:d.nameAr||d.nameEn||"Ù…Ù†ØªØ¬",en:d.nameEn||d.nameAr||"Product"},price:+d.price,stock:+d.stock,status:d.status,slug:d.slug,category:d.category||"general",oldPrice:d.oldPrice?+d.oldPrice:void 0,image:d.image||void 0};try{if(I(!0),!d.id&&a){const i=b=>(b||"").toString().trim().toLowerCase(),l=i(d.nameAr||""),u=i(d.nameEn||""),W=i(d.slug||"");if(F.find(b=>{const Fe=i(b.name?.ar||b.nameAr||""),rs=i(b.name?.en||b.nameEn||""),ss=i(b.slug||"");return l&&Fe===l||u&&rs===u||W&&ss===W})){const b="Ø§Ù„Ù…Ù†ØªØ¬ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ (Ø§Ø³Ù… Ø£Ùˆ Ù…Ø¹Ø±Ù Ù…ÙƒØ±Ø±)";De(b);try{window.dispatchEvent(new CustomEvent("toast:show",{detail:{type:"warn",title:"ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬",description:b}}))}catch{}I(!1);return}}if(d.id&&a){const i=n?await h.updateProductForm(d.id,r):await h.updateProduct(d.id,r);c(l=>l.map(u=>u.id===i.id?i:u)),fe(l=>[{ts:Date.now(),action:"update_product",id:i.id},...l].slice(0,200))}else if(a){const i=n?await h.createProductForm(r):await h.createProduct(r);c(l=>[i,...l]),fe(l=>[{ts:Date.now(),action:"create_product",id:i.id},...l].slice(0,200))}else d.id?(L(d.id,r),fe(i=>[{ts:Date.now(),action:"update_product_local",id:d.id},...i].slice(0,200))):(o(r),fe(i=>[{ts:Date.now(),action:"create_product_local"},...i].slice(0,200)));Jn()}catch(i){const l=i?.message||"";let u=l;if(i?.code==="DUPLICATE_PRODUCT"||l.includes("SLUG_EXISTS")||l.includes("DUPLICATE_PRODUCT")){u="Ø§Ù„Ù…Ù†ØªØ¬ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ (Slug/SKU/Ø§Ù„Ø§Ø³Ù…)";try{window.dispatchEvent(new CustomEvent("toast:show",{detail:{type:"warn",title:"ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬",description:u}}))}catch{}}l.includes("UNSUPPORTED_FILE_TYPE")?u="ØµÙŠØºØ© ØµÙˆØ±Ø© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø©. Ø§Ù„Ù…Ø³Ù…ÙˆØ­: JPG/PNG/WEBP":l.includes("FILE_TOO_LARGE")?u="Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ø­Ø¯ (4MB)":l.includes("UPLOAD_ERROR")?u="ÙØ´Ù„ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©. Ø¬Ø±Ù‘Ø¨ Ù…Ù„ÙØ§Ù‹ Ø¢Ø®Ø±":l.includes("FORBIDDEN")&&(u='ØªØ­ØªØ§Ø¬ ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø¯ÙŠØ±. Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± "ØªØ³Ø¬ÙŠÙ„ Ù…Ø¯ÙŠØ± (dev)" Ø£Ùˆ Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ±.'),De(u)}finally{I(!1)}},Le=({label:t,value:n,deltaPct:r})=>{const i=typeof r=="number"?r:null,l=i!=null?i>=0:null;return e.jsxs("div",{style:Ct,children:[e.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:8},children:[e.jsx("div",{style:Yn,children:n}),i!=null&&e.jsxs("span",{style:{fontSize:".7rem",fontWeight:800,padding:".15rem .4rem",borderRadius:999,lineHeight:1,background:l?"rgba(var(--color-primary-rgb),0.12)":"rgba(220,38,38,0.08)",color:l?"var(--color-primary)":"#991b1b",border:l?"1px solid rgba(var(--color-primary-rgb),0.28)":"1px solid rgba(220,38,38,0.25)"},"aria-label":l?"Ø²ÙŠØ§Ø¯Ø©":"Ø§Ù†Ø®ÙØ§Ø¶",children:[l?"â†‘":"â†“"," ",Math.abs(i).toFixed(0),"%"]})]}),e.jsx("div",{style:Zn,children:t})]})};s.useEffect(()=>{let t=!0;return(async()=>{I(!0),De(null);try{const n=await h.listProducts();t&&Array.isArray(n)&&(c(n),P(!0))}catch(n){t&&(De(n.message),P(!1))}finally{t&&I(!1)}})(),()=>{t=!1}},[]),s.useEffect(()=>{if(p!=="products")return;let t=!0;const n="admin_cat_cache_v1",r=300*1e3,i=Date.now();try{const l=localStorage.getItem(n);if(l){const u=JSON.parse(l);u?.expires>i&&Array.isArray(u.data)&&It(u.data)}}catch{}return it(!0),ot(null),h.listCategories({withCounts:1}).then(l=>{const u=Array.isArray(l?.categories)?l.categories:[],W=new Map;for(const b of u)b?.slug&&!W.has(b.slug)&&W.set(b.slug,b);const tn=Array.from(W.values()).sort((b,Fe)=>(Fe.productCount||0)-(b.productCount||0)||String(b.name?.ar||b.name?.en||b.slug).localeCompare(String(Fe.name?.ar||Fe.name?.en||Fe.slug),"ar"));t&&It(tn);try{localStorage.setItem(n,JSON.stringify({data:tn,expires:i+r}))}catch{}}).catch(l=>{t&&ot(l.message||"ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª")}).finally(()=>{t&&it(!1)}),()=>{t=!1}},[p]);const Xn=s.useMemo(()=>lt.map(t=>({value:t.slug,label:z(t.name,g)||t.name?.ar||t.name?.en||t.slug})),[lt,g]);s.useEffect(()=>{let t=!0;return(async()=>{if(["users","overview","audit"].includes(p)){an(!0),on(null);try{const n=[];(p==="users"||p==="overview")&&n.push(xe.listUsers().catch(l=>({error:l}))),p==="audit"&&n.push(xe.listAudit({page:ae}).catch(l=>({error:l}))),p==="overview"&&n.push(xe.statsOverview().catch(l=>({error:l})));const r=await Promise.all(n);let i=0;if(p==="users"||p==="overview"){const l=r[i++];!l?.error&&l?.users&&rr(l.users)}if(p==="audit"){const l=r[i++];!l?.error&&l?.logs&&(sr(l.logs),lr(l.totalPages||1))}if(p==="overview"){const l=r[r.length-1];!l?.error&&l?.stats&&or(l.stats)}}catch(n){t&&on(n.message)}finally{t&&an(!1)}}})(),()=>{t=!1}},[p,ae,ir]);const Yr=()=>{ar(t=>t+1)};s.useEffect(()=>{if(p!=="overview")return;let t=!0;return(async()=>{pn(!0),gn(null);try{const[n,r]=await Promise.all([xe.statsFinancials({days:Tt}),xe.listOrders({page:1,pageSize:10})]);if(!t)return;n?.daily&&dr(n),Array.isArray(r?.orders)&&ur(r.orders)}catch(n){t&&gn(n.message)}finally{t&&pn(!1)}})(),()=>{t=!1}},[p,Tt]);const Zr=s.useMemo(()=>{try{const t=T?.daily||[];if(!Array.isArray(t)||t.length<2)return null;const n=t[t.length-1]?.revenue??null,r=t[t.length-2]?.revenue??null;return typeof n!="number"||typeof r!="number"||r===0?null:(n-r)/Math.abs(r)*100}catch{return null}},[T]),es=s.useMemo(()=>{try{const t=T?.daily||[];if(!Array.isArray(t)||t.length<2)return null;const n=t[t.length-1]?.orders??null,r=t[t.length-2]?.orders??null;return typeof n!="number"||typeof r!="number"||r===0?null:(n-r)/Math.abs(r)*100}catch{return null}},[T]),ts=s.useMemo(()=>{try{const t=T?.daily||[];if(!Array.isArray(t)||t.length<2)return null;const n=t[t.length-1]?.aov??null,r=t[t.length-2]?.aov??null;return typeof n!="number"||typeof r!="number"||r===0?null:(n-r)/Math.abs(r)*100}catch{return null}},[T]),ns=async()=>{Mn(!0),On(null);try{const t=await h.listOffers();Fr(Array.isArray(t)?t:[])}catch(t){On(t.message)}finally{Mn(!1)}};s.useEffect(()=>{p==="offers"&&!qt.length&&ns()},[p]),s.useEffect(()=>{if(p!=="offers"||lt.length)return;let t=!0;return it(!0),ot(null),h.listCategories({withCounts:1}).then(n=>{const r=Array.isArray(n?.categories)?n.categories:[],i=new Map;for(const u of r)u?.slug&&!i.has(u.slug)&&i.set(u.slug,u);const l=Array.from(i.values()).sort((u,W)=>(W.productCount||0)-(u.productCount||0)||String(u.name?.ar||u.name?.en||u.slug).localeCompare(String(W.name?.ar||W.name?.en||W.slug),"ar"));t&&It(l)}).catch(n=>{t&&ot(n.message||"ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª")}).finally(()=>{t&&it(!1)}),()=>{t=!1}},[p,lt.length]),s.useMemo(()=>{let t=[...qt];const n=(In||"").toLowerCase();switch(n&&(t=t.filter(r=>((z(r.name,g)||r.name?.ar||r.name?.en||"")+"").toLowerCase().includes(n))),Wn&&(t=t.filter(r=>(r.category||"")===Wn)),Nn){case"discount_desc":t.sort((r,i)=>(r.originalPrice||r.oldPrice||0)-(r.price||0)<(i.originalPrice||i.oldPrice||0)-(i.price||0)?1:-1);break;case"price_asc":t.sort((r,i)=>(r.price||0)-(i.price||0));break;case"price_desc":t.sort((r,i)=>(i.price||0)-(r.price||0));break;case"recent":default:t.sort((r,i)=>String(i.updatedAt||i.id).localeCompare(String(r.updatedAt||r.id)))}return t},[qt,In,Nn]),s.useEffect(()=>{p==="offers"&&(F.length||(async()=>{try{const t=await h.listProducts();Array.isArray(t)&&(c(t),P(!0))}catch{}})())},[p,F.length]);const Kn=s.useMemo(()=>{const t=(mt||"").toLowerCase();return(a?F:B).filter(n=>!n.oldPrice&&n.price>0).filter(n=>t?(z(n.name,g)||n.name?.ar||n.name?.en||n.name||"").toLowerCase().includes(t):!0).slice(0,300)},[a,F,B,mt,g]);return s.useMemo(()=>{const t=(mt||"").toLowerCase();let n=(a?F:B).filter(r=>(r.price||0)>0);return Bn||(n=n.filter(r=>!r.oldPrice)),t&&(n=n.filter(r=>(z(r.name,g)||r.name?.ar||r.name?.en||r.name||"").toLowerCase().includes(t))),n.slice(0,300)},[a,F,B,mt,Bn,g]),s.useMemo(()=>Kn.find(t=>t.id===xt.productId)||(a?F.find(t=>t.id===xt.productId):B.find(t=>t.id===xt.productId)),[Kn,xt.productId,a,F,B]),S?e.jsxs("div",{className:"admin-root",style:gs,dir:g==="ar"?"rtl":"ltr",children:[e.jsx(us,{title:Kt,description:g==="ar"?"Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©":"Admin control panel"}),e.jsxs("div",{className:"admin-two-col",children:[e.jsx(ps,{}),e.jsxs("div",{children:[e.jsx("div",{className:"admin-subbar",children:e.jsx("div",{className:"admin-subbar-title",children:{overview:"Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©",offers:"Ø§Ù„Ø¹Ø±ÙˆØ¶",products:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",users:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†",orders:"Ø§Ù„Ø·Ù„Ø¨Ø§Øª",audit:"Ø§Ù„Ø³Ø¬Ù„Ø§Øª",brands:"Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª",marketing:"Ø§Ù„ØªØ³ÙˆÙŠÙ‚",settings:"Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",reviews:"Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø§Øª",cats:"Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"}[p]||"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…"})}),p==="ads"&&e.jsx(Ve.Suspense,{fallback:e.jsx("div",{style:{padding:24},children:"ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª..."}),children:e.jsx(hs,{})}),p==="overview"&&e.jsxs("div",{className:"admin-stat-grid",children:[Je?e.jsx(e.Fragment,{children:Array.from({length:6}).map((t,n)=>e.jsx("div",{className:"skeleton",style:{height:96}},n))}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{label:"Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…",value:Ye.todayOrders,deltaPct:es}),e.jsx(Le,{label:"Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…",value:Ye.todayRevenue.toFixed(2),deltaPct:Zr}),e.jsx(Le,{label:"Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ù„Ø© (Ø§Ù„ÙŠÙˆÙ…)",value:Ye.avgOrderValueToday.toFixed(2),deltaPct:ts}),e.jsxs("div",{style:Ct,children:[e.jsx("div",{style:Yn,children:Ye.pendingBankCount}),e.jsx("div",{style:Zn,children:"ØªØ­ÙˆÙŠÙ„Ø§Øª Ø¨Ù†ÙƒÙŠØ© Ù…Ø¹Ù„Ù‚Ø©"}),e.jsx("div",{style:{marginTop:6},children:e.jsx("a",{href:"/admin/bank-transfers",style:{fontSize:".7rem",textDecoration:"none",color:"var(--color-primary)"},children:"Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¢Ù† â†’"})})]}),e.jsx(Le,{label:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",value:B.length}),e.jsx(Le,{label:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†",value:Ft.length||te.length}),e.jsx(Le,{label:"ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Ù…Ø­Ù„ÙŠ)",value:D.length})]}),e.jsxs("div",{style:{...Ct,gridColumn:"1/-1"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontWeight:700},children:"Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø§Ù„ÙŠ"}),e.jsx("div",{children:e.jsx("select",{value:Tt,onChange:t=>cr(+t.target.value),style:v,children:[7,14,30,60].map(t=>e.jsxs("option",{value:t,children:[t," ÙŠÙˆÙ…"]},t))})})]}),un&&e.jsxs("div",{children:[e.jsx("div",{className:"skeleton",style:{height:18,width:"45%",marginBottom:10}}),e.jsx("div",{className:"skeleton",style:{height:120,width:"100%"}})]}),hn&&e.jsxs("div",{style:{fontSize:".7rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",hn]}),T&&e.jsxs("div",{style:{display:"grid",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[e.jsxs("div",{style:kt,children:[e.jsx("div",{style:At,children:Number(T.totals?.totalRevenue||0).toFixed(2)}),e.jsx("div",{style:Et,children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯"})]}),e.jsxs("div",{style:kt,children:[e.jsx("div",{style:At,children:T.totals?.totalOrders||0}),e.jsx("div",{style:Et,children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª"})]}),e.jsxs("div",{style:kt,children:[e.jsx("div",{style:At,children:Number(T.totals?.overallAov||0).toFixed(2)}),e.jsx("div",{style:Et,children:"Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ù„Ø©"})]}),e.jsxs("div",{style:kt,children:[e.jsx("div",{style:At,children:T.totals?.activeCustomersWindow||0}),e.jsx("div",{style:Et,children:"Ø¹Ù…Ù„Ø§Ø¡ Ù†Ø´Ø·ÙˆÙ†"})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${T.daily.length}, minmax(2px,1fr))`,gap:2,alignItems:"end",height:120,background:"var(--color-bg-alt)",border:"1px solid var(--color-border-soft)",borderRadius:10,padding:6},"aria-label":"Ù…Ø®Ø·Ø· Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª",children:(()=>{const t=Math.max(1,...T.daily.map(n=>n.revenue||0));return T.daily.map(n=>{const r=Math.round((n.revenue||0)/t*100);return e.jsx("div",{title:`${n.date} â€¢ ${Number(n.revenue||0).toFixed(2)}`,style:{height:`${r}%`,background:"linear-gradient(180deg, var(--color-primary), var(--color-gold))",borderRadius:3}},n.date)})})()})]})]}),e.jsxs("div",{style:{...Ct,gridColumn:"1/-1"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontWeight:700},children:"Ø£Ø­Ø¯Ø« 10 Ø·Ù„Ø¨Ø§Øª"}),e.jsx("a",{href:"/admin/reports",style:{fontSize:".7rem",textDecoration:"none",color:"var(--color-primary)"},children:"Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± â†’"})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{...H,marginTop:8},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx("th",{children:"Ø§Ù„Ø­Ø§Ù„Ø©"}),e.jsx("th",{children:"Ø·Ø±ÙŠÙ‚Ø©"}),e.jsx("th",{children:"Ø§Ù„ÙˆÙ‚Øª"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[mn.map(t=>e.jsxs("tr",{children:[e.jsx("td",{style:{maxWidth:160,overflow:"hidden",textOverflow:"ellipsis"},children:t.id}),e.jsxs("td",{children:[t.grandTotal?.toFixed?t.grandTotal.toFixed(2):t.grandTotal," ",t.currency]}),e.jsx("td",{children:e.jsx("span",{style:ys(t.status),children:t.status})}),e.jsx("td",{children:t.paymentMethod||"-"}),e.jsx("td",{children:new Date(t.createdAt).toLocaleString()}),e.jsxs("td",{style:ee,children:[e.jsx("a",{href:`/order/${t.id}`,style:{fontSize:".65rem",textDecoration:"none",color:"var(--color-primary)"},children:"Ø¹Ø±Ø¶"}),e.jsx("a",{href:`/api/orders/${t.id}/invoice`,target:"_blank",rel:"noopener",style:{fontSize:".65rem",textDecoration:"none",color:"#075985"},children:"ÙØ§ØªÙˆØ±Ø©"})]})]},t.id)),!mn.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:Q,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª"})})]})]})})]}),e.jsxs("div",{style:{gridColumn:"1/-1"},children:[e.jsx("h3",{style:ie,children:"Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·"}),e.jsxs("ul",{style:{listStyle:"none",margin:0,padding:0,maxHeight:200,overflow:"auto",fontSize:".65rem",direction:"ltr"},children:[xn.slice(0,12).map(t=>e.jsxs("li",{children:[new Date(t.ts).toLocaleTimeString()," - ",t.action," ",t.id||""]},t.ts+""+t.action)),!xn.length&&e.jsx("li",{children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø· Ø¨Ø¹Ø¯."})]}),Je&&e.jsx("div",{style:{fontSize:".6rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),Xe&&e.jsxs("div",{style:{fontSize:".6rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",Xe]})]})]}),p==="products"&&e.jsxs("div",{style:le,children:[e.jsxs("form",{onSubmit:Kr,style:He,children:[e.jsx("h3",{style:ie,children:d.id?"ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†ØªØ¬":"Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬"}),e.jsxs("div",{style:Qe,children:[e.jsx("input",{placeholder:"Ø§Ù„Ø§Ø³Ù… (AR)",value:d.nameAr,onChange:t=>N(n=>({...n,nameAr:t.target.value}))}),e.jsx("input",{placeholder:"Name (EN)",value:d.nameEn,onChange:t=>N(n=>({...n,nameEn:t.target.value}))}),e.jsx("input",{type:"number",placeholder:"Ø§Ù„Ø³Ø¹Ø±",required:!0,value:d.price,onChange:t=>N(n=>({...n,price:t.target.value}))}),e.jsx("input",{type:"number",placeholder:"Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",required:!0,value:d.stock,onChange:t=>N(n=>({...n,stock:t.target.value}))}),e.jsx("input",{placeholder:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚",type:"number",value:d.oldPrice,onChange:t=>N(n=>({...n,oldPrice:t.target.value}))}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsxs("select",{value:d.category,onChange:t=>N(n=>({...n,category:t.target.value})),children:[e.jsx("option",{value:"",children:"Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ"}),Xn.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),Pn&&e.jsx("span",{style:{fontSize:".6rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"}),at&&e.jsxs("span",{style:{fontSize:".6rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",at]})]}),e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[e.jsx("div",{style:{fontSize:".7rem",fontWeight:600},children:"ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬:"}),e.jsxs("div",{style:{display:"inline-flex",background:"#f1f5f9",borderRadius:8,overflow:"hidden"},children:[e.jsx("button",{type:"button",onClick:()=>{cn("file"),N(t=>({...t,image:""}))},style:{...E,width:"auto",padding:".3rem .6rem",background:re==="file"?"#69be3c":"#e2e8f0",color:re==="file"?"#fff":"#0f172a"},children:"Ø±ÙØ¹ Ù…Ù„Ù"}),e.jsx("button",{type:"button",onClick:()=>{cn("url"),Ke(null)},style:{...E,width:"auto",padding:".3rem .6rem",background:re==="url"?"#69be3c":"#e2e8f0",color:re==="url"?"#fff":"#0f172a"},children:"Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø©"})]})]}),re==="file"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("input",{ref:dn,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:t=>{const n=t.target.files?.[0];Ke(n||null)},style:{display:"none"}}),e.jsx("button",{type:"button",onClick:()=>dn.current?.click(),style:m,children:"Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ"}),K&&e.jsx("span",{style:{fontSize:".65rem",color:"#475569"},children:K.name})]}),e.jsx("div",{style:{fontSize:".6rem",color:"#64748b"},children:"Ø§Ù„Ù…Ø³Ù…ÙˆØ­: JPG/PNG/WEBP Â· Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 4MB"}),re==="url"&&e.jsx("input",{placeholder:"Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (https://...)",value:d.image,onChange:t=>N(n=>({...n,image:t.target.value}))}),(K||d.id||d.image)&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-start"},children:[e.jsx("span",{style:{fontSize:".55rem",opacity:.7},children:"Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©"}),e.jsx("img",{alt:"preview",src:K?URL.createObjectURL(K):d.image||F.find(t=>t.id===d.id)?.imageVariants?.thumb||F.find(t=>t.id===d.id)?.image||"/vite.svg",style:{width:90,height:90,objectFit:"cover",borderRadius:8,border:"1px solid #e2e8f0"}}),K&&e.jsx("button",{type:"button",onClick:()=>Ke(null),style:{...x,fontSize:".55rem",padding:".3rem .5rem"},children:"Ø¥Ø²Ø§Ù„Ø©"})]}),e.jsxs("select",{value:d.status,onChange:t=>N(n=>({...n,status:t.target.value})),children:[e.jsx("option",{value:"active",children:"Ù†Ø´Ø·"}),e.jsx("option",{value:"draft",children:"Ù…Ø³ÙˆØ¯Ø©"}),e.jsx("option",{value:"archived",children:"Ù…Ø¤Ø±Ø´Ù"})]})]}),e.jsxs("div",{style:Ge,children:[e.jsxs("button",{type:"submit",style:m,children:[e.jsx(bt,{size:16})," ",d.id?"Ø­ÙØ¸":"Ø¥Ø¶Ø§ÙØ©"]}),d.id&&e.jsxs("button",{type:"button",style:x,onClick:Jn,children:[e.jsx(St,{size:16})," Ø¥Ù„ØºØ§Ø¡"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:".75rem",flexWrap:"wrap"},children:[e.jsxs("select",{value:Dt,onChange:t=>pr(t.target.value),style:v,children:[e.jsx("option",{value:"created_desc",children:"Ø§Ù„Ø£Ø­Ø¯Ø«"}),e.jsx("option",{value:"created_asc",children:"Ø§Ù„Ø£Ù‚Ø¯Ù…"}),e.jsx("option",{value:"price_desc",children:"Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø±Ø§Ù‹"}),e.jsx("option",{value:"price_asc",children:"Ø§Ù„Ø£Ù‚Ù„ Ø³Ø¹Ø±Ø§Ù‹"}),e.jsx("option",{value:"stock_desc",children:"Ø£Ø¹Ù„Ù‰ Ù…Ø®Ø²ÙˆÙ†"}),e.jsx("option",{value:"stock_asc",children:"Ø£Ù‚Ù„ Ù…Ø®Ø²ÙˆÙ†"})]}),e.jsxs("select",{value:Ze,onChange:t=>hr(t.target.value),style:v,children:[e.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"}),Xn.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),Pn&&e.jsx("span",{style:{fontSize:".65rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"}),at&&e.jsxs("span",{style:{fontSize:".65rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",at]})]}),e.jsxs("table",{style:H,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„Ø§Ø³Ù…"}),e.jsx("th",{children:"Ø§Ù„ØªØµÙ†ÙŠÙ"}),e.jsx("th",{children:"Ø§Ù„Ø³Ø¹Ø±"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø®Ø²ÙˆÙ†"}),e.jsx("th",{children:"Ø§Ù„Ø­Ø§Ù„Ø©"}),e.jsx("th",{children:"Ø´Ø±Ø§Ø¦Ø­"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[fr.map(t=>{const n=U===t.id,r=fn[t.id]||[],i=r.length?r[0]:null;return e.jsxs(Ve.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{children:z(t.name,g)||t.name?.ar||t.name?.en||t.name}),e.jsx("td",{children:t.category}),e.jsx("td",{children:t.price}),e.jsx("td",{style:t.stock<5?{color:"#b91c1c",fontWeight:600}:{},children:t.stock}),e.jsx("td",{children:t.status}),e.jsxs("td",{children:[e.jsx("button",{onClick:()=>br(t.id),style:{...E,width:"auto",padding:"0 .5rem",background:n?"#69be3c":E.background,color:n?"#fff":E.color,fontSize:".6rem"},children:n?"Ø¥Ø®ÙØ§Ø¡":"Ø¥Ø¯Ø§Ø±Ø©"}),r.length>0&&e.jsxs("div",{style:{fontSize:".55rem",marginTop:4,opacity:.7},children:[r.length," Ø´Ø±ÙŠØ­Ø©",i?` (Ù…Ù† ${i.price})`:""]})]}),e.jsxs("td",{style:ee,children:[e.jsx("button",{onClick:()=>N({id:t.id,nameAr:t.name?.ar||"",nameEn:t.name?.en||"",price:t.price,stock:t.stock,status:t.status,category:t.category||"general",oldPrice:t.oldPrice||"",image:t.image||""}),title:"ØªØ¹Ø¯ÙŠÙ„",style:E,children:e.jsx(Ue,{size:16})}),e.jsx("button",{onClick:async()=>{if(a)try{await h.deleteProduct(t.id),c(l=>l.filter(u=>u.id!==t.id)),fe(l=>[{ts:Date.now(),action:"delete_product",id:t.id},...l].slice(0,200))}catch(l){De(l.message)}else j(t.id),fe(l=>[{ts:Date.now(),action:"delete_product_local",id:t.id},...l].slice(0,200))},title:"Ø­Ø°Ù",style:ye,children:e.jsx(wt,{size:16})})]})]}),n&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{background:"#f8fafc",padding:"1rem .75rem"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:".75rem"},children:[e.jsxs("form",{onSubmit:Sr,style:{display:"flex",flexWrap:"wrap",gap:6,alignItems:"flex-end"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("label",{style:$e,children:"Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰"}),e.jsx("input",{required:!0,type:"number",value:w.minQty,onChange:l=>Y(u=>({...u,minQty:l.target.value})),style:qe})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("label",{style:$e,children:"Ø§Ù„Ø³Ø¹Ø±"}),e.jsx("input",{required:!0,type:"number",step:"0.01",value:w.price,onChange:l=>Y(u=>({...u,price:l.target.value})),style:qe})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("label",{style:$e,children:"Ø§Ù„ØªØºÙ„ÙŠÙ"}),e.jsx("select",{value:w.packagingType,onChange:l=>Y(u=>({...u,packagingType:l.target.value})),style:qe,children:jr.map(l=>e.jsx("option",{value:l,children:l},l))})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("label",{style:$e,children:"Ù…Ù„Ø§Ø­Ø¸Ø© AR"}),e.jsx("input",{value:w.noteAr,onChange:l=>Y(u=>({...u,noteAr:l.target.value})),style:qe})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("label",{style:$e,children:"Note EN"}),e.jsx("input",{value:w.noteEn,onChange:l=>Y(u=>({...u,noteEn:l.target.value})),style:qe})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{type:"submit",style:{...m,fontSize:".6rem"},children:w.id?"ØªØ­Ø¯ÙŠØ«":"Ø¥Ø¶Ø§ÙØ©"}),w.id&&e.jsx("button",{type:"button",style:{...x,fontSize:".6rem"},onClick:()=>Y(nt),children:"Ø¥Ù„ØºØ§Ø¡"})]})]}),e.jsxs("div",{style:{overflowX:"auto"},children:[e.jsxs("table",{style:{...H,boxShadow:"none",margin:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"MinQty"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Packaging"}),e.jsx("th",{children:"Note"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[r.map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:l.minQty}),e.jsx("td",{children:l.price}),e.jsx("td",{children:l.packagingType}),e.jsx("td",{style:{fontSize:".6rem"},children:z(l.note,g)||l.note?.ar||l.note?.en||"â€”"}),e.jsxs("td",{style:ee,children:[e.jsx("button",{style:E,title:"ØªØ¹Ø¯ÙŠÙ„",onClick:()=>wr(l),children:e.jsx(Ue,{size:14})}),e.jsx("button",{style:ye,title:"Ø­Ø°Ù",onClick:()=>Cr(l),children:"âœ•"})]})]},l.id)),!r.length&&!jn&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:Q,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ø±Ø§Ø¦Ø­"})})]})]}),jn&&e.jsx("div",{style:{fontSize:".6rem",marginTop:4},children:"...ØªØ­Ù…ÙŠÙ„"}),vn&&e.jsxs("div",{style:{fontSize:".6rem",color:"#b91c1c",marginTop:4},children:["Ø®Ø·Ø£: ",vn]})]})]})})})]},t.id)}),!je.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:Q,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬"})})]})]}),je.length>0&&e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginTop:8},children:[e.jsx("button",{style:oe===1?x:m,disabled:oe===1,onClick:()=>Rt(t=>Math.max(1,t-1)),children:"Ø§Ù„Ø³Ø§Ø¨Ù‚"}),e.jsxs("span",{style:{fontSize:".65rem"},children:["ØµÙØ­Ø© ",oe," / ",et]}),e.jsx("button",{style:oe===et?x:m,disabled:oe===et,onClick:()=>Rt(t=>Math.min(et,t+1)),children:"Ø§Ù„ØªØ§Ù„ÙŠ"}),e.jsx("span",{style:{marginInlineStart:10,fontSize:".65rem"},children:"Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ:"}),e.jsx("select",{value:_e,onChange:t=>{yr(+t.target.value),Rt(1)},style:v,children:[10,20,30,50,100].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("span",{style:{fontSize:".65rem",opacity:.7},children:[je.length," Ø¹Ù†ØµØ±"]})]}),O&&e.jsx("div",{style:{fontSize:".7rem",opacity:.7},children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸..."}),rn&&e.jsxs("div",{style:{fontSize:".7rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",rn]})]}),p==="orders"&&e.jsxs("div",{style:le,children:[e.jsx("h3",{style:ie,children:"Ø§Ù„Ø·Ù„Ø¨Ø§Øª (ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ / Ø¹Ø§Ù…)"}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:12},children:[e.jsxs("select",{value:be,onChange:t=>bn(t.target.value),style:v,children:[e.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª"}),["pending","processing","pending_bank_review","paid","shipped","completed","cancelled"].map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:Se,onChange:t=>Sn(t.target.value),style:v,children:[e.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„Ø·Ø±Ù‚"}),["paypal","bank","cod","stc"].map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("input",{type:"date",value:we,onChange:t=>wn(t.target.value),style:v}),e.jsx("input",{type:"date",value:Ce,onChange:t=>Cn(t.target.value),style:v}),e.jsx("button",{style:m,type:"button",onClick:()=>{bn(""),Sn(""),wn(""),Cn("")},children:"Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±"}),e.jsx("button",{style:m,type:"button",onClick:async()=>{try{const t=await xe.exportOrdersCsv({status:be,paymentMethod:Se,from:we,to:Ce}),n=new Blob([t],{type:"text/csv;charset=utf-8"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download="orders.csv",i.click(),URL.revokeObjectURL(r)}catch(t){alert("ÙØ´Ù„ ØªØµØ¯ÙŠØ± CSV: "+t.message)}},children:"ØªØµØ¯ÙŠØ± CSV"}),e.jsx("button",{style:m,type:"button",onClick:async()=>{try{const t=await xe.exportOrdersXlsx({status:be,paymentMethod:Se,from:we,to:Ce}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="orders.xlsx",r.click(),URL.revokeObjectURL(n)}catch(t){alert("ÙØ´Ù„ ØªØµØ¯ÙŠØ± Excel: "+t.message)}},children:"ØªØµØ¯ÙŠØ± Excel"})]}),e.jsxs("table",{style:H,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"}),e.jsx("th",{children:"Ø§Ù„Ø­Ø§Ù„Ø©"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx("th",{children:"Ø·Ø±ÙŠÙ‚Ø©"}),e.jsx("th",{children:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"}),e.jsx("th",{children:"Ù…Ø±Ø¬Ø¹"}),e.jsx("th",{children:"Ø¥ÙŠØµØ§Ù„"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[Nr.map(t=>{const n=t.paymentMeta?.bank||{},r=t.paymentMeta?.address||{},i=[r.country,r.city,r.area].filter(Boolean).join(" - ")+(r.line1?`
${r.line1}`:"")+(r.phone?`
ğŸ“ ${r.phone}`:"");return e.jsxs(Ve.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis"},children:t.id}),e.jsx("td",{children:t.userId}),e.jsx("td",{children:t.status}),e.jsxs("td",{children:[t.grandTotal?.toFixed?t.grandTotal.toFixed(2):t.grandTotal," ",t.currency]}),e.jsx("td",{children:t.paymentMethod||"-"}),e.jsxs("td",{title:i||"-",style:{fontSize:".6rem",maxWidth:180,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[r.city||r.area||r.line1?e.jsxs("span",{children:[r.city||r.area?`${r.city||""}${r.city&&r.area?" - ":""}${r.area||""}`:r.line1||"",(r.city||r.area)&&r.line1?`, ${r.line1}`:"",r.phone?` Â· ${r.phone}`:""]}):"â€”",(r.city||r.area||r.line1)&&e.jsx("button",{type:"button",title:"Ù†Ø³Ø® Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",onClick:()=>{try{navigator.clipboard.writeText(i)}catch{}},style:{...E,width:22,height:22,marginInlineStart:6},children:"ğŸ“‹"})]}),e.jsx("td",{children:n.reference||"-"}),e.jsx("td",{children:n.receiptUrl?e.jsx("a",{href:n.receiptUrl,target:"_blank",rel:"noopener",style:{fontSize:".6rem",color:"#075985"},children:"Ø¹Ø±Ø¶"}):"-"}),e.jsxs("td",{style:ee,children:[t.paymentMethod==="bank"&&t.status==="pending_bank_review"&&e.jsx("button",{style:E,onClick:async()=>{try{const l=n.reference;if(!(await fetch("/api/pay/bank/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:t.id,reference:l})})).ok)throw new Error("ÙØ´Ù„ Ø§Ù„ØªØ£ÙƒÙŠØ¯");await J()}catch(l){alert(l.message)}},children:"ØªØ£ÙƒÙŠØ¯ Ø¯ÙØ¹"}),(r.city||r.area||r.line1)&&e.jsx("button",{style:{...E,width:"auto",padding:"0 .5rem",fontSize:".6rem"},onClick:()=>kr(l=>l===t.id?null:t.id),title:Mt===t.id?"Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†":"Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",children:Mt===t.id?"Ø¥Ø®ÙØ§Ø¡":"Ø¹Ø±Ø¶"}),e.jsx("a",{href:`/order/${t.id}`,style:{fontSize:".6rem",textDecoration:"none",color:"#69be3c"},children:"Ø¹Ø±Ø¶"})]})]}),Mt===t.id&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,style:{background:"#f8fafc"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,alignItems:"flex-start",padding:".75rem 1rem"},children:[e.jsxs("div",{style:{fontSize:".7rem",whiteSpace:"pre-wrap",lineHeight:1.8},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:4},children:"Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø­Ù†"}),r.name&&e.jsx("div",{children:r.name}),r.email&&e.jsx("div",{style:{opacity:.8},children:r.email}),e.jsx("div",{children:[r.country,r.city,r.area].filter(Boolean).join(" - ")}),r.line1&&e.jsx("div",{children:r.line1}),r.phone&&e.jsxs("div",{children:["ğŸ“ ",r.phone]})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{type:"button",onClick:()=>{try{navigator.clipboard.writeText(i)}catch{}},style:{...E,width:"auto",padding:"0 .6rem",fontSize:".65rem"},children:"Ù†Ø³Ø®"}),(r.line1||r.city||r.country)&&e.jsx("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(`${r.line1||""} ${r.city||""} ${r.country||""}`.trim())}`,target:"_blank",rel:"noopener",style:{...E,width:"auto",padding:"0 .6rem",fontSize:".65rem",textDecoration:"none"},children:"Ø®Ø±Ø§Ø¦Ø·"})]})]})})})]},t.id)}),!D.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,style:Q,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª"})})]})]}),Ne.length>0&&e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginTop:8},children:[e.jsx("button",{style:he===1?x:m,disabled:he===1,onClick:()=>Jt(t=>Math.max(1,t-1)),children:"Ø§Ù„Ø³Ø§Ø¨Ù‚"}),e.jsxs("span",{style:{fontSize:".65rem"},children:["ØµÙØ­Ø© ",he," / ",jt]}),e.jsx("button",{style:he===jt?x:m,disabled:he===jt,onClick:()=>Jt(t=>Math.min(jt,t+1)),children:"Ø§Ù„ØªØ§Ù„ÙŠ"}),e.jsx("span",{style:{marginInlineStart:10,fontSize:".65rem"},children:"Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ:"}),e.jsx("select",{value:We,onChange:t=>{Ir(+t.target.value),Jt(1)},style:v,children:[20,50,100,200,500].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("span",{style:{fontSize:".65rem",opacity:.7},children:[Ne.length," Ø¹Ù†ØµØ±"]})]})]}),p==="cats"&&e.jsx(fs,{}),p==="audit"&&e.jsxs("div",{style:le,children:[e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[e.jsx("h3",{style:ie,children:"Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚"}),e.jsx("button",{type:"button",onClick:()=>Yr(),style:m,children:"ØªØ­Ø¯ÙŠØ«"}),e.jsx("span",{style:{fontSize:".6rem",color:"#475569"},children:Je?"...ØªØ­Ù…ÙŠÙ„":""})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:H,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[un&&e.jsx("tr",{children:e.jsxs("td",{colSpan:6,children:[e.jsx("div",{className:"skeleton",style:{height:36,marginBottom:8}}),e.jsx("div",{className:"skeleton",style:{height:36,marginBottom:8}}),e.jsx("div",{className:"skeleton",style:{height:36}})]})}),e.jsx("th",{children:"Ø§Ù„ÙˆÙ‚Øª"}),e.jsx("th",{children:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡"}),e.jsx("th",{children:"Ø§Ù„ÙƒÙŠØ§Ù†"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø¹Ø±Ù"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"})]})}),e.jsxs("tbody",{children:[sn.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(t.createdAt).toLocaleTimeString()}),e.jsx("td",{children:t.action}),e.jsx("td",{children:t.entity}),e.jsx("td",{children:t.entityId}),e.jsx("td",{children:t.userId||"â€”"})]},t.id)),!sn.length&&!Je&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:Q,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª"})})]})]})}),Re>1&&e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[e.jsx("button",{disabled:ae===1,onClick:()=>ln(t=>Math.max(1,t-1)),style:ae===1?x:m,children:"Ø§Ù„Ø³Ø§Ø¨Ù‚"}),e.jsxs("span",{style:{alignSelf:"center",fontSize:".65rem"},children:["ØµÙØ­Ø© ",ae," / ",Re]}),e.jsx("button",{disabled:ae===Re,onClick:()=>ln(t=>Math.min(Re,t+1)),style:ae===Re?x:m,children:"Ø§Ù„ØªØ§Ù„ÙŠ"})]}),Xe&&e.jsxs("div",{style:{fontSize:".65rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",Xe]})]}),p==="reviews"&&e.jsx(js,{}),p==="settings"&&e.jsxs("div",{style:le,children:[e.jsx("h3",{style:ie,children:"Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©"}),rt&&e.jsx("div",{style:{fontSize:".7rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),kn&&e.jsxs("div",{style:{fontSize:".7rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",kn]}),e.jsxs("div",{style:{display:"grid",gap:"1rem"},children:[e.jsxs("div",{style:{background:"#fff",padding:"1rem",borderRadius:12,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)"},children:[e.jsx("h4",{style:{marginTop:0},children:"Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[Ot?.logo?e.jsx("img",{src:Ot.logo,alt:"Site Logo",style:{height:48,objectFit:"contain",border:"1px solid #e5e7eb",borderRadius:8,padding:4,background:"#fff"}}):e.jsx("div",{style:{fontSize:".7rem",opacity:.7},children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø´Ø¹Ø§Ø± Ø­Ø§Ù„ÙŠØ§Ù‹"}),e.jsx("input",{ref:En,type:"file",accept:"image/jpeg,image/png,image/webp,image/svg+xml",style:{display:"none"},onChange:t=>An(t.target.files?.[0]||null)}),e.jsx("button",{type:"button",onClick:()=>En.current?.click(),style:{background:"#e2e8f0",color:"#0f172a",border:0,padding:"6px 10px",borderRadius:8,fontWeight:700},children:"Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ"}),st&&e.jsx("span",{style:{fontSize:".65rem"},children:st.name}),e.jsx("button",{type:"button",style:m,disabled:!st||rt,onClick:async()=>{de(!0),ue(null);try{if(M?.uploadLogo){const t=await M.uploadLogo(st);t&&ke(t),An(null),alert("ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø´Ø¹Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­")}}catch(t){ue(t.message)}finally{de(!1)}},children:"Ø±ÙØ¹ Ø§Ù„Ø´Ø¹Ø§Ø±"}),e.jsx("button",{type:"button",style:x,onClick:en,disabled:rt,children:"ØªØ­Ø¯ÙŠØ«"})]}),e.jsx("p",{style:ms,children:"Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©: ØµÙˆØ± Ø­ØªÙ‰ 2MB. ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© WebP Ù…Ø­Ø³Ù†Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹."})]}),e.jsxs("form",{onSubmit:Xr,style:{background:"#fff",padding:"1rem",borderRadius:12,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)",display:"grid",gap:8},children:[e.jsx("h4",{style:{marginTop:0},children:"ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(180px,1fr))",gap:8},children:[e.jsx("input",{placeholder:"Ø§Ø³Ù… Ø¹Ø±Ø¨ÙŠ",value:C.siteNameAr,onChange:t=>k(n=>({...n,siteNameAr:t.target.value}))}),e.jsx("input",{placeholder:"Name EN",value:C.siteNameEn,onChange:t=>k(n=>({...n,siteNameEn:t.target.value}))}),e.jsx("input",{placeholder:"#69be3c",value:C.colorPrimary,onChange:t=>k(n=>({...n,colorPrimary:t.target.value}))}),e.jsx("input",{placeholder:"#1f2937",value:C.colorSecondary,onChange:t=>k(n=>({...n,colorSecondary:t.target.value}))}),e.jsx("input",{placeholder:"#ef4444",value:C.colorAccent,onChange:t=>k(n=>({...n,colorAccent:t.target.value}))}),e.jsx("input",{placeholder:"Ù‡Ø§ØªÙ",value:C.supportPhone,onChange:t=>k(n=>({...n,supportPhone:t.target.value}))}),e.jsx("input",{placeholder:"Ø¬ÙˆØ§Ù„",value:C.supportMobile,onChange:t=>k(n=>({...n,supportMobile:t.target.value}))}),e.jsx("input",{placeholder:"ÙˆØ§ØªØ³Ø§Ø¨",value:C.supportWhatsapp,onChange:t=>k(n=>({...n,supportWhatsapp:t.target.value}))}),e.jsx("input",{placeholder:"Email",value:C.supportEmail,onChange:t=>k(n=>({...n,supportEmail:t.target.value}))}),e.jsx("input",{placeholder:"Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¯Ø¹Ù…",value:C.supportHours,onChange:t=>k(n=>({...n,supportHours:t.target.value}))}),e.jsx("input",{placeholder:"Ø¹Ù† Ø§Ù„Ø´Ø±ÙƒØ© AR",value:C.footerAboutAr,onChange:t=>k(n=>({...n,footerAboutAr:t.target.value}))}),e.jsx("input",{placeholder:"About EN",value:C.footerAboutEn,onChange:t=>k(n=>({...n,footerAboutEn:t.target.value}))}),e.jsx("input",{placeholder:"Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©",value:C.linkBlog,onChange:t=>k(n=>({...n,linkBlog:t.target.value}))}),e.jsx("input",{placeholder:"Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙˆØ§ØµÙ„",value:C.linkSocial,onChange:t=>k(n=>({...n,linkSocial:t.target.value}))}),e.jsx("input",{placeholder:"Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ±Ø¬Ø§Ø¹",value:C.linkReturns,onChange:t=>k(n=>({...n,linkReturns:t.target.value}))}),e.jsx("input",{placeholder:"Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©",value:C.linkPrivacy,onChange:t=>k(n=>({...n,linkPrivacy:t.target.value}))}),e.jsx("input",{placeholder:"App Store URL",value:C.appStoreUrl,onChange:t=>k(n=>({...n,appStoreUrl:t.target.value}))}),e.jsx("input",{placeholder:"Play Store URL",value:C.playStoreUrl,onChange:t=>k(n=>({...n,playStoreUrl:t.target.value}))})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{type:"submit",style:m,disabled:rt,children:"Ø­ÙØ¸"}),e.jsx("button",{type:"button",style:x,onClick:()=>en(),children:"Ø¥Ù„ØºØ§Ø¡"})]})]}),e.jsxs("div",{style:{background:"#fff",padding:"1rem",borderRadius:12,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)"},children:[e.jsx("h4",{style:{marginTop:0},children:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª"}),e.jsxs("ul",{style:xs,children:[e.jsx("li",{children:"Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©: 1.0.0"}),e.jsxs("li",{children:["Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ",(B?.length||0)+(_t?.length||0)+(D?.length||0)," Ø³Ø¬Ù„"]})]})]})]})]}),p==="brands"&&e.jsxs("div",{style:le,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("h3",{style:ie,children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©"}),e.jsx("button",{style:m,type:"button",onClick:()=>Xt(),children:"ØªØ­Ø¯ÙŠØ«"}),e.jsx("button",{style:x,type:"button",onClick:()=>Yt(),children:"ÙØ­Øµ Ø§Ù„ØµÙŠØ§Ù†Ø©"}),e.jsx("button",{style:x,type:"button",onClick:()=>Hn(),children:"Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ ØµÙˆØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª"}),Ln&&e.jsx("span",{style:{fontSize:".6rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),Fn&&e.jsxs("span",{style:{fontSize:".6rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",Fn]}),e.jsx("input",{placeholder:"Ø¨Ø­Ø« Ø¹Ù„Ø§Ù…Ø©",value:dt,onChange:t=>Er(t.target.value),style:v}),e.jsxs("select",{value:Nt,onChange:t=>Pr(t.target.value),style:v,children:[e.jsx("option",{value:"created_desc",children:"Ø§Ù„Ø£Ø­Ø¯Ø«"}),e.jsx("option",{value:"created_asc",children:"Ø§Ù„Ø£Ù‚Ø¯Ù…"}),e.jsx("option",{value:"name_ar",children:"Ø§Ù„Ø§Ø³Ù… AR"}),e.jsx("option",{value:"name_en",children:"Name EN"}),e.jsx("option",{value:"products_desc",children:"Ø£ÙƒØ«Ø± Ù…Ù†ØªØ¬Ø§Øª"}),e.jsx("option",{value:"products_asc",children:"Ø£Ù‚Ù„ Ù…Ù†ØªØ¬Ø§Øª"})]}),e.jsxs("select",{value:Wt,onChange:t=>pe(t.target.value),style:v,children:[e.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª"}),e.jsx("option",{value:"duplicates",children:"Ù…ÙƒØ±Ø±Ø©"}),e.jsx("option",{value:"noLogo",children:"Ø¨Ø¯ÙˆÙ† Ø´Ø¹Ø§Ø±"}),e.jsx("option",{value:"zeroProducts",children:"Ø¨Ø¯ÙˆÙ† Ù…Ù†ØªØ¬Ø§Øª"}),e.jsx("option",{value:"missingVariants",children:"Ù†Ù‚Øµ Ù†Ø³Ø® Ø§Ù„Ø´Ø¹Ø§Ø±"})]}),e.jsx("button",{type:"button",style:x,onClick:()=>Dn(t=>!t),children:Tn?"Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¯Ù…Ø¬":"Ù„ÙˆØ­Ø© Ø§Ù„Ø¯Ù…Ø¬"})]}),R&&e.jsxs("div",{style:{marginTop:8,background:"#fff",border:"1px solid #e2e8f0",borderRadius:12,padding:".5rem .75rem",display:"flex",flexWrap:"wrap",gap:10,alignItems:"center"},children:[e.jsx("div",{style:{fontSize:".7rem",color:"#334155",fontWeight:700},children:"Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ:"}),e.jsxs("button",{type:"button",style:x,onClick:()=>pe("duplicates"),children:["Ù…ÙƒØ±Ø±Ø§Øª: ",(R.duplicateNames||[]).length," Ù…Ø¬Ù…ÙˆØ¹Ø©"]}),e.jsxs("button",{type:"button",style:x,onClick:()=>pe("noLogo"),children:["Ø¨Ø¯ÙˆÙ† Ø´Ø¹Ø§Ø±: ",(R.noLogo||[]).length]}),e.jsxs("button",{type:"button",style:x,onClick:()=>pe("zeroProducts"),children:["Ø¨Ø¯ÙˆÙ† Ù…Ù†ØªØ¬Ø§Øª: ",(R.zeroProducts||[]).length]}),e.jsxs("button",{type:"button",style:x,onClick:()=>pe("missingVariants"),children:["Ù†Ù‚Øµ Ù†Ø³Ø®: ",(R.missingLogoVariants||[]).length]}),e.jsx("button",{type:"button",style:x,onClick:()=>pe(""),children:"Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙƒÙ„"})]}),!R&&e.jsx("div",{style:{marginTop:8,fontSize:".65rem",color:"#64748b"},children:'ÙŠÙ…ÙƒÙ†Ùƒ ØªØ´ØºÙŠÙ„ "ÙØ­Øµ Ø§Ù„ØµÙŠØ§Ù†Ø©" Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© ÙˆØ§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø£Ø®Ø±Ù‰.'}),Tn&&e.jsxs("div",{style:{marginTop:10,background:"#fff",border:"1px solid #e2e8f0",borderRadius:12,padding:".75rem",display:"grid",gap:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("div",{style:{fontSize:".8rem",fontWeight:700},children:"Ø¯Ù…Ø¬ Ø¹Ù„Ø§Ù…Ø§Øª"}),e.jsxs("select",{value:Ae,onChange:t=>Rn(t.target.value),style:v,children:[e.jsx("option",{value:"",children:"â€” Ø§Ø®ØªØ± Ø§Ù„Ù‡Ø¯Ù â€”"}),Me.map(t=>e.jsxs("option",{value:t.id,children:[z(t.name,g)||t.name?.ar||t.name?.en||t.slug," (",t.productCount||0,")"]},t.id))]}),e.jsx("button",{type:"button",style:m,disabled:!Ae||!Bt.filter(t=>t&&t!==Ae).length,onClick:()=>{const t=Bt.filter(n=>n&&n!==Ae);t.length&&window.confirm(`Ø¯Ù…Ø¬ ${t.length} Ø¹Ù„Ø§Ù…Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ù…Ø®ØªØ§Ø±ØŸ`)&&Wr(Ae,t).then(()=>{ut([]),Rn("")})},children:"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯Ù…Ø¬"})]}),R?.duplicateNames?.length>0&&e.jsxs("div",{style:{fontSize:".65rem",color:"#334155"},children:["Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù…ÙƒØ±Ø±Ø© Ø³Ø±ÙŠØ¹Ø©:",e.jsx("ul",{style:{listStyle:"none",padding:0,margin:".25rem 0",display:"grid",gap:6},children:R.duplicateNames.map((t,n)=>e.jsxs("li",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsxs("span",{style:{fontWeight:600},children:["Ù…Ø¬Ù…ÙˆØ¹Ø© ",n+1,":"]}),e.jsx("span",{style:{opacity:.8},children:(t.slugs||[]).join(", ")}),e.jsx("button",{type:"button",style:x,onClick:()=>{ut(t.ids||[]),pe("duplicates"),Dn(!0)},children:"ØªÙ‡ÙŠØ¦Ø© Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©"})]},n))})]}),e.jsxs("div",{style:{display:"grid",gap:6},children:[e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsx("input",{placeholder:"Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ø±",value:_n,onChange:t=>zr(t.target.value),style:v}),e.jsx("button",{type:"button",style:x,onClick:()=>ut([]),children:"Ù…Ø³Ø­ Ø§Ù„ØªØ­Ø¯ÙŠØ¯"})]}),e.jsx("div",{style:{maxHeight:220,overflow:"auto",border:"1px solid #e2e8f0",borderRadius:8,padding:6,display:"grid",gap:4},children:Me.filter(t=>{const n=_n.trim().toLowerCase();if(!n)return!0;const r=(z(t.name,g)||t.name?.ar||t.name?.en||t.slug||"").toLowerCase();return(t.slug||"").toLowerCase().includes(n)||r.includes(n)}).map(t=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:".75rem"},children:[e.jsx("input",{type:"checkbox",checked:Bt.includes(t.id),onChange:()=>ut(n=>n.includes(t.id)?n.filter(r=>r!==t.id):[...n,t.id])}),e.jsx("span",{style:{opacity:.85},children:z(t.name,g)||t.name?.ar||t.name?.en||t.slug}),e.jsxs("span",{style:{fontSize:".6rem",opacity:.6},children:["(",t.productCount||0,")"]}),Ae===t.id&&e.jsx("span",{style:{fontSize:".6rem",color:"#b91c1c"},children:"â† Ø§Ù„Ù‡Ø¯Ù"})]},t.id))})]})]}),e.jsxs("form",{onSubmit:Br,style:He,children:[e.jsx("h4",{style:{margin:0,fontSize:".85rem"},children:y.id?"ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù„Ø§Ù…Ø©":"Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø©"}),e.jsxs("div",{style:Qe,children:[e.jsx("input",{placeholder:"Slug",value:y.slug,onChange:t=>Z(n=>({...n,slug:t.target.value}))}),e.jsx("input",{placeholder:"Ø§Ù„Ø§Ø³Ù… AR",value:y.nameAr,onChange:t=>Z(n=>({...n,nameAr:t.target.value})),required:!0}),e.jsx("input",{placeholder:"Name EN",value:y.nameEn,onChange:t=>Z(n=>({...n,nameEn:t.target.value})),required:!0}),e.jsx("input",{placeholder:"ÙˆØµÙ AR",value:y.descriptionAr,onChange:t=>Z(n=>({...n,descriptionAr:t.target.value}))}),e.jsx("input",{placeholder:"Description EN",value:y.descriptionEn,onChange:t=>Z(n=>({...n,descriptionEn:t.target.value}))}),e.jsx("input",{placeholder:"Logo URL",value:y.logo,onChange:t=>Z(n=>({...n,logo:t.target.value}))}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>zn(t.target.files?.[0]||null)}),Oe&&e.jsx("span",{style:{fontSize:".55rem"},children:Oe.name})]}),e.jsxs("div",{style:Ge,children:[e.jsxs("button",{type:"submit",style:m,children:[e.jsx(bt,{size:16})," ",y.id?"Ø­ÙØ¸":"Ø¥Ø¶Ø§ÙØ©"]}),y.id&&e.jsxs("button",{type:"button",style:x,onClick:()=>Z({id:null,slug:"",nameAr:"",nameEn:"",descriptionAr:"",descriptionEn:"",logo:""}),children:[e.jsx(St,{size:16})," Ø¥Ù„ØºØ§Ø¡"]})]})]}),e.jsxs("table",{style:H,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„Ø´Ø¹Ø§Ø±"}),e.jsx("th",{children:"Ø§Ù„Ø§Ø³Ù…"}),e.jsx("th",{children:"Slug"}),e.jsx("th",{children:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"}),e.jsx("th",{children:"Ø§Ù„ÙˆØµÙ"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[Jr.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.logo?e.jsx("img",{src:t.logo,alt:"logo",loading:"lazy",style:{width:38,height:38,objectFit:"contain"}}):"â€”"}),e.jsx("td",{children:z(t.name,g)||t.name?.ar||t.name?.en}),e.jsx("td",{style:{fontSize:".6rem"},children:t.slug}),e.jsx("td",{children:t.productCount||0}),e.jsx("td",{style:{fontSize:".6rem",maxWidth:180,overflow:"hidden",textOverflow:"ellipsis"},children:z(t.description,g)||t.description?.ar||t.description?.en||"â€”"}),e.jsxs("td",{style:ee,children:[e.jsx("button",{style:E,title:"ØªØ¹Ø¯ÙŠÙ„",onClick:()=>Z({id:t.id,slug:t.slug,nameAr:t.name?.ar||"",nameEn:t.name?.en||"",descriptionAr:t.description?.ar||"",descriptionEn:t.description?.en||"",logo:t.logo||""}),children:e.jsx(Ue,{size:16})}),e.jsx("button",{style:E,title:"Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ Ù†Ø³Ø® Ø§Ù„Ø´Ø¹Ø§Ø±",onClick:()=>Hn(t.id),children:"â†»"}),e.jsx("button",{style:ye,title:"Ø­Ø°Ù",onClick:()=>Ur(t.id),children:e.jsx(wt,{size:16})})]})]},t.id)),!ze.length&&!Ln&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:Q,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù„Ø§Ù…Ø§Øª"})})]})]}),ze.length>0&&e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginTop:8},children:[e.jsx("button",{style:me===1?x:m,disabled:me===1,onClick:()=>Zt(t=>Math.max(1,t-1)),children:"Ø§Ù„Ø³Ø§Ø¨Ù‚"}),e.jsxs("span",{style:{fontSize:".65rem"},children:["ØµÙØ­Ø© ",me," / ",vt]}),e.jsx("button",{style:me===vt?x:m,disabled:me===vt,onClick:()=>Zt(t=>Math.min(vt,t+1)),children:"Ø§Ù„ØªØ§Ù„ÙŠ"}),e.jsx("span",{style:{marginInlineStart:10,fontSize:".65rem"},children:"Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ:"}),e.jsx("select",{value:Be,onChange:t=>{Gr(+t.target.value),Zt(1)},style:v,children:[10,20,30,50,100].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("span",{style:{fontSize:".65rem",opacity:.7},children:[ze.length," Ø¹Ù†ØµØ±"]})]})]}),p==="marketing"&&e.jsxs("div",{style:le,children:[e.jsxs("div",{style:{background:"#fff",padding:"1rem",borderRadius:14,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)",display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("h4",{style:{margin:"0 0 .25rem",fontSize:".9rem"},children:"ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù†Ù‚Ø±Ø§Øª"}),e.jsx("select",{value:qn,onChange:t=>{const n=+t.target.value;Or(n),Gt(n)},style:v,children:[7,14,30,60,90,180].map(t=>e.jsxs("option",{value:t,children:[t," ÙŠÙˆÙ…"]},t))}),e.jsx("button",{type:"button",onClick:()=>Gt(),style:m,children:"ØªØ­Ø¯ÙŠØ«"})]}),!Ie&&e.jsx("div",{style:{fontSize:".65rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),Ie&&e.jsx("div",{style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))"},children:["banner","feature","appLink"].map(t=>e.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:".75rem",display:"flex",flexDirection:"column",gap:6},children:[e.jsx("div",{style:{fontSize:".7rem",fontWeight:700,color:"#334155"},children:t==="banner"?"Ø¨Ø§Ù†Ø±Ø§Øª":t==="feature"?"Ù…ÙŠØ²Ø§Øª":"Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª"}),e.jsxs("ul",{style:{listStyle:"none",margin:0,padding:0,display:"flex",flexDirection:"column",gap:4},children:[(Ie[t]||[]).slice(0,10).map(n=>e.jsxs("li",{style:{display:"flex",justifyContent:"space-between",fontSize:".6rem"},children:[e.jsx("span",{style:{maxWidth:140,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.titleAr||n.labelAr||n.titleEn||n.labelEn||n.platform||n.id}),e.jsx("span",{style:{fontWeight:600},children:n.count})]},n.id)),!(Ie[t]||[]).length&&e.jsx("li",{style:{fontSize:".55rem",opacity:.6},children:"Ù„Ø§ Ø¨ÙŠØ§Ù†Ø§Øª"})]})]},t))})]}),e.jsxs("form",{onSubmit:qr,style:He,children:[e.jsxs("h4",{style:{margin:0,fontSize:".85rem"},children:["Ù…ÙŠØ²Ø§Øª (",pt.length,")"]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[e.jsx("input",{placeholder:"Ø¨Ø­Ø«",value:yt,onChange:t=>Tr(t.target.value),style:v}),e.jsxs("select",{value:Ht,onChange:t=>Rr(t.target.value),style:v,children:[e.jsx("option",{value:"sort_asc",children:"Sort â†‘"}),e.jsx("option",{value:"sort_desc",children:"Sort â†“"}),e.jsx("option",{value:"title_ar",children:"Ø¹Ù†ÙˆØ§Ù† AR"}),e.jsx("option",{value:"title_en",children:"Title EN"})]})]}),e.jsxs("div",{style:Qe,children:[e.jsx("input",{placeholder:"Ø¹Ù†ÙˆØ§Ù† AR",value:f.titleAr,onChange:t=>V(n=>({...n,titleAr:t.target.value})),required:!0}),e.jsx("input",{placeholder:"Title EN",value:f.titleEn,onChange:t=>V(n=>({...n,titleEn:t.target.value})),required:!0}),e.jsx("input",{placeholder:"Ù†Øµ AR",value:f.bodyAr,onChange:t=>V(n=>({...n,bodyAr:t.target.value}))}),e.jsx("input",{placeholder:"Body EN",value:f.bodyEn,onChange:t=>V(n=>({...n,bodyEn:t.target.value}))}),e.jsx("input",{placeholder:"Icon",value:f.icon,onChange:t=>V(n=>({...n,icon:t.target.value}))}),e.jsx("input",{type:"number",placeholder:"Sort",value:f.sort,onChange:t=>V(n=>({...n,sort:+t.target.value||0}))}),e.jsxs("select",{value:f.active?"1":"0",onChange:t=>V(n=>({...n,active:t.target.value==="1"})),children:[e.jsx("option",{value:"1",children:"Ù†Ø´Ø·"}),e.jsx("option",{value:"0",children:"Ù…ØªÙˆÙ‚Ù"})]})]}),e.jsxs("div",{style:Ge,children:[e.jsxs("button",{type:"submit",style:m,children:[e.jsx(bt,{size:16})," ",f.id?"Ø­ÙØ¸":"Ø¥Ø¶Ø§ÙØ©"]}),f.id&&e.jsxs("button",{type:"button",style:x,onClick:()=>V({id:null,titleAr:"",titleEn:"",bodyAr:"",bodyEn:"",icon:"",sort:0,active:!0}),children:[e.jsx(St,{size:16})," Ø¥Ù„ØºØ§Ø¡"]})]}),e.jsxs("table",{style:H,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"}),e.jsx("th",{children:"Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©"}),e.jsx("th",{children:"Sort"}),e.jsx("th",{children:"Ù†Ø´Ø·"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[Qn.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:z(t.title,g)||t.title?.ar||t.title?.en}),e.jsx("td",{children:t.icon||"â€”"}),e.jsx("td",{children:t.sort}),e.jsx("td",{children:t.active?"âœ“":"âœ—"}),e.jsxs("td",{style:ee,children:[e.jsx("button",{style:E,onClick:()=>V({id:t.id,titleAr:t.title?.ar||"",titleEn:t.title?.en||"",bodyAr:t.body?.ar||"",bodyEn:t.body?.en||"",icon:t.icon||"",sort:t.sort||0,active:!!t.active}),children:e.jsx(Ue,{size:16})}),e.jsx("button",{style:ye,onClick:()=>Vr(t.id),children:e.jsx(wt,{size:16})})]})]},t.id)),!Qn.length&&!Un&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:Q,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙŠØ²Ø§Øª"})})]})]})]}),e.jsxs("form",{onSubmit:Hr,style:He,children:[e.jsxs("h4",{style:{margin:0,fontSize:".85rem"},children:["Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª (",$t.length,")"]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[e.jsx("input",{placeholder:"Ø¨Ø­Ø«",value:ft,onChange:t=>Dr(t.target.value),style:v}),e.jsxs("select",{value:Qt,onChange:t=>_r(t.target.value),style:v,children:[e.jsx("option",{value:"platform_asc",children:"Ù…Ù†ØµØ© â†‘"}),e.jsx("option",{value:"platform_desc",children:"Ù…Ù†ØµØ© â†“"})]})]}),e.jsxs("div",{style:Qe,children:[e.jsxs("select",{value:A.platform,onChange:t=>se(n=>({...n,platform:t.target.value})),children:[e.jsx("option",{value:"ios",children:"iOS"}),e.jsx("option",{value:"android",children:"Android"}),e.jsx("option",{value:"web",children:"Web"})]}),e.jsx("input",{placeholder:"URL",value:A.url,onChange:t=>se(n=>({...n,url:t.target.value})),required:!0}),e.jsx("input",{placeholder:"Label AR",value:A.labelAr,onChange:t=>se(n=>({...n,labelAr:t.target.value}))}),e.jsx("input",{placeholder:"Label EN",value:A.labelEn,onChange:t=>se(n=>({...n,labelEn:t.target.value}))}),e.jsxs("select",{value:A.active?"1":"0",onChange:t=>se(n=>({...n,active:t.target.value==="1"})),children:[e.jsx("option",{value:"1",children:"Ù†Ø´Ø·"}),e.jsx("option",{value:"0",children:"Ù…ØªÙˆÙ‚Ù"})]})]}),e.jsxs("div",{style:Ge,children:[e.jsxs("button",{type:"submit",style:m,children:[e.jsx(bt,{size:16})," ",A.id?"Ø­ÙØ¸":"Ø¥Ø¶Ø§ÙØ©"]}),A.id&&e.jsxs("button",{type:"button",style:x,onClick:()=>se({id:null,platform:"web",url:"",labelAr:"",labelEn:"",active:!0}),children:[e.jsx(St,{size:16})," Ø¥Ù„ØºØ§Ø¡"]})]}),e.jsxs("table",{style:H,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„Ù…Ù†ØµØ©"}),e.jsx("th",{children:"Ø§Ù„Ø±Ø§Ø¨Ø·"}),e.jsx("th",{children:"Ø§Ù„Ù†Øµ"}),e.jsx("th",{children:"Ù†Ø´Ø·"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[Gn.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.platform}),e.jsx("td",{style:{fontSize:".6rem",maxWidth:220,overflow:"hidden",textOverflow:"ellipsis"},children:t.url}),e.jsx("td",{children:z(t.label,g)||t.label?.ar||t.label?.en||"â€”"}),e.jsx("td",{children:t.active?"âœ“":"âœ—"}),e.jsxs("td",{style:ee,children:[e.jsx("button",{style:E,onClick:()=>se({id:t.id,platform:t.platform,url:t.url,labelAr:t.label?.ar||"",labelEn:t.label?.en||"",active:!!t.active}),children:e.jsx(Ue,{size:16})}),e.jsx("button",{style:ye,onClick:()=>Qr(t.id),children:e.jsx(wt,{size:16})})]})]},t.id)),!Gn.length&&!Un&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:Q,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø·"})})]})]})]})]})]})]})]}):e.jsxs("div",{style:{direction:"rtl",padding:"2rem",maxWidth:520,margin:"2rem auto",background:"#fff",border:"1px solid #e2e8f0",borderRadius:16,boxShadow:"0 6px 28px -8px rgba(0,0,0,.12)"},children:[e.jsx("h2",{style:{marginTop:0,fontSize:"1.1rem"},children:"ğŸš« ØµÙ„Ø§Ø­ÙŠØ§Øª ØºÙŠØ± ÙƒØ§ÙÙŠØ©"}),e.jsx("p",{style:{fontSize:".75rem",lineHeight:1.7,color:"#475569"},children:"Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±. Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ¹ØªÙ‚Ø¯ Ø£Ù† Ù‡Ø°Ø§ Ø®Ø·Ø£ØŒ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ."}),e.jsx("a",{href:"/",style:{display:"inline-block",marginTop:12,fontSize:".7rem",fontWeight:600,color:"#69be3c",textDecoration:"none"},children:"Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"})]})},gs={direction:"rtl",padding:"1.25rem 0",fontSize:".85rem"},v={padding:".55rem .75rem",border:"1px solid #e2e8f0",borderRadius:10,minWidth:160,fontSize:".8rem",background:"#fff"};({...v});({...v});const Ct={background:"var(--color-surface)",padding:"1rem",borderRadius:14,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)",display:"flex",flexDirection:"column",gap:".35rem",border:"1px solid var(--color-border-soft)"},Yn={fontSize:"1.6rem",fontWeight:700,color:"var(--color-text)"},Zn={fontSize:".7rem",letterSpacing:".5px",color:"var(--color-text-faint)",fontWeight:600},kt={background:"var(--color-bg-alt)",border:"1px solid var(--color-border)",borderRadius:10,padding:".5rem .7rem"},At={fontSize:".95rem",fontWeight:800,color:"var(--color-text)"},Et={fontSize:".65rem",color:"var(--color-text-faint)",fontWeight:700},le={background:"transparent",display:"flex",flexDirection:"column",gap:"1.25rem"},He={background:"var(--color-surface)",padding:"1rem 1.1rem 1.25rem",borderRadius:14,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)",display:"flex",flexDirection:"column",gap:".8rem",border:"1px solid var(--color-border-soft)"},Qe={display:"grid",gap:".65rem",gridTemplateColumns:"repeat(auto-fit,minmax(140px,1fr))"},Ge={display:"flex",gap:".6rem",flexWrap:"wrap"},ie={margin:0,fontSize:"1rem",fontWeight:700},m={display:"inline-flex",alignItems:"center",gap:".4rem",border:0,background:"linear-gradient(90deg, var(--color-primary), var(--color-primary-alt))",color:"#fff",padding:".6rem .95rem",borderRadius:10,cursor:"pointer",fontSize:".75rem",fontWeight:600,boxShadow:"0 10px 20px -12px rgba(var(--color-primary-rgb),0.35)"},x={...m,background:"var(--color-bg-alt)",color:"var(--color-text)",boxShadow:"none"};({...m});const H={width:"100%",borderCollapse:"collapse",background:"var(--color-surface)",borderRadius:14,overflow:"hidden",boxShadow:"0 4px 14px -6px rgba(0,0,0,.06)",border:"1px solid var(--color-border-soft)"},ee={display:"flex",gap:".35rem",alignItems:"center"},E={background:"var(--color-bg-alt)",border:0,width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:8,cursor:"pointer",color:"var(--color-text)"},ye={...E,background:"#fee2e2",color:"#b91c1c"},Q={textAlign:"center",padding:"1rem",fontSize:".75rem",color:"var(--color-text-faint)"},ms={fontSize:".75rem",color:"var(--color-text-soft)",margin:".25rem 0 1rem"},xs={margin:0,padding:"0 1rem",listStyle:"disc",lineHeight:1.9},$e={fontSize:".55rem",fontWeight:600,color:"var(--color-text-soft)"},qe={...v,minWidth:90,fontSize:".65rem",padding:".4rem .5rem"};function ys(g){const G={display:"inline-block",padding:".15rem .45rem",borderRadius:999,fontSize:".65rem",fontWeight:700},S={success:{background:"rgba(var(--color-primary-rgb),0.12)",color:"var(--color-primary)",border:"1px solid rgba(var(--color-primary-rgb),0.28)"},info:{background:"rgba(var(--color-accent-rgb,58,90,121),0.10)",color:"var(--color-accent)",border:"1px solid rgba(var(--color-accent-rgb,58,90,121),0.25)"},warning:{background:"rgba(217,119,6,0.10)",color:"var(--color-warning)",border:"1px solid rgba(217,119,6,0.28)"},danger:{background:"rgba(220,38,38,0.10)",color:"var(--color-danger)",border:"1px solid rgba(220,38,38,0.25)"},neutral:{background:"var(--color-bg-alt)",color:"var(--color-text)",border:"1px solid var(--color-border)"}},J={pending:S.warning,processing:S.info,paid:S.success,shipped:S.info,completed:S.success,cancelled:S.danger,pending_bank_review:S.warning};return{...G,...J[g]||S.neutral}}const fs=()=>{const{locale:g}=er(),[G,S]=s.useState([]),[J,X]=s.useState(!1),[te,D]=s.useState(null),[o,L]=s.useState({id:null,slug:"",nameAr:"",nameEn:"",descriptionAr:"",descriptionEn:"",image:"",icon:""}),[j,Te]=s.useState(null),[ne,Pt]=s.useState(!1),zt=async()=>{X(!0),D(null);try{const c=await h.listCategories({withCounts:1});S(c.categories||[])}catch(c){D(c.message)}finally{X(!1)}};s.useEffect(()=>{zt()},[]);const Lt=()=>{L({id:null,slug:"",nameAr:"",nameEn:"",descriptionAr:"",descriptionEn:"",image:"",icon:""}),Te(null),Pt(!1)},nn=async c=>{c.preventDefault(),X(!0),D(null);try{if(o.id)if(ne&&j){const a=new FormData;o.slug&&a.append("slug",o.slug),o.nameAr&&a.append("nameAr",o.nameAr),o.nameEn&&a.append("nameEn",o.nameEn),o.descriptionAr&&a.append("descriptionAr",o.descriptionAr),o.descriptionEn&&a.append("descriptionEn",o.descriptionEn),o.icon!==void 0&&a.append("icon",o.icon||""),a.append("image",j);const P=await h.updateCategoryForm(o.id,a);S(O=>O.map(I=>I.id===P.category?.id||I.id===P.id?P.category||P:I))}else{const a=await h.updateCategory(o.id,{slug:o.slug||void 0,nameAr:o.nameAr||void 0,nameEn:o.nameEn||void 0,descriptionAr:o.descriptionAr||null,descriptionEn:o.descriptionEn||null,image:o.image||null,icon:o.icon||null});S(P=>P.map(O=>O.id===a.category?.id||O.id===a.id?a.category||a:O))}else if(ne&&j){const a=new FormData;a.append("slug",o.slug),a.append("nameAr",o.nameAr),a.append("nameEn",o.nameEn),o.descriptionAr&&a.append("descriptionAr",o.descriptionAr),o.descriptionEn&&a.append("descriptionEn",o.descriptionEn),o.icon&&a.append("icon",o.icon),a.append("image",j);const P=await h.createCategoryForm(a),O=P.category||P;S(I=>[O,...I])}else{const a=await h.createCategory({slug:o.slug,nameAr:o.nameAr,nameEn:o.nameEn,descriptionAr:o.descriptionAr||null,descriptionEn:o.descriptionEn||null,image:o.image||null,icon:o.icon||null}),P=a.category||a;S(O=>[P,...O])}Lt()}catch(a){D(a.message)}finally{X(!1)}},F=async c=>{if(window.confirm("Ø­Ø°Ù Ø§Ù„ØªØµÙ†ÙŠÙØŸ"))try{await h.deleteCategory(c),S(a=>a.filter(P=>P.id!==c))}catch(a){alert("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù: "+a.message)}};return e.jsxs("div",{style:le,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("h3",{style:ie,children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"}),e.jsx("button",{type:"button",onClick:zt,style:m,children:"ØªØ­Ø¯ÙŠØ«"}),J&&e.jsx("span",{style:{fontSize:".65rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),te&&e.jsxs("span",{style:{fontSize:".65rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",te]})]}),e.jsxs("form",{onSubmit:nn,style:He,children:[e.jsx("h4",{style:{margin:0,fontSize:".9rem"},children:o.id?"ØªØ¹Ø¯ÙŠÙ„ ØªØµÙ†ÙŠÙ":"Ø¥Ø¶Ø§ÙØ© ØªØµÙ†ÙŠÙ"}),e.jsxs("div",{style:Qe,children:[e.jsx("input",{placeholder:"Slug",value:o.slug,onChange:c=>L(a=>({...a,slug:c.target.value})),required:!o.id}),e.jsx("input",{placeholder:"Ø§Ù„Ø§Ø³Ù… AR",value:o.nameAr,onChange:c=>L(a=>({...a,nameAr:c.target.value})),required:!o.id}),e.jsx("input",{placeholder:"Name EN",value:o.nameEn,onChange:c=>L(a=>({...a,nameEn:c.target.value})),required:!o.id}),e.jsx("input",{placeholder:"ÙˆØµÙ AR",value:o.descriptionAr,onChange:c=>L(a=>({...a,descriptionAr:c.target.value}))}),e.jsx("input",{placeholder:"Description EN",value:o.descriptionEn,onChange:c=>L(a=>({...a,descriptionEn:c.target.value}))}),e.jsx("input",{placeholder:"Icon key (Ù…Ø«Ù„: coffee, cup-soda, cookie, store, tag)",value:o.icon,onChange:c=>L(a=>({...a,icon:c.target.value}))}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:".8rem"},children:[e.jsx("input",{type:"checkbox",checked:ne,onChange:c=>Pt(c.target.checked)})," Ø±ÙØ¹ ØµÙˆØ±Ø©"]}),!ne&&e.jsx("input",{placeholder:"Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",value:o.image,onChange:c=>L(a=>({...a,image:c.target.value}))}),ne&&e.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:c=>Te(c.target.files?.[0]||null)})]}),e.jsxs("div",{style:Ge,children:[e.jsx("button",{type:"submit",style:m,children:"Ø­ÙØ¸"}),o.id&&e.jsx("button",{type:"button",style:x,onClick:Lt,children:"Ø¥Ù„ØºØ§Ø¡"})]})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:H,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„Ø§Ø³Ù…"}),e.jsx("th",{children:"Slug"}),e.jsx("th",{children:"Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©"}),e.jsx("th",{children:"Ø§Ù„ØµÙˆØ±Ø©"}),e.jsx("th",{children:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[G.map(c=>e.jsxs("tr",{children:[e.jsx("td",{children:z(c.name,g)||c.name?.ar||c.name?.en||c.slug}),e.jsx("td",{style:{fontSize:".6rem"},children:c.slug}),e.jsx("td",{style:{fontSize:".7rem"},children:c.icon||"â€”"}),e.jsx("td",{children:c.image?e.jsx("img",{src:c.image,alt:"cat",style:{width:38,height:38,objectFit:"cover",borderRadius:6}}):"â€”"}),e.jsx("td",{children:c.productCount||0}),e.jsxs("td",{style:ee,children:[e.jsx("button",{style:E,title:"ØªØ¹Ø¯ÙŠÙ„",onClick:()=>L({id:c.id,slug:c.slug,nameAr:c.name?.ar||"",nameEn:c.name?.en||"",descriptionAr:c.description?.ar||"",descriptionEn:c.description?.en||"",image:c.image||"",icon:c.icon||""}),children:"âœ"}),e.jsx("button",{style:ye,title:"Ø­Ø°Ù",onClick:()=>F(c.id),children:"ğŸ—‘"})]})]},c.id)),!G.length&&!J&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:Q,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØµÙ†ÙŠÙØ§Øª"})})]})]})})]})},js=()=>{const{user:g}=tr()||{},[G,S]=s.useState([]),[J,X]=s.useState(!1),[te,D]=s.useState(null),o=async()=>{X(!0),D(null);try{const j=await h.reviewsModerationList();S(Array.isArray(j)?j:j.reviews||[])}catch(j){D(j.message)}finally{X(!1)}};s.useEffect(()=>{g?.role==="admin"&&o()},[g]);const L=async(j,Te)=>{try{await h.reviewModerate(j,Te),await o()}catch(ne){alert("ÙØ´Ù„: "+ne.message)}};return g?.role!=="admin"?null:e.jsxs("div",{style:le,children:[e.jsx("h3",{style:ie,children:"Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ø¨Ø¥Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©"}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[e.jsx("button",{type:"button",onClick:o,style:m,children:"ØªØ­Ø¯ÙŠØ«"}),J&&e.jsx("span",{style:{fontSize:".6rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),te&&e.jsxs("span",{style:{fontSize:".6rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",te]})]}),e.jsxs("table",{style:H,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx("th",{children:"Ø§Ù„Ù…Ù†ØªØ¬"}),e.jsx("th",{children:"Ø§Ù„ØªÙ‚ÙŠÙŠÙ…"}),e.jsx("th",{children:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[G.map(j=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(j.createdAt).toLocaleDateString()}),e.jsx("td",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis"},children:j.productId}),e.jsx("td",{children:j.rating}),e.jsx("td",{children:j.title||"â€”"}),e.jsx("td",{style:{fontSize:".65rem"},children:j.body?.slice(0,140)}),e.jsxs("td",{style:ee,children:[e.jsx("button",{onClick:()=>L(j.id,"approve"),style:E,title:"Ù…ÙˆØ§ÙÙ‚Ø©",children:"âœ”"}),e.jsx("button",{onClick:()=>L(j.id,"reject"),style:ye,title:"Ø±ÙØ¶",children:"âœ–"})]})]},j.id)),!G.length&&!J&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:Q,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ù…Ø¹Ù„Ù‘Ù‚Ø©"})})]})]})]})};export{ll as default};
