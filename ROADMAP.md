# خارطة طريق المشروع (asiaatore)

هذا المستند يوضح خطة تطوير تدريجية للمشروع مع أولويات واضحة وسير عمل مقترح.

## الأهداف
- واجهة مستقرة سريعة بترجمة كاملة (ar/en) وتجربة مستخدم ممتازة.
- API موثوق مع قواعد بيانات مضبوطة، وأمن مناسب، ومسارات دفع سليمة.
- مسار نشر آلي (CI) يتحقق من البناء ويستعد للتوسّع لاحقاً.

---

## المرحلة 0: تشغيل البيئة بسرعة (0-3 أيام)
- [ ] تحديث `.env.example` وإرشادات التشغيل السريع.
- [ ] تفعيل وضع التطوير دون قاعدة بيانات عند الحاجة: `QUICK_START_DB=1` و`ALLOW_INVALID_DB=true`.
- [ ] مزامنة Prisma: `npm run db:generate` ثم `npm run db:push`.
- [ ] إضافة سكربت `dev:all` لتشغيل الواجهة والسيرفر معاً.
- [ ] Husky + lint-staged (اختياري) لتجربة مطوّر أفضل.

نتيجة متوقعة: `npm run dev:server` و`npm run dev` يعملان بثبات محلياً.

---

## المرحلة 1: واجهة المستخدم وi18n (1-2 أسابيع)
- [ ] اعتماد `react-i18next` بالكامل، واستخراج كل النصوص إلى ملفات الترجمة.
- [ ] ضبط `LanguageContext` مع `i18n.changeLanguage` ومسار URL بـ /en.
- [ ] تحسين تجربة المستخدم: تقسيم الكود (code-splitting)، تحسين الصور (srcset/تحجيم)، وضبط كاش TanStack Query.
- [ ] تحسين الوصولية: ARIA للمودالات، اختصارات لوحة المفاتيح، trap focus.

---

## المرحلة 2: الاستقرار الخلفي والأمان (1-2 أسابيع)
- [ ] توحيد أشكال الاستجابة (Response Schemas) وإضافة validation (zod/joi).
- [ ] تحسين خرائط أخطاء Prisma (P2002/P2003) برسائل مفهومة.
- [ ] تشديد الأمن: Helmet/CSP، وتعطيل رؤوس التطوير في الإنتاج.
- [ ] فهارس قواعد البيانات للحالات الحرجة (Products/Orders).

---

## المرحلة 3: الطلبات والمدفوعات (1-2 أسابيع)
- [ ] Webhooks موثوقة لمزوّدي الدفع + مفاتيح idempotency.
- [ ] سجل معاملات (Transactions) وربطه بالطلبات.
- [ ] فواتير PDF + بريد إلكتروني وإشعارات (SSE/Socket.IO).

---

## المرحلة 4: البحث والفهرسة (2-4 أسابيع)
- [ ] دمج Meilisearch/Typesense: فهرسة المنتجات والبحث مع فلاتر.
- [ ] مزامنة الخلفية عند إنشاء/تحديث/حذف المنتج.
- [ ] واجهة بحث غنية: اقتراحات فورية، highlight، كاش.

---

## المرحلة 5: الميديا والنشر والمراقبة (لاحقاً)
- [ ] رفع إلى S3/Backblaze مع Presigned URLs؛ CDN للصور.
- [ ] Docker للنشر (multi-stage) + PM2/Compose.
- [ ] مراقبة الأخطاء (Sentry) وسجلات منظّمة.

---

## CI/CD (الخطوة الأولى)
- [ ] GitHub Actions: بناء Node 20 + cache npm + `npm run build`.
- [ ] لاحقاً: خدمة MySQL لاختبارات التكامل أو Testcontainers.

---

## سير العمل (Workflow)
- فروع:
  - `main`: جاهز للإنتاج.
  - `develop`: دمج الميزات قبل النشر.
  - `feature/<اسم-الميزة>` و`fix/<وصف-الإصلاح>`.
- PRs:
  - مراجعة واحد على الأقل.
  - بناء CI يجب أن ينجح قبل الدمج.
- قواعد الالتزام (Commits):
  - Conventional Commits: `feat: ...`, `fix: ...`, `chore: ...`, `docs: ...`.

---

## تتبُّع العمل
- استخدم هذه الخارطة كقاعدة لإنشاء Issues مرتبة بحسب المراحل.
- يمكن تحويل كل مربع اختيار إلى Issue وربطه بمشروع (Project board) داخل GitHub.

> ملاحظة: هذه الوثيقة حية — حدّثها عند تغيير الأولويات أو إضافة تفاصيل جديدة.
