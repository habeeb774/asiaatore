import{a7 as R,a6 as $,r as s,u as C,j as t,L as P}from"./vendor.react-C0fmYGW5.js";import{u as A}from"./index-8VDXgoeV.js";import"./vendor-CF_-ATCh.js";import"./vendor.router-2GzHiivc.js";import"./vendor.i18next-COqwnjR1.js";import"./vendor.zustand-BuMo4m-J.js";import"./vendor.tanstack-K6OTystZ.js";import"./vendor.leaflet-U7UpOlxs.js";/* empty css                     */const U=()=>{const{id:n}=R(),[x]=$(),{locale:a}=A()||{locale:"ar"},u=s.useRef(null),[w,L]=s.useState(!1),E=C(),p=(()=>{try{return localStorage.getItem("my_store_token")||""}catch{return""}})(),f=`/api/orders/${n}/invoice${p?`?token=${encodeURIComponent(p)}`:""}`,[o,g]=s.useState("A4"),[i,h]=s.useState("portrait"),[c,y]=s.useState("16"),[l,v]=s.useState("12"),[m,b]=s.useState("16"),[d,j]=s.useState("12"),N="invoice_paper_opts";s.useEffect(()=>{try{const e=localStorage.getItem(N);if(e){const r=JSON.parse(e);r.size&&g(r.size),r.orientation&&h(r.orientation),r.mt!=null&&y(String(r.mt)),r.mr!=null&&v(String(r.mr)),r.mb!=null&&b(String(r.mb)),r.ml!=null&&j(String(r.ml))}}catch{}},[]),s.useEffect(()=>{try{const e={size:o,orientation:i,mt:c,mr:l,mb:m,ml:d};localStorage.setItem(N,JSON.stringify(e))}catch{}},[o,i,c,l,m,d]);const k=s.useMemo(()=>{const e=new URLSearchParams;p&&e.set("token",p),o&&e.set("size",o),i&&e.set("orientation",i),c&&e.set("mt",c),l&&e.set("mr",l),m&&e.set("mb",m),d&&e.set("ml",d);const r=e.toString();return`/api/orders/${n}/invoice.pdf${r?`?${r}`:""}`},[n,p,o,i,c,l,m,d]),S=x.get("print")==="1"||x.get("print")==="true";return s.useEffect(()=>{const e=u.current;if(!e)return;const r=()=>{if(L(!0),S)try{setTimeout(()=>{e.contentWindow&&e.contentWindow.focus(),e.contentWindow&&e.contentWindow.print()},150)}catch{}};return e.addEventListener("load",r),()=>e.removeEventListener("load",r)},[S,n,E.key]),t.jsxs("div",{className:"min-h-screen flex flex-col",style:{direction:a==="ar"?"rtl":"ltr"},children:[t.jsxs("div",{className:"px-4 py-3 border-b bg-white flex items-center gap-2 flex-wrap",children:[t.jsx(P,{to:a==="en"?"/en/orders":"/orders",className:"btn-secondary px-3 py-1 text-sm",children:a==="ar"?"رجوع للطلبات":"Back to orders"}),t.jsx("a",{href:f,target:"_blank",rel:"noopener",className:"btn-secondary px-3 py-1 text-sm",children:a==="ar"?"فتح في تبويب جديد":"Open in new tab"}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-gray-600",children:a==="ar"?"الحجم":"Size"}),t.jsx("select",{value:o,onChange:e=>g(e.target.value),className:"border rounded px-2 py-1",children:["A3","A4","A5","LETTER","LEGAL","TABLOID"].map(e=>t.jsx("option",{value:e,children:e},e))})]}),t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-gray-600",children:a==="ar"?"الاتجاه":"Orientation"}),t.jsxs("select",{value:i,onChange:e=>h(e.target.value),className:"border rounded px-2 py-1",children:[t.jsx("option",{value:"portrait",children:a==="ar"?"عمودي":"Portrait"}),t.jsx("option",{value:"landscape",children:a==="ar"?"أفقي":"Landscape"})]})]}),t.jsxs("div",{className:"hidden md:flex items-center gap-1",children:[t.jsxs("span",{className:"text-gray-600",children:[a==="ar"?"هوامش(mm)":"Margins(mm)",":"]}),t.jsx("input",{value:c,onChange:e=>y(e.target.value),className:"w-14 border rounded px-2 py-1",title:a==="ar"?"علوي":"Top"}),t.jsx("input",{value:l,onChange:e=>v(e.target.value),className:"w-14 border rounded px-2 py-1",title:a==="ar"?"أيمن":"Right"}),t.jsx("input",{value:m,onChange:e=>b(e.target.value),className:"w-14 border rounded px-2 py-1",title:a==="ar"?"سفلي":"Bottom"}),t.jsx("input",{value:d,onChange:e=>j(e.target.value),className:"w-14 border rounded px-2 py-1",title:a==="ar"?"أيسر":"Left"})]})]}),t.jsx("a",{href:k,target:"_blank",rel:"noopener",className:"btn-secondary px-3 py-1 text-sm",children:a==="ar"?"تحميل PDF":"Download PDF"}),t.jsx("button",{type:"button",onClick:()=>{try{const e=u.current?.contentWindow;e?.focus(),e?.print()}catch{}},className:"btn-primary px-3 py-1 text-sm",disabled:!w,children:a==="ar"?"طباعة":"Print"}),t.jsx("div",{className:"ml-auto text-sm text-gray-600",children:a==="ar"?`فاتورة #${n}`:`Invoice #${n}`})]}),t.jsx("div",{className:"flex-1 bg-gray-50",children:t.jsx("iframe",{ref:u,title:`invoice-${n}`,src:f,style:{width:"100%",height:"100%",border:"0",display:"block"}})})]})};export{U as default};
