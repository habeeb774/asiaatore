function a(){try{return localStorage.getItem("my_store_token")||""}catch{return""}}async function s(n){const e=a(),o=await fetch(`/api/invoices/by-order/${encodeURIComponent(n)}`,{headers:e?{Authorization:`Bearer ${e}`}:{}});if(!o.ok)throw new Error(`Failed to fetch invoice: ${o.status}`);const t=await o.json();if(!t?.ok||!t.invoice)throw new Error("Invoice not found");return t.invoice}async function d(n,{format:e="a4"}={}){const o=a(),t=`/api/invoices/${encodeURIComponent(n)}/pdf?format=${encodeURIComponent(e)}`,r=await fetch(t,{headers:o?{Authorization:`Bearer ${o}`}:{}});if(!r.ok)throw new Error(`Failed to download PDF: ${r.status}`);const i=await r.blob(),c=URL.createObjectURL(i);window.open(c,"_blank","noopener"),setTimeout(()=>URL.revokeObjectURL(c),6e4)}async function w(n,e){const o=await s(n);return d(o.id,e)}async function f(n={}){const e=a(),o=new URLSearchParams(n).toString(),t=`/api/invoices${o?"?"+o:""}`,r=await fetch(t,{headers:e?{Authorization:`Bearer ${e}`}:{}});if(!r.ok)throw new Error(`Failed to list invoices: ${r.status}`);const i=await r.json();if(!i?.ok)throw new Error("Invalid response");return i.invoices||[]}export{d as a,f as l,w as o};
