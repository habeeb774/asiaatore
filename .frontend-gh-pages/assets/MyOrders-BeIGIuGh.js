import{r as o,j as e,L as p}from"./vendor.react-C0fmYGW5.js";import{g,f as u}from"./index-B0cb22ux.js";import"./vendor-CF_-ATCh.js";import"./vendor.router-2GzHiivc.js";import"./vendor.i18next-COqwnjR1.js";import"./vendor.zustand-BuMo4m-J.js";import"./vendor.tanstack-K6OTystZ.js";import"./vendor.leaflet-U7UpOlxs.js";/* empty css                     */const x=["pending","pending_bank_review","processing","shipped","delivered"];function h({status:i}){const d=x.indexOf(i);return e.jsx("div",{className:"offers-page catalog-page container-custom px-4 py-8",children:x.map((r,n)=>{const a=d>=n;return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`px-2 py-1 rounded border ${a?"bg-green-600 text-white border-green-600":"bg-gray-100 text-gray-500 border-gray-300"}`,children:r}),n<x.length-1&&e.jsx("span",{className:`w-6 h-px ${d>=n+1?"bg-green-600":"bg-gray-300"}`})]},r)})})}const O=()=>{const{paged:i,loading:d,error:r,refresh:n}=g()||{},{user:a}=u()||{},l=o.useMemo(()=>(i||[]).filter(s=>String(s.userId)===String(a?.id||"guest")),[i,a]);return a?d?e.jsx("div",{className:"container-custom px-4 py-12 text-center text-sm opacity-70",children:"جار التحميل..."}):r?e.jsxs("div",{className:"container-custom px-4 py-12 text-center text-sm text-red-600",children:["خطأ: ",r]}):l.length===0?e.jsx("div",{className:"container-custom px-4 py-12 text-center",children:"لا توجد طلبات حتى الآن"}):e.jsxs("div",{className:"container-custom px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["طلباتي (",l.length,")"]}),e.jsx("button",{onClick:()=>n(),className:"btn-secondary px-3 py-2 text-sm",children:"تحديث"})]}),e.jsx("div",{className:"space-y-5",children:l.map(s=>{const m=s.grandTotal??s.total??(s.items||[]).reduce((t,c)=>t+(c.price||0)*(c.quantity||1),0);return e.jsxs("div",{className:"border rounded p-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold",children:["#",s.id]}),e.jsx("div",{className:"text-sm text-gray-600",children:new Date(s.createdAt).toLocaleString()}),e.jsxs("div",{className:"text-sm mt-1",children:["الإجمالي: ",e.jsxs("strong",{children:[m," ",s.currency||"ر.س"]})]})]}),e.jsxs("div",{className:"text-sm flex flex-col items-start gap-1 min-w-[180px]",children:[e.jsx("span",{className:"inline-block px-2 py-0.5 rounded bg-slate-100 text-slate-700 text-xs",children:s.status}),e.jsx(p,{to:`/order/${s.id}`,className:"btn-secondary px-3 py-1 text-xs",children:"تفاصيل"}),e.jsx("a",{href:`/api/orders/${s.id}/invoice`,target:"_blank",rel:"noopener",className:"btn-secondary px-3 py-1 text-xs",children:"فاتورة"})]})]}),e.jsx(h,{status:s.status}),e.jsxs("div",{className:"mt-4 grid sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[(s.items||[]).slice(0,6).map(t=>{const c=typeof t.name=="string"?t.name:t.name?.ar||t.name?.en||t.productId;return e.jsxs("div",{className:"p-2 border rounded text-xs flex flex-col gap-1 bg-white/50",children:[e.jsx("div",{className:"font-semibold truncate",title:c,children:c}),e.jsxs("div",{className:"text-gray-600",children:[t.quantity," × ",t.price," = ",(t.quantity||1)*t.price]})]},t.id)}),(s.items||[]).length>6&&e.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:["+",(s.items||[]).length-6," عناصر إضافية"]})]})]},s.id)})})]}):e.jsx("div",{className:"container-custom px-4 py-12 text-center",children:"الرجاء تسجيل الدخول لعرض طلباتك"})};export{O as default};
