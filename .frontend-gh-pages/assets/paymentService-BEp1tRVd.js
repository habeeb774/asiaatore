const l=typeof import.meta<"u"&&"https://my-store-backend-production.up.railway.app/api"||"/api";async function y(t,r={}){const e=t.startsWith("http")?t:`${l}${t}`,a=await fetch(e,{headers:{"Content-Type":"application/json",...r.headers||{}},...r,body:r.body?JSON.stringify(r.body):void 0}),i=await a.text(),n=i?JSON.parse(i):null;if(!a.ok){const s=new Error(n?.message||"API request failed");throw s.status=a.status,s.body=n,s}return n}const u=(t,r)=>y(t,{method:"POST",body:r});async function p(t,r){const e=t.startsWith("http")?t:`${l}${t}`;let a=null;try{a=localStorage.getItem("my_store_token")}catch{a=null}const i=a?{Authorization:`Bearer ${a}`}:void 0;let n;try{n=await fetch(e,{method:"POST",body:r,headers:i})}catch(d){const c=new Error("Network upload error: "+d.message);throw c.status=0,c}const s=await n.text();let o=null;try{o=s?JSON.parse(s):null}catch{o=null}if(!n.ok){const d=o?.message||o?.error||"Upload failed",c=new Error(d+(o?.error?` [${o.error}]`:""));throw c.status=n.status,c.body=o,c}return o}async function f(t={}){const r={order:{total:t.total??t.amount??0,currency:t.currency??"SAR",items:t.items||[]},localOrderId:t.orderId||t.localOrderId||null};return u("/pay/paypal/create-order",r)}async function m(t){return u("/pay/stc/create",t)}async function h({orderId:t,sessionId:r,success:e=!0}={}){return u("/pay/stc/confirm",{orderId:t,sessionId:r,success:e})}async function w({orderId:t}={}){return u("/pay/bank/init",{orderId:t})}async function b({orderId:t,file:r}){const e=new FormData;return e.append("orderId",t),e.append("receipt",r),p("/pay/bank/upload",e)}export{f as a,h as b,m as c,w as i,b as u};
