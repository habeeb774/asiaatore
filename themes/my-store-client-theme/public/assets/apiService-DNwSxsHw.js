const u=typeof import.meta<"u"&&"https://my-store-backend-production.up.railway.app/api"||"/api";async function d(t,e={}){const c=t.startsWith("http")?t:`${u}${t}`,r=await fetch(c,{headers:{"Content-Type":"application/json",...e.headers||{}},...e,body:e.body?JSON.stringify(e.body):void 0}),i=await r.text(),s=i?JSON.parse(i):null;if(!r.ok){const o=new Error(s?.message||"API request failed");throw o.status=r.status,o.body=s,o}return s}const y=(t,e,c={})=>d(t,{method:"POST",body:e,headers:c});async function h(t,e){const c=t.startsWith("http")?t:`${u}${t}`;let r=null;try{r=localStorage.getItem("my_store_token")}catch{r=null}const i=r?{Authorization:`Bearer ${r}`}:void 0;let s;try{s=await fetch(c,{method:"POST",body:e,headers:i})}catch(l){const n=new Error("Network upload error: "+l.message);throw n.status=0,n}const o=await s.text();let a=null;try{a=o?JSON.parse(o):null}catch{a=null}if(!s.ok){const l=a?.message||a?.error||"Upload failed",n=new Error(l+(a?.error?` [${a.error}]`:""));throw n.status=s.status,n.body=a,n}return a}export{u as A,y as a,h as b};
