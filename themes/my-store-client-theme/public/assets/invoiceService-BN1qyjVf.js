import{A as m}from"./apiService-DNwSxsHw.js";async function p(c,l={}){if(!c)throw new Error("orderId is required");const{format:s,query:d={}}=l,a=new URLSearchParams;s&&a.set("format",String(s));for(const[e,t]of Object.entries(d))t!=null&&a.set(e,String(t));const w=a.toString(),f=`${m}/orders/${encodeURIComponent(c)}/invoice${w?`?${w}`:""}`;try{if(window.open(f,"_blank","noopener"))return}catch{}let r=null;try{r=localStorage.getItem("my_store_token")}catch{r=null}const h=r?{Authorization:`Bearer ${r}`}:void 0;let n;try{n=await fetch(f,{method:"GET",headers:h})}catch(e){throw new Error("Network error while fetching invoice: "+e.message)}if(!n.ok){let e=`Failed to fetch invoice (HTTP ${n.status})`;try{const i=await n.text();if(i)try{const o=JSON.parse(i);o?.message&&(e=o.message)}catch{}}catch{}const t=new Error(e);throw t.status=n.status,t}try{const e=await n.blob(),t=URL.createObjectURL(e);if(!window.open(t,"_blank","noopener")){const o=document.createElement("a");o.href=t,o.download=`invoice-${c}.pdf`,document.body.appendChild(o),o.click(),o.remove()}setTimeout(()=>URL.revokeObjectURL(t),15e3)}catch(e){throw new Error("Unable to open invoice: "+(e?.message||"unknown error"))}}export{p as o};
