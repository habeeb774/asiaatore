const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AdsAdmin-Clc91t0a.js","assets/vendor.react-BYd2qOD7.js","assets/vendor-B1AZ7KNd.js","assets/vendor.router-BdFOcp8q.js","assets/vendor.i18next-COqwnjR1.js","assets/vendor.zustand-BuMo4m-J.js","assets/vendor.tanstack-K6OTystZ.js","assets/vendor.leaflet-DeoKySpZ.js","assets/index-KQCI4LeS.js","assets/index-DZaiRlRO.css","assets/vendor-B1-rhOTE.css"])))=>i.map(i=>d[i]);
import{_ as rs}from"./vendor.tanstack-K6OTystZ.js";import{r as s,u as ns,b as ss,R as Ue,j as e,ap as ft,X as jt,aq as Ne,a0 as vt}from"./vendor.react-BYd2qOD7.js";import{u as Xr,e as Kr,f as is,p as as,r as E,a as ls,g,q as he,S as os,s as cs,n as l}from"./index-KQCI4LeS.js";/* empty css                  */import"./vendor-B1AZ7KNd.js";import"./vendor.router-BdFOcp8q.js";import"./vendor.i18next-COqwnjR1.js";import"./vendor.zustand-BuMo4m-J.js";import"./vendor.leaflet-DeoKySpZ.js";/* empty css                     */const ds=Ue.lazy(()=>rs(()=>import("./AdsAdmin-Clc91t0a.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),ri=()=>{const{locale:m}=Xr(),{user:H}=Kr()||{},b=H?.role==="admin",{refresh:Q}=is()||{},{products:G,users:Z,orders:F,addProduct:c,updateProduct:z,deleteProduct:f,addUser:Pe,updateUser:ee,deleteUser:At,addOrder:kt,updateOrder:Et,deleteOrder:Zt}=as(),[P,d]=s.useState([]),[o,k]=s.useState(!1),[_,M]=s.useState(!1),[er,Le]=s.useState(null),N=o?P:G,Yr=ns();ss();const h=new URLSearchParams(Yr.search).get("view")||"overview",[zt,Zr]=s.useState([]),[tr,en]=s.useState([]),[se,rr]=s.useState(1),[Fe,tn]=s.useState(1),[rn,nn]=s.useState(0),[He,nr]=s.useState(!1),[Qe,sr]=s.useState(null),[u,O]=s.useState({id:null,nameAr:"",nameEn:"",price:"",stock:"",status:"active",category:"general",oldPrice:"",image:""}),[J,Ge]=s.useState(null),[ge,ir]=s.useState("file"),ar=s.useRef(null),[Je,sn]=s.useState({todayOrders:0,todayRevenue:0,avgOrderValueToday:0,pendingBankCount:0}),[Pt,an]=s.useState(14),[L,ln]=s.useState(null),[lr,or]=s.useState(!1),[cr,dr]=s.useState(null),[ur,on]=s.useState([]),[fs,js]=s.useState(!1),[Lt,cn]=s.useState("created_desc"),[Xe,dn]=s.useState(""),[pr,me]=s.useState([]),[vs,un]=s.useState({id:null,name:"",role:"user",active:!0}),[bs,pn]=s.useState({id:null,total:"",status:"pending",customer:"",items:1}),[hn,Ss]=s.useState(""),R=hn.toLowerCase(),xe=s.useMemo(()=>{let t=N.map(r=>({...r,_flatName:String(E(r.name,m)||r.name?.ar||r.name?.en||r.name||"").toLowerCase()}));return R&&(t=t.filter(r=>r._flatName.includes(R)||(E(r.name,m)||r.name?.ar||r.name?.en||r.slug||"").toLowerCase().includes(R))),Xe&&(t=t.filter(r=>r.category===Xe)),t=[...t].sort((r,n)=>{switch(Lt){case"price_asc":return r.price-n.price;case"price_desc":return n.price-r.price;case"stock_asc":return r.stock-n.stock;case"stock_desc":return n.stock-r.stock;case"created_asc":return r.id.localeCompare(n.id);case"created_desc":default:return n.id.localeCompare(r.id)}}),t},[N,R,Xe,Lt]),[ie,Ft]=s.useState(1),[Te,gn]=s.useState(20),Ke=Math.max(1,Math.ceil((xe.length||0)/Te)),mn=s.useMemo(()=>{const t=(ie-1)*Te;return xe.slice(t,t+Te)},[xe,ie,Te]),[W,hr]=s.useState(null),[gr,Ye]=s.useState({}),[mr,ye]=s.useState(!1),[xr,ae]=s.useState(null),Ze={id:null,minQty:"",price:"",packagingType:"unit",noteAr:"",noteEn:""},[S,X]=s.useState(Ze),xn=["unit","carton","bundle"],yn=async t=>{ye(!0),ae(null);try{const r=await g.tierList(t);Ye(n=>({...n,[t]:r}))}catch(r){ae(r.message)}finally{ye(!1)}},fn=t=>{if(ae(null),X(Ze),W===t){hr(null);return}hr(t),gr[t]||yn(t)},jn=async t=>{if(t.preventDefault(),!!W){ye(!0),ae(null);try{if(S.id){const r=await g.tierUpdate(S.id,{minQty:+S.minQty,price:+S.price,packagingType:S.packagingType,noteAr:S.noteAr||null,noteEn:S.noteEn||null});Ye(n=>({...n,[W]:(n[W]||[]).map(a=>a.id===r.id?r:a)}))}else{const r=await g.tierCreate(W,{minQty:+S.minQty,price:+S.price,packagingType:S.packagingType,noteAr:S.noteAr||null,noteEn:S.noteEn||null});Ye(n=>({...n,[W]:[...n[W]||[],r].sort((a,i)=>a.minQty-i.minQty)}))}X(Ze)}catch(r){ae(r.message.includes("DUPLICATE_TIER")?"Ø´Ø±ÙŠØ­Ø© Ù…ÙƒØ±Ø±Ø© Ù„Ù†ÙØ³ Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ ÙˆÙ†ÙˆØ¹ Ø§Ù„ØªØºÙ„ÙŠÙ":r.message)}finally{ye(!1)}}},vn=t=>{X({id:t.id,minQty:t.minQty,price:t.price,packagingType:t.packagingType,noteAr:t.note?.ar||"",noteEn:t.note?.en||""})},bn=async t=>{if(window.confirm("Ø­Ø°Ù Ø§Ù„Ø´Ø±ÙŠØ­Ø©ØŸ")){ye(!0),ae(null);try{await g.tierDelete(t.id),Ye(r=>({...r,[W]:(r[W]||[]).filter(n=>n.id!==t.id)}))}catch(r){ae(r.message)}finally{ye(!1)}}},Tt=zt.length?zt:Z;s.useMemo(()=>Tt.filter(t=>(t.name||"").toLowerCase().includes(R)||(t.role||"").includes(R)),[Tt,R]);const[fe,yr]=s.useState(""),[je,fr]=s.useState(""),[ve,jr]=s.useState(""),[be,vr]=s.useState(""),[Rt,Sn]=s.useState(null),[Dt,Se]=s.useState(null),[et,le]=s.useState(!1),[br,oe]=s.useState(null),[tt,Sr]=s.useState(null),wr=Ue.useRef(null),[w,C]=s.useState({siteNameAr:"",siteNameEn:"",colorPrimary:"",colorSecondary:"",colorAccent:"",supportPhone:"",supportMobile:"",supportWhatsapp:"",supportEmail:"",supportHours:"",footerAboutAr:"",footerAboutEn:"",linkBlog:"",linkSocial:"",linkReturns:"",linkPrivacy:"",appStoreUrl:"",playStoreUrl:""}),D=ls();s.useEffect(()=>{if(D?.setting){Se(D.setting);const t=D.setting;C(r=>({...r,siteNameAr:t.siteNameAr||"",siteNameEn:t.siteNameEn||"",colorPrimary:t.colorPrimary||"",colorSecondary:t.colorSecondary||"",colorAccent:t.colorAccent||"",supportPhone:t.supportPhone||"",supportMobile:t.supportMobile||"",supportWhatsapp:t.supportWhatsapp||"",supportEmail:t.supportEmail||"",supportHours:t.supportHours||"",footerAboutAr:t.footerAboutAr||"",footerAboutEn:t.footerAboutEn||"",linkBlog:t.linkBlog||"",linkSocial:t.linkSocial||"",linkReturns:t.linkReturns||"",linkPrivacy:t.linkPrivacy||"",appStoreUrl:t.appStoreUrl||"",playStoreUrl:t.playStoreUrl||""}))}},[D?.setting]);const[rt,_t]=s.useState([]),[Cr,nt]=s.useState(!1),[st,it]=s.useState(null),[Re,at]=s.useState([]),[T,wn]=s.useState(null),[x,K]=s.useState({id:null,slug:"",nameAr:"",nameEn:"",descriptionAr:"",descriptionEn:"",logo:""}),[De,Ar]=s.useState(null),[kr,B]=s.useState(!1),[Er,U]=s.useState(null),[lt,Cn]=s.useState(""),[Mt,An]=s.useState("created_desc"),[Ot,ce]=s.useState(""),[zr,Pr]=s.useState(!1),[we,Lr]=s.useState(""),[It,ot]=s.useState([]),[Fr,kn]=s.useState(""),[ct,dt]=s.useState([]),[Nt,En]=s.useState([]),[Wt,ut]=s.useState([]),[y,$]=s.useState({id:null,titleAr:"",titleEn:"",bodyAr:"",bodyEn:"",icon:"",sort:0,active:!0}),[Bt,zn]=s.useState([]),[ws,Tr]=s.useState(!1),[Cs,Rr]=s.useState(null),[Dr,As]=s.useState(""),[_r,ks]=s.useState("recent"),[Mr,Es]=s.useState(""),[zs,Ps]=s.useState({id:null,nameAr:"",nameEn:"",price:"",oldPrice:"",image:"",category:"general"}),[pt,Ls]=s.useState(""),[ht,Fs]=s.useState({productId:"",percent:"",newPrice:""}),[Ts,Rs]=s.useState(!1),[Or,Ds]=s.useState(!1),[_s,Ms]=s.useState([]),[Os,Is]=s.useState(""),[Ns,Ws]=s.useState({id:null,location:"homepage",titleAr:"",titleEn:"",bodyAr:"",bodyEn:"",image:"",linkUrl:"",sort:0,active:!0}),[Bs,Us]=s.useState(null),[A,te]=s.useState({id:null,platform:"web",url:"",labelAr:"",labelEn:"",active:!0}),[Ir,Ce]=s.useState(!1),[$s,Ae]=s.useState(null),[gt,Pn]=s.useState(""),[Ut,qs]=s.useState(""),[mt,Ln]=s.useState(""),[$t,Fn]=s.useState("sort_asc"),[Nr,Vs]=s.useState("sort_asc"),[qt,Tn]=s.useState("platform_asc"),[_e,Rn]=s.useState(null),[Wr,Dn]=s.useState(30),Vt=async(t=Wr)=>{try{const r=await g.marketingMetrics(t);Rn(r)}catch(r){console.error("metrics",r)}};s.useEffect(()=>{h==="marketing"&&_e==null&&Vt()},[h]);const Me=s.useMemo(()=>F.filter(t=>{if(R&&!((t.id+"").toLowerCase().includes(R)||(t.status||"").includes(R)||(""+t.total).includes(R))||fe&&t.status!==fe||je&&t.paymentMethod!==je)return!1;if(ve){const r=new Date(ve);if(!isNaN(r)&&new Date(t.createdAt)<r)return!1}if(be){const r=new Date(be);if(!isNaN(r)&&(r.setHours(23,59,59,999),new Date(t.createdAt)>r))return!1}return!0}),[F,R,fe,je,ve,be]),[de,Ht]=s.useState(1),[Oe,_n]=s.useState(50),xt=Math.max(1,Math.ceil((Me.length||0)/Oe)),Mn=s.useMemo(()=>{const t=(de-1)*Oe;return Me.slice(t,t+Oe)},[Me,de,Oe]),Qt=async()=>{B(!0),U(null);try{const t=await g.brandsList();at(t)}catch(t){U(t.message)}finally{B(!1)}},Br=m==="ar"?D?.setting?.siteNameAr||"Ø´Ø±ÙƒØ© Ù…Ù†ÙØ° Ø§Ø³ÙŠØ§ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©":D?.setting?.siteNameEn||"My Store",Gt=m==="ar"?`Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | ${Br}`:`${Br} | Admin Dashboard`;s.useEffect(()=>{try{document.title=Gt}catch{}},[Gt]);const Jt=async()=>{B(!0),U(null);try{const t=await fetch("/api/brands/maintenance/scan",{headers:ue()});if(!t.ok)throw new Error("ÙØ´Ù„ Ø§Ù„ÙØ­Øµ");const r=await t.json();wn(r.issues||{})}catch(t){U(t.message)}finally{B(!1)}},Ur=async t=>{B(!0),U(null);try{if(!(await fetch("/api/brands/maintenance/regen-logos",{method:"POST",headers:{...ue(),"Content-Type":"application/json"},body:JSON.stringify(t?{brandId:t}:{})})).ok)throw new Error("ÙØ´Ù„ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙˆØ±");await Jt(),alert("ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ ØµÙˆØ± Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª")}catch(r){U(r.message)}finally{B(!1)}},On=async(t,r)=>{B(!0),U(null);try{if(!(await fetch("/api/brands/maintenance/merge",{method:"POST",headers:{...ue(),"Content-Type":"application/json"},body:JSON.stringify({targetId:t,sourceIds:r})})).ok)throw new Error("ÙØ´Ù„ Ø§Ù„Ø¯Ù…Ø¬");await Qt(),await Jt(),alert("ØªÙ… Ø§Ù„Ø¯Ù…Ø¬ Ø¨Ù†Ø¬Ø§Ø­")}catch(n){U(n.message)}finally{B(!1)}},In=async t=>{t.preventDefault(),B(!0),U(null);try{const r=!!De;let n;if(r?(n=new FormData,x.slug&&n.append("slug",x.slug),n.append("nameAr",x.nameAr),n.append("nameEn",x.nameEn),x.descriptionAr&&n.append("descriptionAr",x.descriptionAr),x.descriptionEn&&n.append("descriptionEn",x.descriptionEn),De&&n.append("logo",De)):n={slug:x.slug||void 0,nameAr:x.nameAr,nameEn:x.nameEn,descriptionAr:x.descriptionAr||null,descriptionEn:x.descriptionEn||null,logo:x.logo||null},x.id){const a=r?await fetch(`/api/brands/${x.id}`,{method:"PUT",body:n,headers:ue()}).then(i=>i.json()):await g.brandUpdate(x.id,n);a?.id&&at(i=>i.map(p=>p.id===a.id?a:p))}else{const a=r?await fetch("/api/brands",{method:"POST",body:n,headers:ue()}).then(i=>i.json()):await g.brandCreate(n);a?.id&&at(i=>[a,...i])}K({id:null,slug:"",nameAr:"",nameEn:"",descriptionAr:"",descriptionEn:"",logo:""}),Ar(null)}catch(r){U(r.message)}finally{B(!1)}},Nn=async t=>{const r=window.prompt("Ø­Ø°Ù Ø§Ù„Ø¹Ù„Ø§Ù…Ø©ØŸ Ø§ÙƒØªØ¨: none Ù„Ø¥Ù„ØºØ§Ø¡ Ø±Ø¨Ø· Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (force)ØŒ Ø£Ùˆ brand:<TARGET_ID> Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ø¹Ù„Ø§Ù…Ø© Ø£Ø®Ø±Ù‰ØŒ Ø£Ùˆ Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±Øº Ù„Ù„Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¥Ø°Ø§ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª.");let n=`/api/brands/${t}`;if(r&&r.startsWith("brand:")){const a=r.split(":")[1];n+=`?reassignTo=${encodeURIComponent(a)}`}else r==="none"&&(n+="?force=1");try{if(!(await fetch(n,{method:"DELETE",headers:ue()})).ok)throw new Error("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù");at(i=>i.filter(p=>p.id!==t))}catch(a){alert("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù: "+a.message)}},Wn=async()=>{Ce(!0),Ae(null);try{const[t,r,n]=await Promise.all([g.marketingFeatures(),g.marketingBanners(),g.marketingAppLinks()]);dt(t),En(r),ut(n)}catch(t){Ae(t.message)}finally{Ce(!1)}},Bn=async t=>{t.preventDefault(),Ce(!0),Ae(null);try{if(y.id){const r=await g.marketingFeatureUpdate(y.id,{titleAr:y.titleAr,titleEn:y.titleEn,bodyAr:y.bodyAr||null,bodyEn:y.bodyEn||null,icon:y.icon||null,sort:y.sort,active:y.active});dt(n=>n.map(a=>a.id===r.id?r:a))}else{const r=await g.marketingFeatureCreate({titleAr:y.titleAr,titleEn:y.titleEn,bodyAr:y.bodyAr||null,bodyEn:y.bodyEn||null,icon:y.icon||null,sort:y.sort,active:y.active});dt(n=>[r,...n])}$({id:null,titleAr:"",titleEn:"",bodyAr:"",bodyEn:"",icon:"",sort:0,active:!0})}catch(r){Ae(r.message)}finally{Ce(!1)}},Un=async t=>{if(window.confirm("Ø­Ø°Ù Ø§Ù„Ù…ÙŠØ²Ø©ØŸ"))try{await g.marketingFeatureDelete(t),dt(r=>r.filter(n=>n.id!==t))}catch(r){alert("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù: "+r.message)}},$n=async t=>{t.preventDefault(),Ce(!0),Ae(null);try{if(A.id){const r=await g.marketingAppLinkUpdate(A.id,{platform:A.platform,url:A.url,labelAr:A.labelAr||null,labelEn:A.labelEn||null,active:A.active});ut(n=>n.map(a=>a.id===r.id?r:a))}else{const r=await g.marketingAppLinkCreate({platform:A.platform,url:A.url,labelAr:A.labelAr||null,labelEn:A.labelEn||null,active:A.active});ut(n=>[r,...n])}te({id:null,platform:"web",url:"",labelAr:"",labelEn:"",active:!0})}catch(r){Ae(r.message)}finally{Ce(!1)}},qn=async t=>{if(window.confirm("Ø­Ø°Ù Ø§Ù„Ø±Ø§Ø¨Ø·ØŸ"))try{await g.marketingAppLinkDelete(t),ut(r=>r.filter(n=>n.id!==t))}catch(r){alert("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù: "+r.message)}};s.useEffect(()=>{h==="brands"&&!Re.length&&Qt()},[h]),s.useEffect(()=>{h==="marketing"&&!ct.length&&!Nt.length&&Wn()},[h]),s.useEffect(()=>{h==="settings"&&!Dt&&Kt()},[h]);function ue(){try{const t=localStorage.getItem("my_store_token");if(t)return{Authorization:"Bearer "+t}}catch{}return{}}const ke=s.useMemo(()=>{let t=[...Re];const r=(()=>{const n={duplicates:new Set,noLogo:new Set,zeroProducts:new Set,missingVariants:new Set};if(!T)return n;const a={...n};for(const i of T.duplicateNames||[])for(const p of i.ids||[])a.duplicates.add(p);for(const i of T.noLogo||[])a.noLogo.add(i.id);for(const i of T.zeroProducts||[])a.zeroProducts.add(i.id);for(const i of T.missingLogoVariants||[])a.missingVariants.add(i.id);return a})();if(Ot){const n=r[Ot]||new Set;t=t.filter(a=>n.has(a.id))}if(lt){const n=lt.toLowerCase();t=t.filter(a=>((E(a.name,m)||a.name?.ar||a.name?.en||a.slug||"")+"").toLowerCase().includes(n))}return t.sort((n,a)=>{switch(Mt){case"name_ar":return(n.name?.ar||"").localeCompare(a.name?.ar||"");case"name_en":return(n.name?.en||"").localeCompare(a.name?.en||"");case"products_desc":return(a.productCount||0)-(n.productCount||0);case"products_asc":return(n.productCount||0)-(a.productCount||0);case"created_asc":return new Date(n.createdAt)-new Date(a.createdAt);case"created_desc":default:return new Date(a.createdAt)-new Date(n.createdAt)}}),t},[Re,lt,Mt]),[pe,Xt]=s.useState(1),[Ie,Vn]=s.useState(30),yt=Math.max(1,Math.ceil((ke.length||0)/Ie)),Hn=s.useMemo(()=>{const t=(pe-1)*Ie;return ke.slice(t,t+Ie)},[ke,pe,Ie]),$r=s.useMemo(()=>{let t=[...ct];if(gt){const r=gt.toLowerCase();t=t.filter(n=>(n.title?.ar||"").toLowerCase().includes(r)||(n.title?.en||"").toLowerCase().includes(r))}return t.sort((r,n)=>{switch($t){case"title_ar":return(r.title?.ar||"").localeCompare(n.title?.ar||"");case"title_en":return(r.title?.en||"").localeCompare(n.title?.en||"");case"sort_desc":return(n.sort||0)-(r.sort||0);case"sort_asc":default:return(r.sort||0)-(n.sort||0)}}),t},[ct,gt,$t]);s.useMemo(()=>{let t=[...Nt];if(Ut){const r=Ut.toLowerCase();t=t.filter(n=>(n.title?.ar||"").toLowerCase().includes(r)||(n.title?.en||"").toLowerCase().includes(r)||(n.location||"").toLowerCase().includes(r))}return t.sort((r,n)=>{switch(Nr){case"location":return(r.location||"").localeCompare(n.location||"");case"sort_desc":return(n.sort||0)-(r.sort||0);case"sort_asc":default:return(r.sort||0)-(n.sort||0)}}),t},[Nt,Ut,Nr]);const qr=s.useMemo(()=>{let t=[...Wt];if(mt){const r=mt.toLowerCase();t=t.filter(n=>(n.platform||"").toLowerCase().includes(r)||(n.url||"").toLowerCase().includes(r))}return t.sort((r,n)=>{switch(qt){case"platform_desc":return(n.platform||"").localeCompare(r.platform||"");case"platform_asc":default:return(r.platform||"").localeCompare(n.platform||"")}}),t},[Wt,mt,qt]),Vr=()=>{O({id:null,nameAr:"",nameEn:"",price:"",stock:"",status:"active",category:"general",oldPrice:"",image:""}),Ge(null),un({id:null,name:"",role:"user",active:!0}),pn({id:null,total:"",status:"pending",customer:"",items:1})},Kt=async()=>{if(D?.setting){Se(D.setting);return}le(!0),oe(null);try{const r=await(await fetch("/api/settings")).json().catch(()=>null);r?.setting&&Se(r.setting)}catch(t){oe(t.message)}finally{le(!1)}},Qn=async t=>{t?.preventDefault?.(),le(!0),oe(null);try{const r=Object.fromEntries(Object.entries(w).filter(([n,a])=>a!=null&&a!==""));if(Object.keys(r).length===0){oe("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø­Ù‚Ù„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸."),le(!1);return}if(D?.update){const n=await D.update(r);n?.setting&&Se(n.setting)}else{const n=await fetch("/api/settings",{method:"PATCH",headers:{...ue(),"Content-Type":"application/json"},body:JSON.stringify(r)}),a=await n.json().catch(()=>null);if(!n.ok)throw new Error(a?.message||"ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª");a?.setting&&Se(a.setting)}alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª")}catch(r){oe(r.message)}finally{le(!1)}},Gn=async t=>{t.preventDefault();const r=ge==="file"&&!!J;let n;r?(n=new FormData,n.append("nameAr",u.nameAr||u.nameEn||"Ù…Ù†ØªØ¬"),n.append("nameEn",u.nameEn||u.nameAr||"Product"),n.append("price",u.price||"0"),n.append("stock",u.stock||"0"),n.append("status",u.status||"active"),u.slug&&n.append("slug",u.slug),n.append("category",u.category||"general"),u.oldPrice&&n.append("oldPrice",u.oldPrice),J&&n.append("image",J)):n={name:{ar:u.nameAr||u.nameEn||"Ù…Ù†ØªØ¬",en:u.nameEn||u.nameAr||"Product"},price:+u.price,stock:+u.stock,status:u.status,slug:u.slug,category:u.category||"general",oldPrice:u.oldPrice?+u.oldPrice:void 0,image:u.image||void 0};try{if(M(!0),!u.id&&o){const a=v=>(v||"").toString().trim().toLowerCase(),i=a(u.nameAr||""),p=a(u.nameEn||""),I=a(u.slug||"");if(P.find(v=>{const ze=a(v.name?.ar||v.nameAr||""),es=a(v.name?.en||v.nameEn||""),ts=a(v.slug||"");return i&&ze===i||p&&es===p||I&&ts===I})){const v="Ø§Ù„Ù…Ù†ØªØ¬ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ (Ø§Ø³Ù… Ø£Ùˆ Ù…Ø¹Ø±Ù Ù…ÙƒØ±Ø±)";Le(v);try{window.dispatchEvent(new CustomEvent("toast:show",{detail:{type:"warn",title:"ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬",description:v}}))}catch{}M(!1);return}}if(u.id&&o){const a=r?await g.updateProductForm(u.id,n):await g.updateProduct(u.id,n);d(i=>i.map(p=>p.id===a.id?a:p)),me(i=>[{ts:Date.now(),action:"update_product",id:a.id},...i].slice(0,200))}else if(o){const a=r?await g.createProductForm(n):await g.createProduct(n);d(i=>[a,...i]),me(i=>[{ts:Date.now(),action:"create_product",id:a.id},...i].slice(0,200))}else u.id?(z(u.id,n),me(a=>[{ts:Date.now(),action:"update_product_local",id:u.id},...a].slice(0,200))):(c(n),me(a=>[{ts:Date.now(),action:"create_product_local"},...a].slice(0,200)));Vr()}catch(a){const i=a?.message||"";let p=i;if(a?.code==="DUPLICATE_PRODUCT"||i.includes("SLUG_EXISTS")||i.includes("DUPLICATE_PRODUCT")){p="Ø§Ù„Ù…Ù†ØªØ¬ Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ (Slug/SKU/Ø§Ù„Ø§Ø³Ù…)";try{window.dispatchEvent(new CustomEvent("toast:show",{detail:{type:"warn",title:"ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬",description:p}}))}catch{}}i.includes("UNSUPPORTED_FILE_TYPE")?p="ØµÙŠØºØ© ØµÙˆØ±Ø© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø©. Ø§Ù„Ù…Ø³Ù…ÙˆØ­: JPG/PNG/WEBP":i.includes("FILE_TOO_LARGE")?p="Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ø­Ø¯ (4MB)":i.includes("UPLOAD_ERROR")?p="ÙØ´Ù„ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©. Ø¬Ø±Ù‘Ø¨ Ù…Ù„ÙØ§Ù‹ Ø¢Ø®Ø±":i.includes("FORBIDDEN")&&(p='ØªØ­ØªØ§Ø¬ ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø¯ÙŠØ±. Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± "ØªØ³Ø¬ÙŠÙ„ Ù…Ø¯ÙŠØ± (dev)" Ø£Ùˆ Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø¯ÙŠØ±.'),Le(p)}finally{M(!1)}},Ee=({label:t,value:r,deltaPct:n})=>{const a=typeof n=="number"?n:null,i=a!=null?a>=0:null;return e.jsxs("div",{style:bt,children:[e.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:8},children:[e.jsx("div",{style:Gr,children:r}),a!=null&&e.jsxs("span",{style:{fontSize:".7rem",fontWeight:800,padding:".15rem .4rem",borderRadius:999,lineHeight:1,background:i?"rgba(var(--color-primary-rgb),0.12)":"rgba(220,38,38,0.08)",color:i?"var(--color-primary)":"#991b1b",border:i?"1px solid rgba(var(--color-primary-rgb),0.28)":"1px solid rgba(220,38,38,0.25)"},"aria-label":i?"Ø²ÙŠØ§Ø¯Ø©":"Ø§Ù†Ø®ÙØ§Ø¶",children:[i?"â†‘":"â†“"," ",Math.abs(a).toFixed(0),"%"]})]}),e.jsx("div",{style:Jr,children:t})]})};s.useEffect(()=>{let t=!0;return(async()=>{M(!0),Le(null);try{const r=await g.listProducts();t&&Array.isArray(r)&&(d(r),k(!0))}catch(r){t&&(Le(r.message),k(!1))}finally{t&&M(!1)}})(),()=>{t=!1}},[]),s.useEffect(()=>{if(h!=="products")return;let t=!0;const r="admin_cat_cache_v1",n=300*1e3,a=Date.now();try{const i=localStorage.getItem(r);if(i){const p=JSON.parse(i);p?.expires>a&&Array.isArray(p.data)&&_t(p.data)}}catch{}return nt(!0),it(null),g.listCategories({withCounts:1}).then(i=>{const p=Array.isArray(i?.categories)?i.categories:[],I=new Map;for(const v of p)v?.slug&&!I.has(v.slug)&&I.set(v.slug,v);const Yt=Array.from(I.values()).sort((v,ze)=>(ze.productCount||0)-(v.productCount||0)||String(v.name?.ar||v.name?.en||v.slug).localeCompare(String(ze.name?.ar||ze.name?.en||ze.slug),"ar"));t&&_t(Yt);try{localStorage.setItem(r,JSON.stringify({data:Yt,expires:a+n}))}catch{}}).catch(i=>{t&&it(i.message||"ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª")}).finally(()=>{t&&nt(!1)}),()=>{t=!1}},[h]);const Hr=s.useMemo(()=>rt.map(t=>({value:t.slug,label:E(t.name,m)||t.name?.ar||t.name?.en||t.slug})),[rt,m]);s.useEffect(()=>{let t=!0;return(async()=>{if(["users","overview","audit"].includes(h)){nr(!0),sr(null);try{const r=[];(h==="users"||h==="overview")&&r.push(he.listUsers().catch(i=>({error:i}))),h==="audit"&&r.push(he.listAudit({page:se}).catch(i=>({error:i}))),h==="overview"&&r.push(he.statsOverview().catch(i=>({error:i})));const n=await Promise.all(r);let a=0;if(h==="users"||h==="overview"){const i=n[a++];!i?.error&&i?.users&&Zr(i.users)}if(h==="audit"){const i=n[a++];!i?.error&&i?.logs&&(en(i.logs),tn(i.totalPages||1))}if(h==="overview"){const i=n[n.length-1];!i?.error&&i?.stats&&sn(i.stats)}}catch(r){t&&sr(r.message)}finally{t&&nr(!1)}}})(),()=>{t=!1}},[h,se,rn]);const Jn=()=>{nn(t=>t+1)};s.useEffect(()=>{if(h!=="overview")return;let t=!0;return(async()=>{or(!0),dr(null);try{const[r,n]=await Promise.all([he.statsFinancials({days:Pt}),he.listOrders({page:1,pageSize:10})]);if(!t)return;r?.daily&&ln(r),Array.isArray(n?.orders)&&on(n.orders)}catch(r){t&&dr(r.message)}finally{t&&or(!1)}})(),()=>{t=!1}},[h,Pt]);const Xn=s.useMemo(()=>{try{const t=L?.daily||[];if(!Array.isArray(t)||t.length<2)return null;const r=t[t.length-1]?.revenue??null,n=t[t.length-2]?.revenue??null;return typeof r!="number"||typeof n!="number"||n===0?null:(r-n)/Math.abs(n)*100}catch{return null}},[L]),Kn=s.useMemo(()=>{try{const t=L?.daily||[];if(!Array.isArray(t)||t.length<2)return null;const r=t[t.length-1]?.orders??null,n=t[t.length-2]?.orders??null;return typeof r!="number"||typeof n!="number"||n===0?null:(r-n)/Math.abs(n)*100}catch{return null}},[L]),Yn=s.useMemo(()=>{try{const t=L?.daily||[];if(!Array.isArray(t)||t.length<2)return null;const r=t[t.length-1]?.aov??null,n=t[t.length-2]?.aov??null;return typeof r!="number"||typeof n!="number"||n===0?null:(r-n)/Math.abs(n)*100}catch{return null}},[L]),Zn=async()=>{Tr(!0),Rr(null);try{const t=await g.listOffers();zn(Array.isArray(t)?t:[])}catch(t){Rr(t.message)}finally{Tr(!1)}};s.useEffect(()=>{h==="offers"&&!Bt.length&&Zn()},[h]),s.useEffect(()=>{if(h!=="offers"||rt.length)return;let t=!0;return nt(!0),it(null),g.listCategories({withCounts:1}).then(r=>{const n=Array.isArray(r?.categories)?r.categories:[],a=new Map;for(const p of n)p?.slug&&!a.has(p.slug)&&a.set(p.slug,p);const i=Array.from(a.values()).sort((p,I)=>(I.productCount||0)-(p.productCount||0)||String(p.name?.ar||p.name?.en||p.slug).localeCompare(String(I.name?.ar||I.name?.en||I.slug),"ar"));t&&_t(i)}).catch(r=>{t&&it(r.message||"ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª")}).finally(()=>{t&&nt(!1)}),()=>{t=!1}},[h,rt.length]),s.useMemo(()=>{let t=[...Bt];const r=(Dr||"").toLowerCase();switch(r&&(t=t.filter(n=>((E(n.name,m)||n.name?.ar||n.name?.en||"")+"").toLowerCase().includes(r))),Mr&&(t=t.filter(n=>(n.category||"")===Mr)),_r){case"discount_desc":t.sort((n,a)=>(n.originalPrice||n.oldPrice||0)-(n.price||0)<(a.originalPrice||a.oldPrice||0)-(a.price||0)?1:-1);break;case"price_asc":t.sort((n,a)=>(n.price||0)-(a.price||0));break;case"price_desc":t.sort((n,a)=>(a.price||0)-(n.price||0));break;case"recent":default:t.sort((n,a)=>String(a.updatedAt||a.id).localeCompare(String(n.updatedAt||n.id)))}return t},[Bt,Dr,_r]),s.useEffect(()=>{h==="offers"&&(P.length||(async()=>{try{const t=await g.listProducts();Array.isArray(t)&&(d(t),k(!0))}catch{}})())},[h,P.length]);const Qr=s.useMemo(()=>{const t=(pt||"").toLowerCase();return(o?P:N).filter(r=>!r.oldPrice&&r.price>0).filter(r=>t?(E(r.name,m)||r.name?.ar||r.name?.en||r.name||"").toLowerCase().includes(t):!0).slice(0,300)},[o,P,N,pt,m]);return s.useMemo(()=>{const t=(pt||"").toLowerCase();let r=(o?P:N).filter(n=>(n.price||0)>0);return Or||(r=r.filter(n=>!n.oldPrice)),t&&(r=r.filter(n=>(E(n.name,m)||n.name?.ar||n.name?.en||n.name||"").toLowerCase().includes(t))),r.slice(0,300)},[o,P,N,pt,Or,m]),s.useMemo(()=>Qr.find(t=>t.id===ht.productId)||(o?P.find(t=>t.id===ht.productId):N.find(t=>t.id===ht.productId)),[Qr,ht.productId,o,P,N]),b?e.jsxs("div",{className:"admin-root",style:us,dir:m==="ar"?"rtl":"ltr",children:[e.jsx(os,{title:Gt,description:m==="ar"?"Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©":"Admin control panel"}),e.jsxs("div",{className:"admin-two-col",children:[e.jsx(cs,{}),e.jsxs("div",{children:[e.jsx("div",{className:"admin-subbar",children:e.jsx("div",{className:"admin-subbar-title",children:{overview:"Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©",offers:"Ø§Ù„Ø¹Ø±ÙˆØ¶",products:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",users:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†",orders:"Ø§Ù„Ø·Ù„Ø¨Ø§Øª",audit:"Ø§Ù„Ø³Ø¬Ù„Ø§Øª",brands:"Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª",marketing:"Ø§Ù„ØªØ³ÙˆÙŠÙ‚",settings:"Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",reviews:"Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø§Øª",cats:"Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"}[h]||"Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…"})}),h==="ads"&&e.jsx(Ue.Suspense,{fallback:e.jsx("div",{style:{padding:24},children:"ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª..."}),children:e.jsx(ds,{})}),h==="overview"&&e.jsxs("div",{className:"admin-stat-grid",children:[He?e.jsx(e.Fragment,{children:Array.from({length:6}).map((t,r)=>e.jsx("div",{className:"skeleton",style:{height:96}},r))}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{label:"Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…",value:Je.todayOrders,deltaPct:Kn}),e.jsx(Ee,{label:"Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„ÙŠÙˆÙ…",value:Je.todayRevenue.toFixed(2),deltaPct:Xn}),e.jsx(Ee,{label:"Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ù„Ø© (Ø§Ù„ÙŠÙˆÙ…)",value:Je.avgOrderValueToday.toFixed(2),deltaPct:Yn}),e.jsxs("div",{style:bt,children:[e.jsx("div",{style:Gr,children:Je.pendingBankCount}),e.jsx("div",{style:Jr,children:"ØªØ­ÙˆÙŠÙ„Ø§Øª Ø¨Ù†ÙƒÙŠØ© Ù…Ø¹Ù„Ù‚Ø©"}),e.jsx("div",{style:{marginTop:6},children:e.jsx("a",{href:"/admin/bank-transfers",style:{fontSize:".7rem",textDecoration:"none",color:"var(--color-primary)"},children:"Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¢Ù† â†’"})})]}),e.jsx(Ee,{label:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",value:N.length}),e.jsx(Ee,{label:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†",value:zt.length||Z.length}),e.jsx(Ee,{label:"ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Ù…Ø­Ù„ÙŠ)",value:F.length})]}),e.jsxs("div",{style:{...bt,gridColumn:"1/-1"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontWeight:700},children:"Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø§Ù„ÙŠ"}),e.jsx("div",{children:e.jsx("select",{value:Pt,onChange:t=>an(+t.target.value),style:j,children:[7,14,30,60].map(t=>e.jsxs("option",{value:t,children:[t," ÙŠÙˆÙ…"]},t))})})]}),lr&&e.jsxs("div",{children:[e.jsx("div",{className:"skeleton",style:{height:18,width:"45%",marginBottom:10}}),e.jsx("div",{className:"skeleton",style:{height:120,width:"100%"}})]}),cr&&e.jsxs("div",{style:{fontSize:".7rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",cr]}),L&&e.jsxs("div",{style:{display:"grid",gap:"10px"},children:[e.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[e.jsxs("div",{style:St,children:[e.jsx("div",{style:wt,children:Number(L.totals?.totalRevenue||0).toFixed(2)}),e.jsx("div",{style:Ct,children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯"})]}),e.jsxs("div",{style:St,children:[e.jsx("div",{style:wt,children:L.totals?.totalOrders||0}),e.jsx("div",{style:Ct,children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª"})]}),e.jsxs("div",{style:St,children:[e.jsx("div",{style:wt,children:Number(L.totals?.overallAov||0).toFixed(2)}),e.jsx("div",{style:Ct,children:"Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ù„Ø©"})]}),e.jsxs("div",{style:St,children:[e.jsx("div",{style:wt,children:L.totals?.activeCustomersWindow||0}),e.jsx("div",{style:Ct,children:"Ø¹Ù…Ù„Ø§Ø¡ Ù†Ø´Ø·ÙˆÙ†"})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${L.daily.length}, minmax(2px,1fr))`,gap:2,alignItems:"end",height:120,background:"var(--color-bg-alt)",border:"1px solid var(--color-border-soft)",borderRadius:10,padding:6},"aria-label":"Ù…Ø®Ø·Ø· Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª",children:(()=>{const t=Math.max(1,...L.daily.map(r=>r.revenue||0));return L.daily.map(r=>{const n=Math.round((r.revenue||0)/t*100);return e.jsx("div",{title:`${r.date} â€¢ ${Number(r.revenue||0).toFixed(2)}`,style:{height:`${n}%`,background:"linear-gradient(180deg, var(--color-primary), var(--color-gold))",borderRadius:3}},r.date)})})()})]})]}),e.jsxs("div",{style:{...bt,gridColumn:"1/-1"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontWeight:700},children:"Ø£Ø­Ø¯Ø« 10 Ø·Ù„Ø¨Ø§Øª"}),e.jsx("a",{href:"/admin/reports",style:{fontSize:".7rem",textDecoration:"none",color:"var(--color-primary)"},children:"Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± â†’"})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{...q,marginTop:8},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx("th",{children:"Ø§Ù„Ø­Ø§Ù„Ø©"}),e.jsx("th",{children:"Ø·Ø±ÙŠÙ‚Ø©"}),e.jsx("th",{children:"Ø§Ù„ÙˆÙ‚Øª"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[ur.map(t=>e.jsxs("tr",{children:[e.jsx("td",{style:{maxWidth:160,overflow:"hidden",textOverflow:"ellipsis"},children:t.id}),e.jsxs("td",{children:[t.grandTotal?.toFixed?t.grandTotal.toFixed(2):t.grandTotal," ",t.currency]}),e.jsx("td",{children:e.jsx("span",{style:gs(t.status),children:t.status})}),e.jsx("td",{children:t.paymentMethod||"-"}),e.jsx("td",{children:new Date(t.createdAt).toLocaleString()}),e.jsxs("td",{style:Y,children:[e.jsx("a",{href:`/order/${t.id}`,style:{fontSize:".65rem",textDecoration:"none",color:"var(--color-primary)"},children:"Ø¹Ø±Ø¶"}),e.jsx("a",{href:`/api/orders/${t.id}/invoice`,target:"_blank",rel:"noopener",style:{fontSize:".65rem",textDecoration:"none",color:"#075985"},children:"ÙØ§ØªÙˆØ±Ø©"})]})]},t.id)),!ur.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:V,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª"})})]})]})})]}),e.jsxs("div",{style:{gridColumn:"1/-1"},children:[e.jsx("h3",{style:ne,children:"Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·"}),e.jsxs("ul",{style:{listStyle:"none",margin:0,padding:0,maxHeight:200,overflow:"auto",fontSize:".65rem",direction:"ltr"},children:[pr.slice(0,12).map(t=>e.jsxs("li",{children:[new Date(t.ts).toLocaleTimeString()," - ",t.action," ",t.id||""]},t.ts+""+t.action)),!pr.length&&e.jsx("li",{children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø· Ø¨Ø¹Ø¯."})]}),He&&e.jsx("div",{style:{fontSize:".6rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),Qe&&e.jsxs("div",{style:{fontSize:".6rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",Qe]})]})]}),h==="products"&&e.jsxs("div",{style:re,children:[e.jsxs("form",{onSubmit:Gn,style:$e,children:[e.jsx("h3",{style:ne,children:u.id?"ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†ØªØ¬":"Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬"}),e.jsxs("div",{style:qe,children:[e.jsx("input",{placeholder:"Ø§Ù„Ø§Ø³Ù… (AR)",value:u.nameAr,onChange:t=>O(r=>({...r,nameAr:t.target.value}))}),e.jsx("input",{placeholder:"Name (EN)",value:u.nameEn,onChange:t=>O(r=>({...r,nameEn:t.target.value}))}),e.jsx("input",{type:"number",placeholder:"Ø§Ù„Ø³Ø¹Ø±",required:!0,value:u.price,onChange:t=>O(r=>({...r,price:t.target.value}))}),e.jsx("input",{type:"number",placeholder:"Ø§Ù„Ù…Ø®Ø²ÙˆÙ†",required:!0,value:u.stock,onChange:t=>O(r=>({...r,stock:t.target.value}))}),e.jsx("input",{placeholder:"Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚",type:"number",value:u.oldPrice,onChange:t=>O(r=>({...r,oldPrice:t.target.value}))}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsxs("select",{value:u.category,onChange:t=>O(r=>({...r,category:t.target.value})),children:[e.jsx("option",{value:"",children:"Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ"}),Hr.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),Cr&&e.jsx("span",{style:{fontSize:".6rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"}),st&&e.jsxs("span",{style:{fontSize:".6rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",st]})]}),e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[e.jsx("div",{style:{fontSize:".7rem",fontWeight:600},children:"ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬:"}),e.jsxs("div",{style:{display:"inline-flex",background:"#f1f5f9",borderRadius:8,overflow:"hidden"},children:[e.jsx(l,{size:"sm",variant:ge==="file"?"primary":"outline",type:"button",onClick:()=>{ir("file"),O(t=>({...t,image:""}))},style:{borderTopRightRadius:8,borderBottomRightRadius:8},children:"Ø±ÙØ¹ Ù…Ù„Ù"}),e.jsx(l,{size:"sm",variant:ge==="url"?"primary":"outline",type:"button",onClick:()=>{ir("url"),Ge(null)},style:{borderTopLeftRadius:8,borderBottomLeftRadius:8},children:"Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø©"})]})]}),ge==="file"&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("input",{ref:ar,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:t=>{const r=t.target.files?.[0];Ge(r||null)},style:{display:"none"}}),e.jsx(l,{type:"button",variant:"primary",onClick:()=>ar.current?.click(),children:"Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ"}),J&&e.jsx("span",{style:{fontSize:".65rem",color:"#475569"},children:J.name})]}),e.jsx("div",{style:{fontSize:".6rem",color:"#64748b"},children:"Ø§Ù„Ù…Ø³Ù…ÙˆØ­: JPG/PNG/WEBP Â· Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 4MB"}),ge==="url"&&e.jsx("input",{placeholder:"Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (https://...)",value:u.image,onChange:t=>O(r=>({...r,image:t.target.value}))}),(J||u.id||u.image)&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-start"},children:[e.jsx("span",{style:{fontSize:".55rem",opacity:.7},children:"Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©"}),e.jsx("img",{alt:"preview",src:J?URL.createObjectURL(J):u.image||P.find(t=>t.id===u.id)?.imageVariants?.thumb||P.find(t=>t.id===u.id)?.image||"/vite.svg",style:{width:90,height:90,objectFit:"cover",borderRadius:8,border:"1px solid #e2e8f0"}}),J&&e.jsx(l,{type:"button",size:"sm",variant:"ghost",onClick:()=>Ge(null),children:"Ø¥Ø²Ø§Ù„Ø©"})]}),e.jsxs("select",{value:u.status,onChange:t=>O(r=>({...r,status:t.target.value})),children:[e.jsx("option",{value:"active",children:"Ù†Ø´Ø·"}),e.jsx("option",{value:"draft",children:"Ù…Ø³ÙˆØ¯Ø©"}),e.jsx("option",{value:"archived",children:"Ù…Ø¤Ø±Ø´Ù"})]})]}),e.jsxs("div",{style:Ve,children:[e.jsxs(l,{type:"submit",variant:"primary",children:[e.jsx(ft,{size:16})," ",u.id?"Ø­ÙØ¸":"Ø¥Ø¶Ø§ÙØ©"]}),u.id&&e.jsxs(l,{type:"button",variant:"ghost",onClick:Vr,children:[e.jsx(jt,{size:16})," Ø¥Ù„ØºØ§Ø¡"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:".75rem",flexWrap:"wrap"},children:[e.jsxs("select",{value:Lt,onChange:t=>cn(t.target.value),style:j,children:[e.jsx("option",{value:"created_desc",children:"Ø§Ù„Ø£Ø­Ø¯Ø«"}),e.jsx("option",{value:"created_asc",children:"Ø§Ù„Ø£Ù‚Ø¯Ù…"}),e.jsx("option",{value:"price_desc",children:"Ø§Ù„Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø±Ø§Ù‹"}),e.jsx("option",{value:"price_asc",children:"Ø§Ù„Ø£Ù‚Ù„ Ø³Ø¹Ø±Ø§Ù‹"}),e.jsx("option",{value:"stock_desc",children:"Ø£Ø¹Ù„Ù‰ Ù…Ø®Ø²ÙˆÙ†"}),e.jsx("option",{value:"stock_asc",children:"Ø£Ù‚Ù„ Ù…Ø®Ø²ÙˆÙ†"})]}),e.jsxs("select",{value:Xe,onChange:t=>dn(t.target.value),style:j,children:[e.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"}),Hr.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),Cr&&e.jsx("span",{style:{fontSize:".65rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"}),st&&e.jsxs("span",{style:{fontSize:".65rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",st]})]}),e.jsxs("table",{style:q,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„Ø§Ø³Ù…"}),e.jsx("th",{children:"Ø§Ù„ØªØµÙ†ÙŠÙ"}),e.jsx("th",{children:"Ø§Ù„Ø³Ø¹Ø±"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø®Ø²ÙˆÙ†"}),e.jsx("th",{children:"Ø§Ù„Ø­Ø§Ù„Ø©"}),e.jsx("th",{children:"Ø´Ø±Ø§Ø¦Ø­"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[mn.map(t=>{const r=W===t.id,n=gr[t.id]||[],a=n.length?n[0]:null;return e.jsxs(Ue.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{children:E(t.name,m)||t.name?.ar||t.name?.en||t.name}),e.jsx("td",{children:t.category}),e.jsx("td",{children:t.price}),e.jsx("td",{style:t.stock<5?{color:"#b91c1c",fontWeight:600}:{},children:t.stock}),e.jsx("td",{children:t.status}),e.jsxs("td",{children:[e.jsx(l,{size:"sm",variant:r?"primary":"outline",onClick:()=>fn(t.id),children:r?"Ø¥Ø®ÙØ§Ø¡":"Ø¥Ø¯Ø§Ø±Ø©"}),n.length>0&&e.jsxs("div",{style:{fontSize:".55rem",marginTop:4,opacity:.7},children:[n.length," Ø´Ø±ÙŠØ­Ø©",a?` (Ù…Ù† ${a.price})`:""]})]}),e.jsxs("td",{style:Y,children:[e.jsx(l,{onClick:()=>O({id:t.id,nameAr:t.name?.ar||"",nameEn:t.name?.en||"",price:t.price,stock:t.stock,status:t.status,category:t.category||"general",oldPrice:t.oldPrice||"",image:t.image||""}),title:"ØªØ¹Ø¯ÙŠÙ„",variant:"ghost",size:"sm",children:e.jsx(Ne,{size:16})}),e.jsx(l,{onClick:async()=>{if(o)try{await g.deleteProduct(t.id),d(i=>i.filter(p=>p.id!==t.id)),me(i=>[{ts:Date.now(),action:"delete_product",id:t.id},...i].slice(0,200))}catch(i){Le(i.message)}else f(t.id),me(i=>[{ts:Date.now(),action:"delete_product_local",id:t.id},...i].slice(0,200))},title:"Ø­Ø°Ù",variant:"danger",size:"sm",children:e.jsx(vt,{size:16})})]})]}),r&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{background:"#f8fafc",padding:"1rem .75rem"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:".75rem"},children:[e.jsxs("form",{onSubmit:jn,style:{display:"flex",flexWrap:"wrap",gap:6,alignItems:"flex-end"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("label",{style:We,children:"Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰"}),e.jsx("input",{required:!0,type:"number",value:S.minQty,onChange:i=>X(p=>({...p,minQty:i.target.value})),style:Be})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("label",{style:We,children:"Ø§Ù„Ø³Ø¹Ø±"}),e.jsx("input",{required:!0,type:"number",step:"0.01",value:S.price,onChange:i=>X(p=>({...p,price:i.target.value})),style:Be})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("label",{style:We,children:"Ø§Ù„ØªØºÙ„ÙŠÙ"}),e.jsx("select",{value:S.packagingType,onChange:i=>X(p=>({...p,packagingType:i.target.value})),style:Be,children:xn.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("label",{style:We,children:"Ù…Ù„Ø§Ø­Ø¸Ø© AR"}),e.jsx("input",{value:S.noteAr,onChange:i=>X(p=>({...p,noteAr:i.target.value})),style:Be})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("label",{style:We,children:"Note EN"}),e.jsx("input",{value:S.noteEn,onChange:i=>X(p=>({...p,noteEn:i.target.value})),style:Be})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx(l,{type:"submit",size:"sm",variant:"primary",children:S.id?"ØªØ­Ø¯ÙŠØ«":"Ø¥Ø¶Ø§ÙØ©"}),S.id&&e.jsx(l,{type:"button",size:"sm",variant:"ghost",onClick:()=>X(Ze),children:"Ø¥Ù„ØºØ§Ø¡"})]})]}),e.jsxs("div",{style:{overflowX:"auto"},children:[e.jsxs("table",{style:{...q,boxShadow:"none",margin:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"MinQty"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Packaging"}),e.jsx("th",{children:"Note"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[n.map(i=>e.jsxs("tr",{children:[e.jsx("td",{children:i.minQty}),e.jsx("td",{children:i.price}),e.jsx("td",{children:i.packagingType}),e.jsx("td",{style:{fontSize:".6rem"},children:E(i.note,m)||i.note?.ar||i.note?.en||"â€”"}),e.jsxs("td",{style:Y,children:[e.jsx(l,{variant:"ghost",size:"sm",title:"ØªØ¹Ø¯ÙŠÙ„",onClick:()=>vn(i),children:e.jsx(Ne,{size:14})}),e.jsx(l,{variant:"danger",size:"sm",title:"Ø­Ø°Ù",onClick:()=>bn(i),children:"âœ•"})]})]},i.id)),!n.length&&!mr&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:V,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ø±Ø§Ø¦Ø­"})})]})]}),mr&&e.jsx("div",{style:{fontSize:".6rem",marginTop:4},children:"...ØªØ­Ù…ÙŠÙ„"}),xr&&e.jsxs("div",{style:{fontSize:".6rem",color:"#b91c1c",marginTop:4},children:["Ø®Ø·Ø£: ",xr]})]})]})})})]},t.id)}),!xe.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:V,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬"})})]})]}),xe.length>0&&e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginTop:8},children:[e.jsx(l,{variant:ie===1?"ghost":"primary",disabled:ie===1,onClick:()=>Ft(t=>Math.max(1,t-1)),children:"Ø§Ù„Ø³Ø§Ø¨Ù‚"}),e.jsxs("span",{style:{fontSize:".65rem"},children:["ØµÙØ­Ø© ",ie," / ",Ke]}),e.jsx(l,{variant:ie===Ke?"ghost":"primary",disabled:ie===Ke,onClick:()=>Ft(t=>Math.min(Ke,t+1)),children:"Ø§Ù„ØªØ§Ù„ÙŠ"}),e.jsx("span",{style:{marginInlineStart:10,fontSize:".65rem"},children:"Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ:"}),e.jsx("select",{value:Te,onChange:t=>{gn(+t.target.value),Ft(1)},style:j,children:[10,20,30,50,100].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("span",{style:{fontSize:".65rem",opacity:.7},children:[xe.length," Ø¹Ù†ØµØ±"]})]}),_&&e.jsx("div",{style:{fontSize:".7rem",opacity:.7},children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸..."}),er&&e.jsxs("div",{style:{fontSize:".7rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",er]})]}),h==="orders"&&e.jsxs("div",{style:re,children:[e.jsx("h3",{style:ne,children:"Ø§Ù„Ø·Ù„Ø¨Ø§Øª (ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ / Ø¹Ø§Ù…)"}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:12},children:[e.jsxs("select",{value:fe,onChange:t=>yr(t.target.value),style:j,children:[e.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª"}),["pending","processing","pending_bank_review","paid","shipped","completed","cancelled"].map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:je,onChange:t=>fr(t.target.value),style:j,children:[e.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„Ø·Ø±Ù‚"}),["paypal","bank","cod","stc"].map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("input",{type:"date",value:ve,onChange:t=>jr(t.target.value),style:j}),e.jsx("input",{type:"date",value:be,onChange:t=>vr(t.target.value),style:j}),e.jsx(l,{variant:"primary",type:"button",onClick:()=>{yr(""),fr(""),jr(""),vr("")},children:"Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±"}),e.jsx(l,{variant:"primary",type:"button",onClick:async()=>{try{const t=await he.exportOrdersCsv({status:fe,paymentMethod:je,from:ve,to:be}),r=new Blob([t],{type:"text/csv;charset=utf-8"}),n=URL.createObjectURL(r),a=document.createElement("a");a.href=n,a.download="orders.csv",a.click(),URL.revokeObjectURL(n)}catch(t){alert("ÙØ´Ù„ ØªØµØ¯ÙŠØ± CSV: "+t.message)}},children:"ØªØµØ¯ÙŠØ± CSV"}),e.jsx(l,{variant:"primary",type:"button",onClick:async()=>{try{const t=await he.exportOrdersXlsx({status:fe,paymentMethod:je,from:ve,to:be}),r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download="orders.xlsx",n.click(),URL.revokeObjectURL(r)}catch(t){alert("ÙØ´Ù„ ØªØµØ¯ÙŠØ± Excel: "+t.message)}},children:"ØªØµØ¯ÙŠØ± Excel"})]}),e.jsxs("table",{style:q,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"}),e.jsx("th",{children:"Ø§Ù„Ø­Ø§Ù„Ø©"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø¨Ù„Øº"}),e.jsx("th",{children:"Ø·Ø±ÙŠÙ‚Ø©"}),e.jsx("th",{children:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"}),e.jsx("th",{children:"Ù…Ø±Ø¬Ø¹"}),e.jsx("th",{children:"Ø¥ÙŠØµØ§Ù„"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[Mn.map(t=>{const r=t.paymentMeta?.bank||{},n=t.paymentMeta?.address||{},a=[n.country,n.city,n.area].filter(Boolean).join(" - ")+(n.line1?`
${n.line1}`:"")+(n.phone?`
ğŸ“ ${n.phone}`:"");return e.jsxs(Ue.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis"},children:t.id}),e.jsx("td",{children:t.userId}),e.jsx("td",{children:t.status}),e.jsxs("td",{children:[t.grandTotal?.toFixed?t.grandTotal.toFixed(2):t.grandTotal," ",t.currency]}),e.jsx("td",{children:t.paymentMethod||"-"}),e.jsxs("td",{title:a||"-",style:{fontSize:".6rem",maxWidth:180,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[n.city||n.area||n.line1?e.jsxs("span",{children:[n.city||n.area?`${n.city||""}${n.city&&n.area?" - ":""}${n.area||""}`:n.line1||"",(n.city||n.area)&&n.line1?`, ${n.line1}`:"",n.phone?` Â· ${n.phone}`:""]}):"â€”",(n.city||n.area||n.line1)&&e.jsx(l,{type:"button",size:"sm",variant:"ghost",title:"Ù†Ø³Ø® Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",onClick:()=>{try{navigator.clipboard.writeText(a)}catch{}},style:{width:22,height:22,marginInlineStart:6,padding:0},children:"ğŸ“‹"})]}),e.jsx("td",{children:r.reference||"-"}),e.jsx("td",{children:r.receiptUrl?e.jsx("a",{href:r.receiptUrl,target:"_blank",rel:"noopener",style:{fontSize:".6rem",color:"#075985"},children:"Ø¹Ø±Ø¶"}):"-"}),e.jsxs("td",{style:Y,children:[t.paymentMethod==="bank"&&t.status==="pending_bank_review"&&e.jsx(l,{size:"sm",variant:"primary",onClick:async()=>{try{const i=r.reference;if(!(await fetch("/api/pay/bank/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:t.id,reference:i})})).ok)throw new Error("ÙØ´Ù„ Ø§Ù„ØªØ£ÙƒÙŠØ¯");await Q()}catch(i){alert(i.message)}},children:"ØªØ£ÙƒÙŠØ¯ Ø¯ÙØ¹"}),(n.city||n.area||n.line1)&&e.jsx(l,{size:"sm",variant:"outline",onClick:()=>Sn(i=>i===t.id?null:t.id),title:Rt===t.id?"Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†":"Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",children:Rt===t.id?"Ø¥Ø®ÙØ§Ø¡":"Ø¹Ø±Ø¶"}),e.jsx("a",{href:`/order/${t.id}`,style:{fontSize:".6rem",textDecoration:"none",color:"#69be3c"},children:"Ø¹Ø±Ø¶"})]})]}),Rt===t.id&&e.jsx("tr",{children:e.jsx("td",{colSpan:9,style:{background:"#f8fafc"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,alignItems:"flex-start",padding:".75rem 1rem"},children:[e.jsxs("div",{style:{fontSize:".7rem",whiteSpace:"pre-wrap",lineHeight:1.8},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:4},children:"Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø­Ù†"}),n.name&&e.jsx("div",{children:n.name}),n.email&&e.jsx("div",{style:{opacity:.8},children:n.email}),e.jsx("div",{children:[n.country,n.city,n.area].filter(Boolean).join(" - ")}),n.line1&&e.jsx("div",{children:n.line1}),n.phone&&e.jsxs("div",{children:["ğŸ“ ",n.phone]})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx(l,{type:"button",size:"sm",variant:"ghost",onClick:()=>{try{navigator.clipboard.writeText(a)}catch{}},children:"Ù†Ø³Ø®"}),(n.line1||n.city||n.country)&&e.jsx(l,{as:"a",href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(`${n.line1||""} ${n.city||""} ${n.country||""}`.trim())}`,target:"_blank",rel:"noopener",size:"sm",variant:"outline",children:"Ø®Ø±Ø§Ø¦Ø·"})]})]})})})]},t.id)}),!F.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,style:V,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª"})})]})]}),Me.length>0&&e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginTop:8},children:[e.jsx(l,{variant:de===1?"ghost":"primary",disabled:de===1,onClick:()=>Ht(t=>Math.max(1,t-1)),children:"Ø§Ù„Ø³Ø§Ø¨Ù‚"}),e.jsxs("span",{style:{fontSize:".65rem"},children:["ØµÙØ­Ø© ",de," / ",xt]}),e.jsx(l,{variant:de===xt?"ghost":"primary",disabled:de===xt,onClick:()=>Ht(t=>Math.min(xt,t+1)),children:"Ø§Ù„ØªØ§Ù„ÙŠ"}),e.jsx("span",{style:{marginInlineStart:10,fontSize:".65rem"},children:"Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ:"}),e.jsx("select",{value:Oe,onChange:t=>{_n(+t.target.value),Ht(1)},style:j,children:[20,50,100,200,500].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("span",{style:{fontSize:".65rem",opacity:.7},children:[Me.length," Ø¹Ù†ØµØ±"]})]})]}),h==="cats"&&e.jsx(ms,{}),h==="audit"&&e.jsxs("div",{style:re,children:[e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[e.jsx("h3",{style:ne,children:"Ø³Ø¬Ù„Ø§Øª Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚"}),e.jsx(l,{type:"button",variant:"primary",onClick:()=>Jn(),children:"ØªØ­Ø¯ÙŠØ«"}),e.jsx("span",{style:{fontSize:".6rem",color:"#475569"},children:He?"...ØªØ­Ù…ÙŠÙ„":""})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:q,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[lr&&e.jsx("tr",{children:e.jsxs("td",{colSpan:6,children:[e.jsx("div",{className:"skeleton",style:{height:36,marginBottom:8}}),e.jsx("div",{className:"skeleton",style:{height:36,marginBottom:8}}),e.jsx("div",{className:"skeleton",style:{height:36}})]})}),e.jsx("th",{children:"Ø§Ù„ÙˆÙ‚Øª"}),e.jsx("th",{children:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡"}),e.jsx("th",{children:"Ø§Ù„ÙƒÙŠØ§Ù†"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø¹Ø±Ù"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"})]})}),e.jsxs("tbody",{children:[tr.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(t.createdAt).toLocaleTimeString()}),e.jsx("td",{children:t.action}),e.jsx("td",{children:t.entity}),e.jsx("td",{children:t.entityId}),e.jsx("td",{children:t.userId||"â€”"})]},t.id)),!tr.length&&!He&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:V,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª"})})]})]})}),Fe>1&&e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[e.jsx(l,{disabled:se===1,variant:se===1?"ghost":"primary",onClick:()=>rr(t=>Math.max(1,t-1)),children:"Ø§Ù„Ø³Ø§Ø¨Ù‚"}),e.jsxs("span",{style:{alignSelf:"center",fontSize:".65rem"},children:["ØµÙØ­Ø© ",se," / ",Fe]}),e.jsx(l,{disabled:se===Fe,variant:se===Fe?"ghost":"primary",onClick:()=>rr(t=>Math.min(Fe,t+1)),children:"Ø§Ù„ØªØ§Ù„ÙŠ"})]}),Qe&&e.jsxs("div",{style:{fontSize:".65rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",Qe]})]}),h==="reviews"&&e.jsx(xs,{}),h==="settings"&&e.jsxs("div",{style:re,children:[e.jsx("h3",{style:ne,children:"Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©"}),et&&e.jsx("div",{style:{fontSize:".7rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),br&&e.jsxs("div",{style:{fontSize:".7rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",br]}),e.jsxs("div",{style:{display:"grid",gap:"1rem"},children:[e.jsxs("div",{style:{background:"#fff",padding:"1rem",borderRadius:12,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)"},children:[e.jsx("h4",{style:{marginTop:0},children:"Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[Dt?.logo?e.jsx("img",{src:Dt.logo,alt:"Site Logo",style:{height:48,objectFit:"contain",border:"1px solid #e5e7eb",borderRadius:8,padding:4,background:"#fff"}}):e.jsx("div",{style:{fontSize:".7rem",opacity:.7},children:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø´Ø¹Ø§Ø± Ø­Ø§Ù„ÙŠØ§Ù‹"}),e.jsx("input",{ref:wr,type:"file",accept:"image/jpeg,image/png,image/webp,image/svg+xml",style:{display:"none"},onChange:t=>Sr(t.target.files?.[0]||null)}),e.jsx(l,{type:"button",as:"button",variant:"outline",onClick:()=>wr.current?.click(),children:"Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ"}),tt&&e.jsx("span",{style:{fontSize:".65rem"},children:tt.name}),e.jsx(l,{type:"button",variant:"primary",disabled:!tt||et,onClick:async()=>{le(!0),oe(null);try{if(D?.uploadLogo){const t=await D.uploadLogo(tt);t&&Se(t),Sr(null),alert("ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø´Ø¹Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­")}}catch(t){oe(t.message)}finally{le(!1)}},children:"Ø±ÙØ¹ Ø§Ù„Ø´Ø¹Ø§Ø±"}),e.jsx(l,{type:"button",variant:"ghost",onClick:Kt,disabled:et,children:"ØªØ­Ø¯ÙŠØ«"})]}),e.jsx("p",{style:ps,children:"Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©: ØµÙˆØ± Ø­ØªÙ‰ 2MB. ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© WebP Ù…Ø­Ø³Ù†Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹."})]}),e.jsxs("form",{onSubmit:Qn,style:{background:"#fff",padding:"1rem",borderRadius:12,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)",display:"grid",gap:8},children:[e.jsx("h4",{style:{marginTop:0},children:"ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(180px,1fr))",gap:8},children:[e.jsx("input",{placeholder:"Ø§Ø³Ù… Ø¹Ø±Ø¨ÙŠ",value:w.siteNameAr,onChange:t=>C(r=>({...r,siteNameAr:t.target.value}))}),e.jsx("input",{placeholder:"Name EN",value:w.siteNameEn,onChange:t=>C(r=>({...r,siteNameEn:t.target.value}))}),e.jsx("input",{placeholder:"#69be3c",value:w.colorPrimary,onChange:t=>C(r=>({...r,colorPrimary:t.target.value}))}),e.jsx("input",{placeholder:"#1f2937",value:w.colorSecondary,onChange:t=>C(r=>({...r,colorSecondary:t.target.value}))}),e.jsx("input",{placeholder:"#ef4444",value:w.colorAccent,onChange:t=>C(r=>({...r,colorAccent:t.target.value}))}),e.jsx("input",{placeholder:"Ù‡Ø§ØªÙ",value:w.supportPhone,onChange:t=>C(r=>({...r,supportPhone:t.target.value}))}),e.jsx("input",{placeholder:"Ø¬ÙˆØ§Ù„",value:w.supportMobile,onChange:t=>C(r=>({...r,supportMobile:t.target.value}))}),e.jsx("input",{placeholder:"ÙˆØ§ØªØ³Ø§Ø¨",value:w.supportWhatsapp,onChange:t=>C(r=>({...r,supportWhatsapp:t.target.value}))}),e.jsx("input",{placeholder:"Email",value:w.supportEmail,onChange:t=>C(r=>({...r,supportEmail:t.target.value}))}),e.jsx("input",{placeholder:"Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¯Ø¹Ù…",value:w.supportHours,onChange:t=>C(r=>({...r,supportHours:t.target.value}))}),e.jsx("input",{placeholder:"Ø¹Ù† Ø§Ù„Ø´Ø±ÙƒØ© AR",value:w.footerAboutAr,onChange:t=>C(r=>({...r,footerAboutAr:t.target.value}))}),e.jsx("input",{placeholder:"About EN",value:w.footerAboutEn,onChange:t=>C(r=>({...r,footerAboutEn:t.target.value}))}),e.jsx("input",{placeholder:"Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¯ÙˆÙ†Ø©",value:w.linkBlog,onChange:t=>C(r=>({...r,linkBlog:t.target.value}))}),e.jsx("input",{placeholder:"Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙˆØ§ØµÙ„",value:w.linkSocial,onChange:t=>C(r=>({...r,linkSocial:t.target.value}))}),e.jsx("input",{placeholder:"Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ±Ø¬Ø§Ø¹",value:w.linkReturns,onChange:t=>C(r=>({...r,linkReturns:t.target.value}))}),e.jsx("input",{placeholder:"Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©",value:w.linkPrivacy,onChange:t=>C(r=>({...r,linkPrivacy:t.target.value}))}),e.jsx("input",{placeholder:"App Store URL",value:w.appStoreUrl,onChange:t=>C(r=>({...r,appStoreUrl:t.target.value}))}),e.jsx("input",{placeholder:"Play Store URL",value:w.playStoreUrl,onChange:t=>C(r=>({...r,playStoreUrl:t.target.value}))})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx(l,{type:"submit",variant:"primary",disabled:et,children:"Ø­ÙØ¸"}),e.jsx(l,{type:"button",variant:"ghost",onClick:()=>Kt(),children:"Ø¥Ù„ØºØ§Ø¡"})]})]}),e.jsxs("div",{style:{background:"#fff",padding:"1rem",borderRadius:12,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)"},children:[e.jsx("h4",{style:{marginTop:0},children:"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª"}),e.jsxs("ul",{style:hs,children:[e.jsx("li",{children:"Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©: 1.0.0"}),e.jsxs("li",{children:["Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ",(N?.length||0)+(Tt?.length||0)+(F?.length||0)," Ø³Ø¬Ù„"]})]})]})]})]}),h==="brands"&&e.jsxs("div",{style:re,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("h3",{style:ne,children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©"}),e.jsx(l,{variant:"primary",type:"button",onClick:()=>Qt(),children:"ØªØ­Ø¯ÙŠØ«"}),e.jsx(l,{variant:"ghost",type:"button",onClick:()=>Jt(),children:"ÙØ­Øµ Ø§Ù„ØµÙŠØ§Ù†Ø©"}),e.jsx(l,{variant:"ghost",type:"button",onClick:()=>Ur(),children:"Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ ØµÙˆØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª"}),kr&&e.jsx("span",{style:{fontSize:".6rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),Er&&e.jsxs("span",{style:{fontSize:".6rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",Er]}),e.jsx("input",{placeholder:"Ø¨Ø­Ø« Ø¹Ù„Ø§Ù…Ø©",value:lt,onChange:t=>Cn(t.target.value),style:j}),e.jsxs("select",{value:Mt,onChange:t=>An(t.target.value),style:j,children:[e.jsx("option",{value:"created_desc",children:"Ø§Ù„Ø£Ø­Ø¯Ø«"}),e.jsx("option",{value:"created_asc",children:"Ø§Ù„Ø£Ù‚Ø¯Ù…"}),e.jsx("option",{value:"name_ar",children:"Ø§Ù„Ø§Ø³Ù… AR"}),e.jsx("option",{value:"name_en",children:"Name EN"}),e.jsx("option",{value:"products_desc",children:"Ø£ÙƒØ«Ø± Ù…Ù†ØªØ¬Ø§Øª"}),e.jsx("option",{value:"products_asc",children:"Ø£Ù‚Ù„ Ù…Ù†ØªØ¬Ø§Øª"})]}),e.jsxs("select",{value:Ot,onChange:t=>ce(t.target.value),style:j,children:[e.jsx("option",{value:"",children:"ÙƒÙ„ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª"}),e.jsx("option",{value:"duplicates",children:"Ù…ÙƒØ±Ø±Ø©"}),e.jsx("option",{value:"noLogo",children:"Ø¨Ø¯ÙˆÙ† Ø´Ø¹Ø§Ø±"}),e.jsx("option",{value:"zeroProducts",children:"Ø¨Ø¯ÙˆÙ† Ù…Ù†ØªØ¬Ø§Øª"}),e.jsx("option",{value:"missingVariants",children:"Ù†Ù‚Øµ Ù†Ø³Ø® Ø§Ù„Ø´Ø¹Ø§Ø±"})]}),e.jsx(l,{type:"button",variant:"ghost",onClick:()=>Pr(t=>!t),children:zr?"Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¯Ù…Ø¬":"Ù„ÙˆØ­Ø© Ø§Ù„Ø¯Ù…Ø¬"})]}),T&&e.jsxs("div",{style:{marginTop:8,background:"#fff",border:"1px solid #e2e8f0",borderRadius:12,padding:".5rem .75rem",display:"flex",flexWrap:"wrap",gap:10,alignItems:"center"},children:[e.jsx("div",{style:{fontSize:".7rem",color:"#334155",fontWeight:700},children:"Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ:"}),e.jsxs(l,{type:"button",size:"sm",variant:"ghost",onClick:()=>ce("duplicates"),children:["Ù…ÙƒØ±Ø±Ø§Øª: ",(T.duplicateNames||[]).length," Ù…Ø¬Ù…ÙˆØ¹Ø©"]}),e.jsxs(l,{type:"button",size:"sm",variant:"ghost",onClick:()=>ce("noLogo"),children:["Ø¨Ø¯ÙˆÙ† Ø´Ø¹Ø§Ø±: ",(T.noLogo||[]).length]}),e.jsxs(l,{type:"button",size:"sm",variant:"ghost",onClick:()=>ce("zeroProducts"),children:["Ø¨Ø¯ÙˆÙ† Ù…Ù†ØªØ¬Ø§Øª: ",(T.zeroProducts||[]).length]}),e.jsxs(l,{type:"button",size:"sm",variant:"ghost",onClick:()=>ce("missingVariants"),children:["Ù†Ù‚Øµ Ù†Ø³Ø®: ",(T.missingLogoVariants||[]).length]}),e.jsx(l,{type:"button",size:"sm",variant:"ghost",onClick:()=>ce(""),children:"Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙƒÙ„"})]}),!T&&e.jsx("div",{style:{marginTop:8,fontSize:".65rem",color:"#64748b"},children:'ÙŠÙ…ÙƒÙ†Ùƒ ØªØ´ØºÙŠÙ„ "ÙØ­Øµ Ø§Ù„ØµÙŠØ§Ù†Ø©" Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© ÙˆØ§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø£Ø®Ø±Ù‰.'}),zr&&e.jsxs("div",{style:{marginTop:10,background:"#fff",border:"1px solid #e2e8f0",borderRadius:12,padding:".75rem",display:"grid",gap:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("div",{style:{fontSize:".8rem",fontWeight:700},children:"Ø¯Ù…Ø¬ Ø¹Ù„Ø§Ù…Ø§Øª"}),e.jsxs("select",{value:we,onChange:t=>Lr(t.target.value),style:j,children:[e.jsx("option",{value:"",children:"â€” Ø§Ø®ØªØ± Ø§Ù„Ù‡Ø¯Ù â€”"}),Re.map(t=>e.jsxs("option",{value:t.id,children:[E(t.name,m)||t.name?.ar||t.name?.en||t.slug," (",t.productCount||0,")"]},t.id))]}),e.jsx(l,{type:"button",variant:"primary",disabled:!we||!It.filter(t=>t&&t!==we).length,onClick:()=>{const t=It.filter(r=>r&&r!==we);t.length&&window.confirm(`Ø¯Ù…Ø¬ ${t.length} Ø¹Ù„Ø§Ù…Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ù…Ø®ØªØ§Ø±ØŸ`)&&On(we,t).then(()=>{ot([]),Lr("")})},children:"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯Ù…Ø¬"})]}),T?.duplicateNames?.length>0&&e.jsxs("div",{style:{fontSize:".65rem",color:"#334155"},children:["Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù…ÙƒØ±Ø±Ø© Ø³Ø±ÙŠØ¹Ø©:",e.jsx("ul",{style:{listStyle:"none",padding:0,margin:".25rem 0",display:"grid",gap:6},children:T.duplicateNames.map((t,r)=>e.jsxs("li",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsxs("span",{style:{fontWeight:600},children:["Ù…Ø¬Ù…ÙˆØ¹Ø© ",r+1,":"]}),e.jsx("span",{style:{opacity:.8},children:(t.slugs||[]).join(", ")}),e.jsx(l,{type:"button",size:"sm",variant:"ghost",onClick:()=>{ot(t.ids||[]),ce("duplicates"),Pr(!0)},children:"ØªÙ‡ÙŠØ¦Ø© Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©"})]},r))})]}),e.jsxs("div",{style:{display:"grid",gap:6},children:[e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsx("input",{placeholder:"Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ø±",value:Fr,onChange:t=>kn(t.target.value),style:j}),e.jsx(l,{type:"button",size:"sm",variant:"ghost",onClick:()=>ot([]),children:"Ù…Ø³Ø­ Ø§Ù„ØªØ­Ø¯ÙŠØ¯"})]}),e.jsx("div",{style:{maxHeight:220,overflow:"auto",border:"1px solid #e2e8f0",borderRadius:8,padding:6,display:"grid",gap:4},children:Re.filter(t=>{const r=Fr.trim().toLowerCase();if(!r)return!0;const n=(E(t.name,m)||t.name?.ar||t.name?.en||t.slug||"").toLowerCase();return(t.slug||"").toLowerCase().includes(r)||n.includes(r)}).map(t=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:".75rem"},children:[e.jsx("input",{type:"checkbox",checked:It.includes(t.id),onChange:()=>ot(r=>r.includes(t.id)?r.filter(n=>n!==t.id):[...r,t.id])}),e.jsx("span",{style:{opacity:.85},children:E(t.name,m)||t.name?.ar||t.name?.en||t.slug}),e.jsxs("span",{style:{fontSize:".6rem",opacity:.6},children:["(",t.productCount||0,")"]}),we===t.id&&e.jsx("span",{style:{fontSize:".6rem",color:"#b91c1c"},children:"â† Ø§Ù„Ù‡Ø¯Ù"})]},t.id))})]})]}),e.jsxs("form",{onSubmit:In,style:$e,children:[e.jsx("h4",{style:{margin:0,fontSize:".85rem"},children:x.id?"ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù„Ø§Ù…Ø©":"Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø©"}),e.jsxs("div",{style:qe,children:[e.jsx("input",{placeholder:"Slug",value:x.slug,onChange:t=>K(r=>({...r,slug:t.target.value}))}),e.jsx("input",{placeholder:"Ø§Ù„Ø§Ø³Ù… AR",value:x.nameAr,onChange:t=>K(r=>({...r,nameAr:t.target.value})),required:!0}),e.jsx("input",{placeholder:"Name EN",value:x.nameEn,onChange:t=>K(r=>({...r,nameEn:t.target.value})),required:!0}),e.jsx("input",{placeholder:"ÙˆØµÙ AR",value:x.descriptionAr,onChange:t=>K(r=>({...r,descriptionAr:t.target.value}))}),e.jsx("input",{placeholder:"Description EN",value:x.descriptionEn,onChange:t=>K(r=>({...r,descriptionEn:t.target.value}))}),e.jsx("input",{placeholder:"Logo URL",value:x.logo,onChange:t=>K(r=>({...r,logo:t.target.value}))}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>Ar(t.target.files?.[0]||null)}),De&&e.jsx("span",{style:{fontSize:".55rem"},children:De.name})]}),e.jsxs("div",{style:Ve,children:[e.jsxs(l,{type:"submit",variant:"primary",children:[e.jsx(ft,{size:16})," ",x.id?"Ø­ÙØ¸":"Ø¥Ø¶Ø§ÙØ©"]}),x.id&&e.jsxs(l,{type:"button",variant:"ghost",onClick:()=>K({id:null,slug:"",nameAr:"",nameEn:"",descriptionAr:"",descriptionEn:"",logo:""}),children:[e.jsx(jt,{size:16})," Ø¥Ù„ØºØ§Ø¡"]})]})]}),e.jsxs("table",{style:q,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„Ø´Ø¹Ø§Ø±"}),e.jsx("th",{children:"Ø§Ù„Ø§Ø³Ù…"}),e.jsx("th",{children:"Slug"}),e.jsx("th",{children:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"}),e.jsx("th",{children:"Ø§Ù„ÙˆØµÙ"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[Hn.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.logo?e.jsx("img",{src:t.logo,alt:"logo",loading:"lazy",style:{width:38,height:38,objectFit:"contain"}}):"â€”"}),e.jsx("td",{children:E(t.name,m)||t.name?.ar||t.name?.en}),e.jsx("td",{style:{fontSize:".6rem"},children:t.slug}),e.jsx("td",{children:t.productCount||0}),e.jsx("td",{style:{fontSize:".6rem",maxWidth:180,overflow:"hidden",textOverflow:"ellipsis"},children:E(t.description,m)||t.description?.ar||t.description?.en||"â€”"}),e.jsxs("td",{style:Y,children:[e.jsx(l,{variant:"ghost",size:"sm",title:"ØªØ¹Ø¯ÙŠÙ„",onClick:()=>K({id:t.id,slug:t.slug,nameAr:t.name?.ar||"",nameEn:t.name?.en||"",descriptionAr:t.description?.ar||"",descriptionEn:t.description?.en||"",logo:t.logo||""}),children:e.jsx(Ne,{size:16})}),e.jsx(l,{variant:"ghost",size:"sm",title:"Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ Ù†Ø³Ø® Ø§Ù„Ø´Ø¹Ø§Ø±",onClick:()=>Ur(t.id),children:"â†»"}),e.jsx(l,{variant:"danger",size:"sm",title:"Ø­Ø°Ù",onClick:()=>Nn(t.id),children:e.jsx(vt,{size:16})})]})]},t.id)),!ke.length&&!kr&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:V,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù„Ø§Ù…Ø§Øª"})})]})]}),ke.length>0&&e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginTop:8},children:[e.jsx(l,{variant:pe===1?"ghost":"primary",disabled:pe===1,onClick:()=>Xt(t=>Math.max(1,t-1)),children:"Ø§Ù„Ø³Ø§Ø¨Ù‚"}),e.jsxs("span",{style:{fontSize:".65rem"},children:["ØµÙØ­Ø© ",pe," / ",yt]}),e.jsx(l,{variant:pe===yt?"ghost":"primary",disabled:pe===yt,onClick:()=>Xt(t=>Math.min(yt,t+1)),children:"Ø§Ù„ØªØ§Ù„ÙŠ"}),e.jsx("span",{style:{marginInlineStart:10,fontSize:".65rem"},children:"Ø¹Ø¯Ø¯ Ø§Ù„ØµÙÙˆÙ:"}),e.jsx("select",{value:Ie,onChange:t=>{Vn(+t.target.value),Xt(1)},style:j,children:[10,20,30,50,100].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsxs("span",{style:{fontSize:".65rem",opacity:.7},children:[ke.length," Ø¹Ù†ØµØ±"]})]})]}),h==="marketing"&&e.jsxs("div",{style:re,children:[e.jsxs("div",{style:{background:"#fff",padding:"1rem",borderRadius:14,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)",display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("h4",{style:{margin:"0 0 .25rem",fontSize:".9rem"},children:"ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù†Ù‚Ø±Ø§Øª"}),e.jsx("select",{value:Wr,onChange:t=>{const r=+t.target.value;Dn(r),Vt(r)},style:j,children:[7,14,30,60,90,180].map(t=>e.jsxs("option",{value:t,children:[t," ÙŠÙˆÙ…"]},t))}),e.jsx(l,{type:"button",variant:"primary",onClick:()=>Vt(),children:"ØªØ­Ø¯ÙŠØ«"})]}),!_e&&e.jsx("div",{style:{fontSize:".65rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),_e&&e.jsx("div",{style:{display:"grid",gap:"1rem",gridTemplateColumns:"repeat(auto-fit,minmax(220px,1fr))"},children:["banner","feature","appLink"].map(t=>e.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:".75rem",display:"flex",flexDirection:"column",gap:6},children:[e.jsx("div",{style:{fontSize:".7rem",fontWeight:700,color:"#334155"},children:t==="banner"?"Ø¨Ø§Ù†Ø±Ø§Øª":t==="feature"?"Ù…ÙŠØ²Ø§Øª":"Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª"}),e.jsxs("ul",{style:{listStyle:"none",margin:0,padding:0,display:"flex",flexDirection:"column",gap:4},children:[(_e[t]||[]).slice(0,10).map(r=>e.jsxs("li",{style:{display:"flex",justifyContent:"space-between",fontSize:".6rem"},children:[e.jsx("span",{style:{maxWidth:140,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.titleAr||r.labelAr||r.titleEn||r.labelEn||r.platform||r.id}),e.jsx("span",{style:{fontWeight:600},children:r.count})]},r.id)),!(_e[t]||[]).length&&e.jsx("li",{style:{fontSize:".55rem",opacity:.6},children:"Ù„Ø§ Ø¨ÙŠØ§Ù†Ø§Øª"})]})]},t))})]}),e.jsxs("form",{onSubmit:Bn,style:$e,children:[e.jsxs("h4",{style:{margin:0,fontSize:".85rem"},children:["Ù…ÙŠØ²Ø§Øª (",ct.length,")"]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[e.jsx("input",{placeholder:"Ø¨Ø­Ø«",value:gt,onChange:t=>Pn(t.target.value),style:j}),e.jsxs("select",{value:$t,onChange:t=>Fn(t.target.value),style:j,children:[e.jsx("option",{value:"sort_asc",children:"Sort â†‘"}),e.jsx("option",{value:"sort_desc",children:"Sort â†“"}),e.jsx("option",{value:"title_ar",children:"Ø¹Ù†ÙˆØ§Ù† AR"}),e.jsx("option",{value:"title_en",children:"Title EN"})]})]}),e.jsxs("div",{style:qe,children:[e.jsx("input",{placeholder:"Ø¹Ù†ÙˆØ§Ù† AR",value:y.titleAr,onChange:t=>$(r=>({...r,titleAr:t.target.value})),required:!0}),e.jsx("input",{placeholder:"Title EN",value:y.titleEn,onChange:t=>$(r=>({...r,titleEn:t.target.value})),required:!0}),e.jsx("input",{placeholder:"Ù†Øµ AR",value:y.bodyAr,onChange:t=>$(r=>({...r,bodyAr:t.target.value}))}),e.jsx("input",{placeholder:"Body EN",value:y.bodyEn,onChange:t=>$(r=>({...r,bodyEn:t.target.value}))}),e.jsx("input",{placeholder:"Icon",value:y.icon,onChange:t=>$(r=>({...r,icon:t.target.value}))}),e.jsx("input",{type:"number",placeholder:"Sort",value:y.sort,onChange:t=>$(r=>({...r,sort:+t.target.value||0}))}),e.jsxs("select",{value:y.active?"1":"0",onChange:t=>$(r=>({...r,active:t.target.value==="1"})),children:[e.jsx("option",{value:"1",children:"Ù†Ø´Ø·"}),e.jsx("option",{value:"0",children:"Ù…ØªÙˆÙ‚Ù"})]})]}),e.jsxs("div",{style:Ve,children:[e.jsxs(l,{type:"submit",variant:"primary",children:[e.jsx(ft,{size:16})," ",y.id?"Ø­ÙØ¸":"Ø¥Ø¶Ø§ÙØ©"]}),y.id&&e.jsxs(l,{type:"button",variant:"ghost",onClick:()=>$({id:null,titleAr:"",titleEn:"",bodyAr:"",bodyEn:"",icon:"",sort:0,active:!0}),children:[e.jsx(jt,{size:16})," Ø¥Ù„ØºØ§Ø¡"]})]}),e.jsxs("table",{style:q,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"}),e.jsx("th",{children:"Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©"}),e.jsx("th",{children:"Sort"}),e.jsx("th",{children:"Ù†Ø´Ø·"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[$r.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:E(t.title,m)||t.title?.ar||t.title?.en}),e.jsx("td",{children:t.icon||"â€”"}),e.jsx("td",{children:t.sort}),e.jsx("td",{children:t.active?"âœ“":"âœ—"}),e.jsxs("td",{style:Y,children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>$({id:t.id,titleAr:t.title?.ar||"",titleEn:t.title?.en||"",bodyAr:t.body?.ar||"",bodyEn:t.body?.en||"",icon:t.icon||"",sort:t.sort||0,active:!!t.active}),children:e.jsx(Ne,{size:16})}),e.jsx(l,{variant:"danger",size:"sm",onClick:()=>Un(t.id),children:e.jsx(vt,{size:16})})]})]},t.id)),!$r.length&&!Ir&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:V,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙŠØ²Ø§Øª"})})]})]})]}),e.jsxs("form",{onSubmit:$n,style:$e,children:[e.jsxs("h4",{style:{margin:0,fontSize:".85rem"},children:["Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª (",Wt.length,")"]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[e.jsx("input",{placeholder:"Ø¨Ø­Ø«",value:mt,onChange:t=>Ln(t.target.value),style:j}),e.jsxs("select",{value:qt,onChange:t=>Tn(t.target.value),style:j,children:[e.jsx("option",{value:"platform_asc",children:"Ù…Ù†ØµØ© â†‘"}),e.jsx("option",{value:"platform_desc",children:"Ù…Ù†ØµØ© â†“"})]})]}),e.jsxs("div",{style:qe,children:[e.jsxs("select",{value:A.platform,onChange:t=>te(r=>({...r,platform:t.target.value})),children:[e.jsx("option",{value:"ios",children:"iOS"}),e.jsx("option",{value:"android",children:"Android"}),e.jsx("option",{value:"web",children:"Web"})]}),e.jsx("input",{placeholder:"URL",value:A.url,onChange:t=>te(r=>({...r,url:t.target.value})),required:!0}),e.jsx("input",{placeholder:"Label AR",value:A.labelAr,onChange:t=>te(r=>({...r,labelAr:t.target.value}))}),e.jsx("input",{placeholder:"Label EN",value:A.labelEn,onChange:t=>te(r=>({...r,labelEn:t.target.value}))}),e.jsxs("select",{value:A.active?"1":"0",onChange:t=>te(r=>({...r,active:t.target.value==="1"})),children:[e.jsx("option",{value:"1",children:"Ù†Ø´Ø·"}),e.jsx("option",{value:"0",children:"Ù…ØªÙˆÙ‚Ù"})]})]}),e.jsxs("div",{style:Ve,children:[e.jsxs(l,{type:"submit",variant:"primary",children:[e.jsx(ft,{size:16})," ",A.id?"Ø­ÙØ¸":"Ø¥Ø¶Ø§ÙØ©"]}),A.id&&e.jsxs(l,{type:"button",variant:"ghost",onClick:()=>te({id:null,platform:"web",url:"",labelAr:"",labelEn:"",active:!0}),children:[e.jsx(jt,{size:16})," Ø¥Ù„ØºØ§Ø¡"]})]}),e.jsxs("table",{style:q,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„Ù…Ù†ØµØ©"}),e.jsx("th",{children:"Ø§Ù„Ø±Ø§Ø¨Ø·"}),e.jsx("th",{children:"Ø§Ù„Ù†Øµ"}),e.jsx("th",{children:"Ù†Ø´Ø·"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[qr.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.platform}),e.jsx("td",{style:{fontSize:".6rem",maxWidth:220,overflow:"hidden",textOverflow:"ellipsis"},children:t.url}),e.jsx("td",{children:E(t.label,m)||t.label?.ar||t.label?.en||"â€”"}),e.jsx("td",{children:t.active?"âœ“":"âœ—"}),e.jsxs("td",{style:Y,children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>te({id:t.id,platform:t.platform,url:t.url,labelAr:t.label?.ar||"",labelEn:t.label?.en||"",active:!!t.active}),children:e.jsx(Ne,{size:16})}),e.jsx(l,{variant:"danger",size:"sm",onClick:()=>qn(t.id),children:e.jsx(vt,{size:16})})]})]},t.id)),!qr.length&&!Ir&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,style:V,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø·"})})]})]})]})]})]})]})]}):e.jsxs("div",{style:{direction:"rtl",padding:"2rem",maxWidth:520,margin:"2rem auto",background:"#fff",border:"1px solid #e2e8f0",borderRadius:16,boxShadow:"0 6px 28px -8px rgba(0,0,0,.12)"},children:[e.jsx("h2",{style:{marginTop:0,fontSize:"1.1rem"},children:"ğŸš« ØµÙ„Ø§Ø­ÙŠØ§Øª ØºÙŠØ± ÙƒØ§ÙÙŠØ©"}),e.jsx("p",{style:{fontSize:".75rem",lineHeight:1.7,color:"#475569"},children:"Ù„Ø§ ØªÙ…Ù„Ùƒ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±. Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ¹ØªÙ‚Ø¯ Ø£Ù† Ù‡Ø°Ø§ Ø®Ø·Ø£ØŒ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ."}),e.jsx("a",{href:"/",style:{display:"inline-block",marginTop:12,fontSize:".7rem",fontWeight:600,color:"#69be3c",textDecoration:"none"},children:"Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"})]})},us={direction:"rtl",padding:"1.25rem 0",fontSize:".85rem"},j={padding:".55rem .75rem",border:"1px solid #e2e8f0",borderRadius:10,minWidth:160,fontSize:".8rem",background:"#fff"};({...j});({...j});const bt={background:"var(--color-surface)",padding:"1rem",borderRadius:14,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)",display:"flex",flexDirection:"column",gap:".35rem",border:"1px solid var(--color-border-soft)"},Gr={fontSize:"1.6rem",fontWeight:700,color:"var(--color-text)"},Jr={fontSize:".7rem",letterSpacing:".5px",color:"var(--color-text-faint)",fontWeight:600},St={background:"var(--color-bg-alt)",border:"1px solid var(--color-border)",borderRadius:10,padding:".5rem .7rem"},wt={fontSize:".95rem",fontWeight:800,color:"var(--color-text)"},Ct={fontSize:".65rem",color:"var(--color-text-faint)",fontWeight:700},re={background:"transparent",display:"flex",flexDirection:"column",gap:"1.25rem"},$e={background:"var(--color-surface)",padding:"1rem 1.1rem 1.25rem",borderRadius:14,boxShadow:"0 4px 14px -6px rgba(0,0,0,.08)",display:"flex",flexDirection:"column",gap:".8rem",border:"1px solid var(--color-border-soft)"},qe={display:"grid",gap:".65rem",gridTemplateColumns:"repeat(auto-fit,minmax(140px,1fr))"},Ve={display:"flex",gap:".6rem",flexWrap:"wrap"},ne={margin:0,fontSize:"1rem",fontWeight:700},q={width:"100%",borderCollapse:"collapse",background:"var(--color-surface)",borderRadius:14,overflow:"hidden",boxShadow:"0 4px 14px -6px rgba(0,0,0,.06)",border:"1px solid var(--color-border-soft)"},Y={display:"flex",gap:".35rem",alignItems:"center"},V={textAlign:"center",padding:"1rem",fontSize:".75rem",color:"var(--color-text-faint)"},ps={fontSize:".75rem",color:"var(--color-text-soft)",margin:".25rem 0 1rem"},hs={margin:0,padding:"0 1rem",listStyle:"disc",lineHeight:1.9},We={fontSize:".55rem",fontWeight:600,color:"var(--color-text-soft)"},Be={...j,minWidth:90,fontSize:".65rem",padding:".4rem .5rem"};function gs(m){const H={display:"inline-block",padding:".15rem .45rem",borderRadius:999,fontSize:".65rem",fontWeight:700},b={success:{background:"rgba(var(--color-primary-rgb),0.12)",color:"var(--color-primary)",border:"1px solid rgba(var(--color-primary-rgb),0.28)"},info:{background:"rgba(var(--color-accent-rgb,58,90,121),0.10)",color:"var(--color-accent)",border:"1px solid rgba(var(--color-accent-rgb,58,90,121),0.25)"},warning:{background:"rgba(217,119,6,0.10)",color:"var(--color-warning)",border:"1px solid rgba(217,119,6,0.28)"},danger:{background:"rgba(220,38,38,0.10)",color:"var(--color-danger)",border:"1px solid rgba(220,38,38,0.25)"},neutral:{background:"var(--color-bg-alt)",color:"var(--color-text)",border:"1px solid var(--color-border)"}},Q={pending:b.warning,processing:b.info,paid:b.success,shipped:b.info,completed:b.success,cancelled:b.danger,pending_bank_review:b.warning};return{...H,...Q[m]||b.neutral}}const ms=()=>{const{locale:m}=Xr(),[H,b]=s.useState([]),[Q,G]=s.useState(!1),[Z,F]=s.useState(null),[c,z]=s.useState({id:null,slug:"",nameAr:"",nameEn:"",descriptionAr:"",descriptionEn:"",image:"",icon:""}),[f,Pe]=s.useState(null),[ee,At]=s.useState(!1),kt=async()=>{G(!0),F(null);try{const d=await g.listCategories({withCounts:1});b(d.categories||[])}catch(d){F(d.message)}finally{G(!1)}};s.useEffect(()=>{kt()},[]);const Et=()=>{z({id:null,slug:"",nameAr:"",nameEn:"",descriptionAr:"",descriptionEn:"",image:"",icon:""}),Pe(null),At(!1)},Zt=async d=>{d.preventDefault(),G(!0),F(null);try{if(c.id)if(ee&&f){const o=new FormData;c.slug&&o.append("slug",c.slug),c.nameAr&&o.append("nameAr",c.nameAr),c.nameEn&&o.append("nameEn",c.nameEn),c.descriptionAr&&o.append("descriptionAr",c.descriptionAr),c.descriptionEn&&o.append("descriptionEn",c.descriptionEn),c.icon!==void 0&&o.append("icon",c.icon||""),o.append("image",f);const k=await g.updateCategoryForm(c.id,o);b(_=>_.map(M=>M.id===k.category?.id||M.id===k.id?k.category||k:M))}else{const o=await g.updateCategory(c.id,{slug:c.slug||void 0,nameAr:c.nameAr||void 0,nameEn:c.nameEn||void 0,descriptionAr:c.descriptionAr||null,descriptionEn:c.descriptionEn||null,image:c.image||null,icon:c.icon||null});b(k=>k.map(_=>_.id===o.category?.id||_.id===o.id?o.category||o:_))}else if(ee&&f){const o=new FormData;o.append("slug",c.slug),o.append("nameAr",c.nameAr),o.append("nameEn",c.nameEn),c.descriptionAr&&o.append("descriptionAr",c.descriptionAr),c.descriptionEn&&o.append("descriptionEn",c.descriptionEn),c.icon&&o.append("icon",c.icon),o.append("image",f);const k=await g.createCategoryForm(o),_=k.category||k;b(M=>[_,...M])}else{const o=await g.createCategory({slug:c.slug,nameAr:c.nameAr,nameEn:c.nameEn,descriptionAr:c.descriptionAr||null,descriptionEn:c.descriptionEn||null,image:c.image||null,icon:c.icon||null}),k=o.category||o;b(_=>[k,..._])}Et()}catch(o){F(o.message)}finally{G(!1)}},P=async d=>{if(window.confirm("Ø­Ø°Ù Ø§Ù„ØªØµÙ†ÙŠÙØŸ"))try{await g.deleteCategory(d),b(o=>o.filter(k=>k.id!==d))}catch(o){alert("ÙØ´Ù„ Ø§Ù„Ø­Ø°Ù: "+o.message)}};return e.jsxs("div",{style:re,children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsx("h3",{style:ne,children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª"}),e.jsx(l,{type:"button",variant:"primary",onClick:kt,children:"ØªØ­Ø¯ÙŠØ«"}),Q&&e.jsx("span",{style:{fontSize:".65rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),Z&&e.jsxs("span",{style:{fontSize:".65rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",Z]})]}),e.jsxs("form",{onSubmit:Zt,style:$e,children:[e.jsx("h4",{style:{margin:0,fontSize:".9rem"},children:c.id?"ØªØ¹Ø¯ÙŠÙ„ ØªØµÙ†ÙŠÙ":"Ø¥Ø¶Ø§ÙØ© ØªØµÙ†ÙŠÙ"}),e.jsxs("div",{style:qe,children:[e.jsx("input",{placeholder:"Slug",value:c.slug,onChange:d=>z(o=>({...o,slug:d.target.value})),required:!c.id}),e.jsx("input",{placeholder:"Ø§Ù„Ø§Ø³Ù… AR",value:c.nameAr,onChange:d=>z(o=>({...o,nameAr:d.target.value})),required:!c.id}),e.jsx("input",{placeholder:"Name EN",value:c.nameEn,onChange:d=>z(o=>({...o,nameEn:d.target.value})),required:!c.id}),e.jsx("input",{placeholder:"ÙˆØµÙ AR",value:c.descriptionAr,onChange:d=>z(o=>({...o,descriptionAr:d.target.value}))}),e.jsx("input",{placeholder:"Description EN",value:c.descriptionEn,onChange:d=>z(o=>({...o,descriptionEn:d.target.value}))}),e.jsx("input",{placeholder:"Icon key (Ù…Ø«Ù„: coffee, cup-soda, cookie, store, tag)",value:c.icon,onChange:d=>z(o=>({...o,icon:d.target.value}))}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:".8rem"},children:[e.jsx("input",{type:"checkbox",checked:ee,onChange:d=>At(d.target.checked)})," Ø±ÙØ¹ ØµÙˆØ±Ø©"]}),!ee&&e.jsx("input",{placeholder:"Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)",value:c.image,onChange:d=>z(o=>({...o,image:d.target.value}))}),ee&&e.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:d=>Pe(d.target.files?.[0]||null)})]}),e.jsxs("div",{style:Ve,children:[e.jsx(l,{type:"submit",variant:"primary",children:"Ø­ÙØ¸"}),c.id&&e.jsx(l,{type:"button",variant:"ghost",onClick:Et,children:"Ø¥Ù„ØºØ§Ø¡"})]})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:q,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„Ø§Ø³Ù…"}),e.jsx("th",{children:"Slug"}),e.jsx("th",{children:"Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©"}),e.jsx("th",{children:"Ø§Ù„ØµÙˆØ±Ø©"}),e.jsx("th",{children:"Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[H.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:E(d.name,m)||d.name?.ar||d.name?.en||d.slug}),e.jsx("td",{style:{fontSize:".6rem"},children:d.slug}),e.jsx("td",{style:{fontSize:".7rem"},children:d.icon||"â€”"}),e.jsx("td",{children:d.image?e.jsx("img",{src:d.image,alt:"cat",style:{width:38,height:38,objectFit:"cover",borderRadius:6}}):"â€”"}),e.jsx("td",{children:d.productCount||0}),e.jsxs("td",{style:Y,children:[e.jsx(l,{variant:"ghost",size:"sm",title:"ØªØ¹Ø¯ÙŠÙ„",onClick:()=>z({id:d.id,slug:d.slug,nameAr:d.name?.ar||"",nameEn:d.name?.en||"",descriptionAr:d.description?.ar||"",descriptionEn:d.description?.en||"",image:d.image||"",icon:d.icon||""}),children:"âœ"}),e.jsx(l,{variant:"danger",size:"sm",title:"Ø­Ø°Ù",onClick:()=>P(d.id),children:"ğŸ—‘"})]})]},d.id)),!H.length&&!Q&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:V,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØµÙ†ÙŠÙØ§Øª"})})]})]})})]})},xs=()=>{const{user:m}=Kr()||{},[H,b]=s.useState([]),[Q,G]=s.useState(!1),[Z,F]=s.useState(null),c=async()=>{G(!0),F(null);try{const f=await g.reviewsModerationList();b(Array.isArray(f)?f:f.reviews||[])}catch(f){F(f.message)}finally{G(!1)}};s.useEffect(()=>{m?.role==="admin"&&c()},[m]);const z=async(f,Pe)=>{try{await g.reviewModerate(f,Pe),await c()}catch(ee){alert("ÙØ´Ù„: "+ee.message)}};return m?.role!=="admin"?null:e.jsxs("div",{style:re,children:[e.jsx("h3",{style:ne,children:"Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ø¨Ø¥Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©"}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[e.jsx(l,{type:"button",variant:"primary",onClick:c,children:"ØªØ­Ø¯ÙŠØ«"}),Q&&e.jsx("span",{style:{fontSize:".6rem",color:"#64748b"},children:"...ØªØ­Ù…ÙŠÙ„"}),Z&&e.jsxs("span",{style:{fontSize:".6rem",color:"#b91c1c"},children:["Ø®Ø·Ø£: ",Z]})]}),e.jsxs("table",{style:q,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ø§Ù„ØªØ§Ø±ÙŠØ®"}),e.jsx("th",{children:"Ø§Ù„Ù…Ù†ØªØ¬"}),e.jsx("th",{children:"Ø§Ù„ØªÙ‚ÙŠÙŠÙ…"}),e.jsx("th",{children:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"}),e.jsx("th",{children:"Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"}),e.jsx("th",{children:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"})]})}),e.jsxs("tbody",{children:[H.map(f=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(f.createdAt).toLocaleDateString()}),e.jsx("td",{style:{maxWidth:120,overflow:"hidden",textOverflow:"ellipsis"},children:f.productId}),e.jsx("td",{children:f.rating}),e.jsx("td",{children:f.title||"â€”"}),e.jsx("td",{style:{fontSize:".65rem"},children:f.body?.slice(0,140)}),e.jsxs("td",{style:Y,children:[e.jsx(l,{onClick:()=>z(f.id,"approve"),size:"sm",variant:"primary",title:"Ù…ÙˆØ§ÙÙ‚Ø©",children:"âœ”"}),e.jsx(l,{onClick:()=>z(f.id,"reject"),size:"sm",variant:"danger",title:"Ø±ÙØ¶",children:"âœ–"})]})]},f.id)),!H.length&&!Q&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:V,children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ù…Ø¹Ù„Ù‘Ù‚Ø©"})})]})]})]})};export{ri as default};
